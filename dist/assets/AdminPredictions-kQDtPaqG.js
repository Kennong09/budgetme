import{j as e,B as re,A as je}from"./ui-vendor-Cn1Vfl4w.js";import{r as c}from"./react-vendor-D4A9EtXC.js";import{t as k,b as Te,s as J,p as Ne,P as ve}from"./index-BbApZ7g3.js";import"./chart-vendor-B0c7K_uV.js";const _e=({show:s,onClose:t,title:n,icon:f,color:b,data:d})=>s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:t}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:t,children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:g=>g.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"modal-header bg-gradient-danger text-white border-0",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center",children:[e.jsx("div",{className:"modal-icon-container mr-3",style:{width:"45px",height:"45px",borderRadius:"12px",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("i",{className:`fas ${f}`,style:{fontSize:"1.25rem"}})}),e.jsxs("div",{children:[e.jsx("div",{className:"modal-title-main font-weight-bold",children:n}),e.jsx("div",{className:"modal-subtitle",style:{opacity:.85,fontSize:"0.85rem"},children:"Detailed breakdown"})]})]}),e.jsx("button",{type:"button",className:"close text-white",onClick:t,style:{textShadow:"none",opacity:.9},children:e.jsx("span",{children:"×"})})]}),e.jsx("div",{className:"modal-body bg-white p-0",children:e.jsx("div",{className:"stats-breakdown-list",children:d.map((g,l)=>e.jsxs("div",{className:"stats-breakdown-item d-flex justify-content-between align-items-center py-3 px-4",style:{borderBottom:l<d.length-1?"1px solid #f0f0f0":"none",transition:"background-color 0.2s ease"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-weight-medium text-gray-800",children:g.label}),g.subLabel&&e.jsx("small",{className:"text-muted",children:g.subLabel})]}),e.jsx("span",{className:`badge badge-${b} badge-pill px-3 py-2`,style:{fontSize:"0.9rem",fontWeight:600,minWidth:"60px",textAlign:"center"},children:g.value})]},l))})}),e.jsx("div",{className:"modal-footer bg-light border-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsx("div",{className:"modal-footer-info",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-info-circle mr-1 text-danger"}),"Data reflects current prediction statistics"]})}),e.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:t,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Close"]})]})})]})})})]}):null,ye=({stats:s,loading:t=!1})=>{const[n,f]=c.useState({show:!1,title:"",icon:"",color:"",data:[]});if(t)return e.jsx("div",{className:"row",children:Array.from({length:4}).map((S,N)=>e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsx("div",{className:"card shadow h-100 py-3 admin-card admin-card-loading",children:e.jsxs("div",{className:"card-body text-center",children:[e.jsx("div",{className:"skeleton-line skeleton-stat-value mb-2"}),e.jsx("div",{className:"skeleton-line skeleton-stat-title"})]})})},N))});const b=s.predictionUsers>0?(s.activePredictions/s.predictionUsers*100).toFixed(1):"0",d=s.predictionsByStatus?.pending||0,g=s.predictionsByStatus?.error||0,l=s.predictionUsers-s.activePredictions,j=()=>{f({show:!0,title:"Total Predictions Breakdown",icon:"fa-chart-line",color:"danger",data:[{label:"Total Predictions",value:k(s.totalPredictions)},{label:"Income Predictions",value:k(s.predictionsByType?.income||0),subLabel:"Financial income forecasts"},{label:"Expense Predictions",value:k(s.predictionsByType?.expense||0),subLabel:"Spending pattern forecasts"},{label:"Savings Predictions",value:k(s.predictionsByType?.savings||0),subLabel:"Savings goal forecasts"}]})},x=()=>{f({show:!0,title:"Active Users Breakdown",icon:"fa-user-check",color:"success",data:[{label:"Active Users",value:k(s.activePredictions)},{label:"Percentage of Total",value:`${b}%`},{label:"Pending Users",value:k(d),subLabel:"Awaiting first prediction"},{label:"Users with Errors",value:k(g),subLabel:"Prediction generation failed"}]})},o=()=>{f({show:!0,title:"Prediction Accuracy Breakdown",icon:"fa-bullseye",color:"info",data:[{label:"Average Accuracy",value:`${(s.averageAccuracy||0).toFixed(1)}%`},{label:"High Accuracy (>80%)",value:"Good",subLabel:"Model performing well"},{label:"Model Confidence",value:`${(s.averageAccuracy||0).toFixed(1)}%`,subLabel:"Based on historical data"},{label:"Prediction Quality",value:s.averageAccuracy>=70?"Reliable":"Improving",subLabel:"Overall model assessment"}]})},r=()=>{f({show:!0,title:"Total Users Breakdown",icon:"fa-users",color:"warning",data:[{label:"Total Users",value:k(s.predictionUsers)},{label:"Active Users",value:k(s.activePredictions),subLabel:`${b}% of total`},{label:"Inactive Users",value:k(l),subLabel:"No recent predictions"},{label:"User to Prediction Ratio",value:s.predictionUsers>0?(s.totalPredictions/s.predictionUsers).toFixed(1):"0",subLabel:"Avg predictions per user"}]})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:j,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-red-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-chart-line text-red-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Total Predictions"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:k(s.totalPredictions)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-gray-400",children:[e.jsx("i",{className:"fas fa-database text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium truncate",children:[k(s.predictionsByType?.income||0)," inc..."]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:x,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-emerald-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-user-check text-emerald-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Active Users"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:k(s.activePredictions)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-emerald-500",children:[e.jsx("i",{className:"fas fa-arrow-up text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium",children:[b,"% of total"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:o,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-blue-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-bullseye text-blue-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Avg Accuracy"}),e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:[(s.averageAccuracy||0).toFixed(1),"%"]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-blue-500",children:[e.jsx("i",{className:"fas fa-chart-bar text-[8px]"}),e.jsx("span",{className:"text-[9px] font-medium truncate",children:"Model confidence"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:r,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-amber-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-users text-amber-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Total Users"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:k(s.predictionUsers)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-amber-500",children:[e.jsx("i",{className:"fas fa-user text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium truncate",children:[k(l)," inactive"]})]})]})]})}),e.jsxs("div",{className:"row d-none d-md-flex",children:[e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-danger h-100 position-relative",onClick:j,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-danger text-uppercase mb-2",children:"Total Predictions"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:k(s.totalPredictions)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-muted",children:[e.jsx("i",{className:"fas fa-database mr-1"}),e.jsxs("span",{className:"font-weight-medium text-truncate",children:[k(s.predictionsByType?.income||0)," income, ",k(s.predictionsByType?.expense||0)," expense"]})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-danger",children:e.jsx("i",{className:"fas fa-chart-line stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-danger",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-success h-100 position-relative",onClick:x,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-success text-uppercase mb-2",children:"Active Users"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:k(s.activePredictions)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-success",children:[e.jsx("i",{className:"fas fa-arrow-up mr-1"}),e.jsxs("span",{className:"font-weight-medium",children:[b,"%"]}),e.jsx("span",{className:"ml-1 small",children:"of total"})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-success",children:e.jsx("i",{className:"fas fa-user-check stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-success",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-info h-100 position-relative",onClick:o,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-info text-uppercase mb-2",children:"Average Accuracy"}),e.jsxs("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:[(s.averageAccuracy||0).toFixed(1),"%"]}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-info",children:[e.jsx("i",{className:"fas fa-chart-bar mr-1"}),e.jsx("span",{className:"font-weight-medium text-truncate",children:"Model confidence"})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-info",children:e.jsx("i",{className:"fas fa-bullseye stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-info",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-warning h-100 position-relative",onClick:r,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-warning text-uppercase mb-2",children:"Total Users"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:k(s.predictionUsers)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-muted",children:[e.jsx("i",{className:"fas fa-user mr-1"}),e.jsxs("span",{className:"font-weight-medium text-truncate",children:[k(l)," inactive"]})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-warning",children:e.jsx("i",{className:"fas fa-users stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-warning",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})})]}),e.jsx(_e,{show:n.show,onClose:()=>f({...n,show:!1}),title:n.title,icon:n.icon,color:n.color,data:n.data})]})},we=({filters:s,onFiltersChange:t,onRefresh:n,loading:f=!1})=>{const b=o=>{t({searchTerm:o.target.value})},d=o=>{t({filterStatus:o.target.value})},g=o=>{t({filterType:o.target.value})},l=o=>{t({pageSize:Number(o.target.value),currentPage:1})},j=()=>{t({searchTerm:"",filterStatus:"all",filterType:"all"})},x=s.searchTerm!==""||s.filterStatus!=="all"||s.filterType!=="all";return f?e.jsxs("div",{className:"controls-section mb-4",children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded-lg animate-pulse mb-2"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 h-8 bg-gray-200 rounded-lg animate-pulse"}),e.jsx("div",{className:"flex-1 h-8 bg-gray-200 rounded-lg animate-pulse"})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-6 col-lg-4 mb-3 mb-md-0",children:e.jsx("div",{className:"skeleton-line skeleton-search-bar"})}),e.jsx("div",{className:"col-md-3 col-lg-2 mb-3 mb-md-0",children:e.jsx("div",{className:"skeleton-line skeleton-filter"})}),e.jsx("div",{className:"col-md-3 col-lg-2 mb-3 mb-md-0",children:e.jsx("div",{className:"skeleton-line skeleton-filter"})}),e.jsx("div",{className:"col-md-12 col-lg-4",children:e.jsx("div",{className:"skeleton-line skeleton-filter"})})]})})})})]}):e.jsxs("div",{className:"controls-section mb-4",children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2.5 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("h6",{className:"text-[11px] font-bold text-gray-800 flex items-center gap-1.5",children:[e.jsx("i",{className:"fas fa-filter text-red-500 text-[10px]"}),"Filters",x&&e.jsx("span",{className:"bg-red-100 text-red-600 px-1.5 py-0.5 rounded-full text-[9px]",children:"Active"})]}),e.jsxs("button",{className:"text-[10px] text-gray-500 flex items-center gap-1",onClick:j,children:[e.jsx("i",{className:"fas fa-undo text-[8px]"}),"Reset"]})]}),e.jsxs("div",{className:"px-3 py-2 bg-gray-50",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-[10px]"}),e.jsx("input",{type:"text",className:"w-full pl-8 pr-3 py-2 text-xs bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",placeholder:"Search by username...",value:s.searchTerm,onChange:b})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{className:"flex-1 px-2 py-1.5 text-[10px] bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",value:s.filterStatus,onChange:d,children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"error",children:"Error"})]}),e.jsxs("select",{className:"flex-1 px-2 py-1.5 text-[10px] bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",value:s.filterType,onChange:g,children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"income",children:"Income"}),e.jsx("option",{value:"expense",children:"Expense"}),e.jsx("option",{value:"savings",children:"Savings"})]})]})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-6 col-lg-4 mb-3 mb-md-0",children:e.jsx("div",{className:"search-container",children:e.jsxs("div",{className:"input-group",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("span",{className:"input-group-text bg-white border-right-0",children:e.jsx("i",{className:"fas fa-search text-muted"})})}),e.jsx("input",{type:"text",className:"form-control border-left-0 modern-input",placeholder:"Search by username...",value:s.searchTerm,onChange:b})]})})}),e.jsx("div",{className:"col-md-3 col-lg-2 mb-3 mb-md-0",children:e.jsxs("select",{className:"form-control modern-select",value:s.filterStatus,onChange:d,children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"error",children:"Error"})]})}),e.jsx("div",{className:"col-md-3 col-lg-2 mb-3 mb-md-0",children:e.jsxs("select",{className:"form-control modern-select",value:s.filterType,onChange:g,children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"income",children:"Income"}),e.jsx("option",{value:"expense",children:"Expense"}),e.jsx("option",{value:"savings",children:"Savings"})]})}),e.jsx("div",{className:"col-md-12 col-lg-4",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"page-size-selector",children:[e.jsx("small",{className:"text-muted mr-2",children:"Show:"}),e.jsxs("select",{className:"form-control form-control-sm d-inline-block w-auto",value:s.pageSize,onChange:l,children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"})]}),e.jsx("small",{className:"text-muted ml-2",children:"per page"})]}),e.jsxs("div",{className:"filter-actions",children:[e.jsxs("button",{className:"btn btn-outline-secondary btn-sm mr-2",onClick:n,disabled:f,children:[e.jsx("i",{className:`fas fa-sync-alt ${f?"fa-spin":""} mr-1`}),"Refresh"]}),x&&e.jsxs("button",{className:"btn btn-outline-secondary btn-sm",onClick:j,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Clear"]})]})]})})]})})})})]})},ke=({predictions:s,filters:t,totalPages:n,totalItems:f,loading:b=!1,onSort:d,onPageChange:g,onPredictionSelect:l,onPredictionDelete:j})=>{const[x,o]=c.useState(null);c.useRef(!0);const r=()=>{o(null)},S=a=>{o(x===a?null:a)};c.useEffect(()=>{const a=u=>{x&&!u.target.closest(".dropdown-menu")&&r()};if(x)return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[x]);const N=a=>t.sortField!==a?null:t.sortDirection==="asc"?e.jsx("i",{className:"fas fa-sort-amount-up ml-1"}):e.jsx("i",{className:"fas fa-sort-amount-down ml-1"}),z=a=>{const u={active:"status-badge status-active",pending:"status-badge status-pending",error:"status-badge status-error"},U={active:"fa-check-circle",pending:"fa-pause-circle",error:"fa-times-circle"};return e.jsxs("span",{className:u[a]||"status-badge status-pending",children:[e.jsx("i",{className:`fas ${U[a]||"fa-pause-circle"} mr-1`}),a.charAt(0).toUpperCase()+a.slice(1)]})},T=a=>a>0?"text-success":a<0?"text-danger":"text-muted",h=a=>!a||a===0?"—":`${a>0?"+":""}${(a||0).toFixed(1)}%`;return b?e.jsxs("div",{className:"table-section",children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded animate-pulse"})}),e.jsx("div",{className:"divide-y divide-gray-100",children:Array.from({length:5}).map((a,u)=>e.jsxs("div",{className:"px-3 py-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 animate-pulse"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-3 w-24 bg-gray-200 rounded animate-pulse mb-2"}),e.jsx("div",{className:"h-2 w-16 bg-gray-200 rounded animate-pulse"})]}),e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded animate-pulse"})]},u))})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header bg-white border-0 py-3",children:e.jsx("div",{className:"skeleton-line skeleton-table-header"})}),e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover modern-table mb-0",children:[e.jsx("thead",{className:"table-header",children:e.jsx("tr",{children:Array.from({length:6}).map((a,u)=>e.jsx("th",{className:"border-0",children:e.jsx("div",{className:"skeleton-line skeleton-th"})},u))})}),e.jsx("tbody",{children:Array.from({length:5}).map((a,u)=>e.jsx("tr",{children:Array.from({length:6}).map((U,I)=>e.jsx("td",{className:"py-3",children:e.jsx("div",{className:"skeleton-line skeleton-td"})},I))},u))})]})})})]})})]}):e.jsxs("div",{className:"table-section",children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2.5 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("h6",{className:"text-[11px] font-bold text-gray-800 flex items-center gap-1.5",children:[e.jsx("i",{className:"fas fa-chart-line text-red-500 text-[10px]"}),"Predictions",f>0&&e.jsx("span",{className:"bg-red-100 text-red-600 px-1.5 py-0.5 rounded-full text-[9px]",children:f})]}),e.jsxs("span",{className:"text-[9px] text-gray-400",children:["Page ",t.currentPage," of ",n||1]})]}),e.jsx("div",{className:"divide-y divide-gray-100 max-h-[60vh] overflow-y-auto",children:s.length>0?s.map(a=>e.jsx("div",{className:"px-3 py-3 hover:bg-gray-50 active:bg-gray-100 transition-colors",onClick:()=>l(a),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[a.avatarUrl?e.jsx("img",{src:a.avatarUrl,alt:a.username,className:"w-10 h-10 rounded-full object-cover border-2 border-gray-200"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-500 text-white flex items-center justify-center font-bold text-sm border-2 border-gray-200",children:a.username.charAt(0).toUpperCase()}),e.jsx("div",{className:`absolute -bottom-0.5 -right-0.5 w-3 h-3 rounded-full border-2 border-white ${a.status==="active"?"bg-emerald-500":a.status==="pending"?"bg-amber-500":"bg-rose-500"}`})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-800 truncate",children:a.username}),e.jsx("span",{className:`flex-shrink-0 px-1 py-0.5 rounded text-[8px] font-semibold ${a.status==="active"?"bg-emerald-100 text-emerald-600":a.status==="pending"?"bg-amber-100 text-amber-600":"bg-rose-100 text-rose-600"}`,children:a.status.toUpperCase()})]}),e.jsxs("p",{className:"text-[10px] text-gray-500 truncate",children:[a.predictionCount," predictions"]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:`text-[10px] font-medium ${a.incomeTrend>0?"text-emerald-600":a.incomeTrend<0?"text-rose-600":"text-gray-400"}`,children:[e.jsx("i",{className:`fas fa-arrow-${a.incomeTrend>0?"up":a.incomeTrend<0?"down":"right"} text-[8px] mr-0.5`}),"Inc: ",h(a.incomeTrend)]}),e.jsxs("span",{className:`text-[10px] font-medium ${a.savingsTrend>0?"text-emerald-600":a.savingsTrend<0?"text-rose-600":"text-gray-400"}`,children:[e.jsx("i",{className:`fas fa-arrow-${a.savingsTrend>0?"up":a.savingsTrend<0?"down":"right"} text-[8px] mr-0.5`}),"Sav: ",h(a.savingsTrend)]})]})]}),e.jsx("div",{className:"flex items-center gap-1 flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"w-7 h-7 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 transition-colors",onClick:u=>{u.stopPropagation(),S(a.userId)},onTouchEnd:u=>{u.stopPropagation(),S(a.userId)},"aria-label":"More actions",children:e.jsx("i",{className:"fas fa-ellipsis-v text-[10px]"})}),x===a.userId&&e.jsxs("div",{className:"dropdown-menu fixed w-28 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",style:{display:"block",zIndex:9999,transform:"translateX(-84px) translateY(4px)"},children:[e.jsxs("button",{className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50 active:bg-gray-100 flex items-center gap-2 transition-colors",onClick:u=>{u.stopPropagation(),r(),l(a)},onTouchEnd:u=>{u.stopPropagation(),r(),l(a)},children:[e.jsx("i",{className:"fas fa-eye text-gray-500 text-[10px]"}),e.jsx("span",{className:"text-gray-700",children:"View"})]}),e.jsx("div",{className:"border-t border-gray-200"}),e.jsxs("button",{className:"w-full px-3 py-2 text-left text-xs hover:bg-red-50 active:bg-red-100 flex items-center gap-2 transition-colors",onClick:u=>{u.stopPropagation(),r(),j(a)},onTouchEnd:u=>{u.stopPropagation(),r(),j(a)},children:[e.jsx("i",{className:"fas fa-trash text-red-500 text-[10px]"}),e.jsx("span",{className:"text-red-600",children:"Delete"})]})]})]})})]})},a.userId)):e.jsxs("div",{className:"px-3 py-8 text-center",children:[e.jsx("i",{className:"fas fa-chart-line text-gray-300 text-2xl mb-2"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"No predictions found"}),e.jsx("p",{className:"text-[10px] text-gray-400",children:"Try adjusting your filters"})]})}),n>1&&e.jsxs("div",{className:"px-3 py-2 border-t border-gray-100 bg-gray-50 flex items-center justify-between",children:[e.jsxs("button",{className:"px-2 py-1 text-[10px] font-medium text-gray-600 bg-white border border-gray-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>g(Math.max(t.currentPage-1,1)),disabled:t.currentPage===1,children:[e.jsx("i",{className:"fas fa-chevron-left mr-1 text-[8px]"}),"Prev"]}),e.jsxs("span",{className:"text-[10px] text-gray-500",children:[t.currentPage," / ",n]}),e.jsxs("button",{className:"px-2 py-1 text-[10px] font-medium text-gray-600 bg-white border border-gray-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>g(Math.min(t.currentPage+1,n)),disabled:t.currentPage===n,children:["Next",e.jsx("i",{className:"fas fa-chevron-right ml-1 text-[8px]"})]})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header bg-white border-0 py-3",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"m-0 font-weight-bold text-danger",children:[e.jsx("i",{className:"fas fa-chart-line mr-2"}),"User Predictions (",f,")"]}),e.jsx("div",{className:"table-actions",children:e.jsxs("small",{className:"text-muted",children:["Showing ",Math.min((t.currentPage-1)*t.pageSize+1,f)," to ",Math.min(t.currentPage*t.pageSize,f)," of ",f," entries"]})})]})}),e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover modern-table mb-0",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>d("username"),children:["Username",N("username")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>d("lastPredictionDate"),children:["Last Updated",N("lastPredictionDate")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>d("incomeTrend"),children:["Income Trend",N("incomeTrend")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>d("savingsTrend"),children:["Savings Trend",N("savingsTrend")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>d("status"),children:["Status",N("status")]}),e.jsx("th",{className:"border-0 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:s.length>0?s.map(a=>e.jsxs("tr",{className:"table-row",children:[e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{className:"user-avatar-container mr-3",children:[a.avatarUrl?e.jsx("img",{src:a.avatarUrl,alt:a.username,className:"user-table-avatar rounded-circle",style:{width:"40px",height:"40px",objectFit:"cover"}}):e.jsx("div",{className:"user-table-avatar bg-primary text-white d-flex align-items-center justify-content-center rounded-circle",style:{width:"40px",height:"40px"},children:a.username.charAt(0).toUpperCase()}),e.jsx("div",{className:`user-status-dot status-${a.status}`})]}),e.jsxs("div",{className:"user-info",children:[e.jsx("div",{className:"user-name font-weight-medium",children:a.username}),e.jsxs("div",{className:"user-id text-muted small",children:["Predictions: ",a.predictionCount]})]})]})}),e.jsx("td",{className:"py-3",children:a.lastPredictionDate||"—"}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:T(a.incomeTrend),children:h(a.incomeTrend)})}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:T(a.savingsTrend),children:h(a.savingsTrend)})}),e.jsx("td",{className:"py-3",children:z(a.status)}),e.jsx("td",{className:"py-3",children:e.jsx("div",{className:"action-buttons",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>S(a.userId),title:"More actions",children:e.jsx("i",{className:"fas fa-ellipsis-v"})}),x===a.userId&&e.jsxs("div",{className:"dropdown-menu show position-absolute",style:{right:0,top:"100%",zIndex:1e3},children:[e.jsxs("button",{className:"dropdown-item",onClick:()=>{r(),l(a)},children:[e.jsx("i",{className:"fas fa-eye text-gray-500 mr-2"}),"View Details"]}),e.jsx("div",{className:"dropdown-divider"}),e.jsxs("button",{className:"dropdown-item text-danger",onClick:()=>{r(),j(a)},children:[e.jsx("i",{className:"fas fa-trash text-danger mr-2"}),"Delete"]})]})]})})})]},a.userId)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-5",children:e.jsxs("div",{className:"no-users-container",children:[e.jsx("i",{className:"fas fa-chart-line fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No predictions found"}),e.jsx("p",{className:"text-muted",children:"Try adjusting your search or filter criteria"})]})})})})]})})}),n>1&&e.jsx("div",{className:"card-footer bg-white border-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("div",{className:"pagination-info",children:e.jsxs("small",{className:"text-muted",children:["Page ",t.currentPage," of ",n]})}),e.jsx("nav",{"aria-label":"Prediction pagination",children:e.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[e.jsx("li",{className:`page-item ${t.currentPage===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>g(1),disabled:t.currentPage===1,children:e.jsx("i",{className:"fas fa-angle-double-left"})})}),e.jsx("li",{className:`page-item ${t.currentPage===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>g(Math.max(t.currentPage-1,1)),disabled:t.currentPage===1,children:e.jsx("i",{className:"fas fa-angle-left"})})}),Array.from({length:Math.min(5,n)},(a,u)=>{let U;return n<=5||t.currentPage<=3?U=u+1:t.currentPage>=n-2?U=n-4+u:U=t.currentPage-2+u,e.jsx("li",{className:`page-item ${t.currentPage===U?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>g(U),children:U})},U)}),e.jsx("li",{className:`page-item ${t.currentPage===n?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>g(Math.min(t.currentPage+1,n)),disabled:t.currentPage===n,children:e.jsx("i",{className:"fas fa-angle-right"})})}),e.jsx("li",{className:`page-item ${t.currentPage===n?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>g(n),disabled:t.currentPage===n,children:e.jsx("i",{className:"fas fa-angle-double-right"})})})]})})]})})]})})]})},Ue=({prediction:s,show:t,onClose:n,onDelete:f})=>{const[b,d]=c.useState("overview");if(!t||!s)return null;const g=r=>{switch(r){case"active":return{label:"Active",color:"#28a745",bgColor:"rgba(40, 167, 69, 0.1)",icon:"fa-check-circle"};case"pending":return{label:"Pending",color:"#fd7e14",bgColor:"rgba(253, 126, 20, 0.1)",icon:"fa-clock"};case"error":return{label:"Error",color:"#dc3545",bgColor:"rgba(220, 53, 69, 0.1)",icon:"fa-exclamation-triangle"};default:return{label:"Unknown",color:"#6c757d",bgColor:"rgba(108, 117, 125, 0.1)",icon:"fa-question-circle"}}},l=r=>r>0?{color:"#28a745",icon:"fa-arrow-up",label:"Up"}:r<0?{color:"#dc3545",icon:"fa-arrow-down",label:"Down"}:{color:"#6c757d",icon:"fa-minus",label:"Stable"},j=r=>!r||r===0?"0%":`${r>0?"+":""}${r.toFixed(1)}%`,x=g(s.status),o=s.predictionAccuracy||0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:n}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:n,children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",onClick:r=>r.stopPropagation(),style:{margin:"auto",maxWidth:"95vw"},children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"90vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-2 md:py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"36px",height:"36px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-chart-line"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold text-sm md:text-base",children:"Prediction Details"}),e.jsx("small",{className:"text-xs md:text-sm truncate block max-w-[150px] md:max-w-none",style:{opacity:.9},children:s.username})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:n,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsx("div",{className:"px-3 py-2",style:{background:"#f8f9fa",borderBottom:"1px solid #e9ecef"},children:e.jsxs("div",{className:"row text-center g-2",children:[e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:`fas ${x.icon} mr-2`,style:{color:x.color}}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Status"}),e.jsx("strong",{style:{color:x.color,fontSize:"0.8rem"},children:x.label})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-bullseye text-danger mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Accuracy"}),e.jsxs("strong",{className:"text-danger",style:{fontSize:"0.8rem"},children:[o.toFixed(1),"%"]})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-chart-bar text-danger mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Count"}),e.jsx("strong",{className:"text-danger",style:{fontSize:"0.8rem"},children:s.predictionCount})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-calendar-alt text-danger mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Updated"}),e.jsx("strong",{className:"text-danger",style:{fontSize:"0.8rem"},children:s.lastPredictionDate?new Date(s.lastPredictionDate).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"N/A"})]})]})})]})}),e.jsx("div",{className:"px-2 md:px-3 pt-2",children:e.jsx("div",{className:"flex gap-1 md:gap-2 overflow-x-auto",children:[{id:"overview",icon:"fa-chart-pie",label:"Overview"},{id:"trends",icon:"fa-chart-line",label:"Trends"},{id:"actions",icon:"fa-cogs",label:"Actions"}].map(r=>e.jsxs("button",{className:`flex-shrink-0 px-2 md:px-3 py-1 text-[10px] md:text-xs rounded-full transition-colors ${b===r.id?"bg-red-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,onClick:()=>d(r.id),children:[e.jsx("i",{className:`fas ${r.icon} mr-1`}),r.label]},r.id))})}),e.jsxs("div",{className:"modal-body py-3",style:{maxHeight:"50vh",overflowY:"auto"},children:[b==="overview"&&e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-5 text-center mb-3 mb-lg-0",children:[e.jsxs("div",{className:"position-relative d-inline-block mb-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center rounded-circle",style:{width:"100px",height:"100px",background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)",margin:"0 auto"},children:e.jsx("i",{className:"fas fa-chart-line fa-3x text-white"})}),e.jsx("div",{className:"position-absolute",style:{bottom:"5px",right:"5px",width:"20px",height:"20px",borderRadius:"50%",background:x.color,border:"2px solid white"}})]}),e.jsx("h6",{className:"font-weight-bold mb-1",children:s.username}),e.jsx("p",{className:"text-muted mb-2",style:{fontSize:"0.85rem"},children:e.jsxs("code",{style:{fontSize:"0.75rem"},children:[s.userId.substring(0,12),"..."]})}),e.jsxs("div",{className:"d-flex justify-content-center flex-wrap",style:{gap:"6px"},children:[e.jsxs(re,{bg:s.status==="active"?"success":s.status==="pending"?"warning":"danger",style:{fontSize:"0.7rem"},children:[e.jsx("i",{className:`fas ${x.icon} mr-1`}),x.label]}),e.jsxs(re,{bg:"primary",style:{fontSize:"0.7rem"},children:[e.jsx("i",{className:"fas fa-chart-bar mr-1"}),s.predictionCount," Predictions"]}),o>0&&e.jsxs(re,{bg:"info",style:{fontSize:"0.7rem"},children:[e.jsx("i",{className:"fas fa-bullseye mr-1"}),o.toFixed(1),"% Accuracy"]})]})]}),e.jsxs("div",{className:"col-lg-7",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Prediction Info"]}),e.jsxs("div",{className:"p-2",style:{background:"#f8f9fa",borderRadius:"8px",fontSize:"0.85rem"},children:[e.jsxs("div",{className:"d-flex justify-content-between py-1",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"User ID"}),e.jsxs("code",{style:{fontSize:"0.75rem"},children:[s.userId.substring(0,16),"..."]})]}),e.jsxs("div",{className:"d-flex justify-content-between py-1",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Total Predictions"}),e.jsx("strong",{className:"text-danger",style:{fontSize:"0.8rem"},children:s.predictionCount})]}),e.jsxs("div",{className:"d-flex justify-content-between py-1",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Accuracy Score"}),e.jsx("strong",{className:o>=80?"text-success":o>=60?"text-warning":"text-danger",style:{fontSize:"0.8rem"},children:o>0?`${o.toFixed(1)}%`:"N/A"})]}),e.jsxs("div",{className:"d-flex justify-content-between py-1",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Status"}),e.jsx(re,{bg:s.status==="active"?"success":s.status==="pending"?"warning":"danger",style:{fontSize:"0.65rem"},children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]}),e.jsxs("div",{className:"d-flex justify-content-between py-1",children:[e.jsx("small",{className:"text-muted",children:"Last Updated"}),e.jsx("span",{style:{fontSize:"0.8rem"},children:s.lastPredictionDate||"Never"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-tachometer-alt mr-2"}),"Accuracy Score"]}),e.jsxs("div",{className:"p-2",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsx("small",{children:"Model Accuracy"}),e.jsxs("strong",{className:o>=80?"text-success":o>=60?"text-warning":"text-danger",style:{fontSize:"0.85rem"},children:[o.toFixed(1),"%"]})]}),e.jsx("div",{className:"progress",style:{height:"6px",borderRadius:"3px"},children:e.jsx("div",{className:`progress-bar ${o>=80?"bg-success":o>=60?"bg-warning":"bg-danger"}`,style:{width:`${o}%`,borderRadius:"3px"}})})]})]})]})]}),b==="trends"&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-3",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-chart-area mr-2"}),"Financial Trends Analysis"]}),e.jsxs("div",{className:"row g-2",children:[e.jsx("div",{className:"col-md-4 mb-3",children:e.jsxs("div",{className:"p-3 text-center h-100",style:{background:"#f8f9fa",borderRadius:"8px",border:`2px solid ${l(s.incomeTrend).color}20`},children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mb-2",style:{width:"50px",height:"50px",background:`${l(s.incomeTrend).color}15`,borderRadius:"50%",margin:"0 auto"},children:e.jsx("i",{className:`fas ${l(s.incomeTrend).icon}`,style:{color:l(s.incomeTrend).color,fontSize:"1.2rem"}})}),e.jsx("h6",{className:"mb-1",style:{fontSize:"0.85rem"},children:"Income Trend"}),e.jsx("h4",{className:"mb-0 font-weight-bold",style:{color:l(s.incomeTrend).color},children:j(s.incomeTrend)}),e.jsx("small",{className:"text-muted",children:l(s.incomeTrend).label})]})}),e.jsx("div",{className:"col-md-4 mb-3",children:e.jsxs("div",{className:"p-3 text-center h-100",style:{background:"#f8f9fa",borderRadius:"8px",border:`2px solid ${l(s.expenseTrend).color}20`},children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mb-2",style:{width:"50px",height:"50px",background:`${l(s.expenseTrend).color}15`,borderRadius:"50%",margin:"0 auto"},children:e.jsx("i",{className:`fas ${l(s.expenseTrend).icon}`,style:{color:l(s.expenseTrend).color,fontSize:"1.2rem"}})}),e.jsx("h6",{className:"mb-1",style:{fontSize:"0.85rem"},children:"Expense Trend"}),e.jsx("h4",{className:"mb-0 font-weight-bold",style:{color:l(s.expenseTrend).color},children:j(s.expenseTrend)}),e.jsx("small",{className:"text-muted",children:l(s.expenseTrend).label})]})}),e.jsx("div",{className:"col-md-4 mb-3",children:e.jsxs("div",{className:"p-3 text-center h-100",style:{background:"#f8f9fa",borderRadius:"8px",border:`2px solid ${l(s.savingsTrend).color}20`},children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mb-2",style:{width:"50px",height:"50px",background:`${l(s.savingsTrend).color}15`,borderRadius:"50%",margin:"0 auto"},children:e.jsx("i",{className:`fas ${l(s.savingsTrend).icon}`,style:{color:l(s.savingsTrend).color,fontSize:"1.2rem"}})}),e.jsx("h6",{className:"mb-1",style:{fontSize:"0.85rem"},children:"Savings Trend"}),e.jsx("h4",{className:"mb-0 font-weight-bold",style:{color:l(s.savingsTrend).color},children:j(s.savingsTrend)}),e.jsx("small",{className:"text-muted",children:l(s.savingsTrend).label})]})})]}),e.jsxs("div",{className:"p-3 mt-2",style:{background:"#fff5f5",borderRadius:"8px",borderLeft:"3px solid #dc3545"},children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.85rem"},children:[e.jsx("i",{className:"fas fa-lightbulb mr-2"}),"Trend Summary"]}),e.jsxs("p",{className:"mb-0 text-muted",style:{fontSize:"0.8rem"},children:["Based on the prediction analysis, this user shows",e.jsxs("strong",{style:{color:l(s.incomeTrend).color},children:[" ",l(s.incomeTrend).label.toLowerCase()," income"]}),",",e.jsxs("strong",{style:{color:l(s.expenseTrend).color},children:[" ",l(s.expenseTrend).label.toLowerCase()," expenses"]}),", and",e.jsxs("strong",{style:{color:l(s.savingsTrend).color},children:[" ",l(s.savingsTrend).label.toLowerCase()," savings"]})," trends."]})]})]}),b==="actions"&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-3",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-tools mr-2"}),"Prediction Management"]}),e.jsx("div",{className:"row g-2",children:e.jsx("div",{className:"col-md-6 mb-2",children:e.jsxs("div",{className:"p-3 text-center h-100",style:{background:"#f8f9fa",borderRadius:"8px",cursor:"pointer",border:"1px solid transparent",transition:"all 0.2s"},onClick:()=>f(s),onMouseEnter:r=>{r.currentTarget.style.borderColor="#dc3545",r.currentTarget.style.background="#fff5f5"},onMouseLeave:r=>{r.currentTarget.style.borderColor="transparent",r.currentTarget.style.background="#f8f9fa"},children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mb-2",style:{width:"40px",height:"40px",background:"rgba(220, 53, 69, 0.1)",borderRadius:"8px",margin:"0 auto"},children:e.jsx("i",{className:"fas fa-trash-alt text-danger"})}),e.jsx("h6",{className:"mb-1",style:{fontSize:"0.85rem"},children:"Delete Prediction"}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.75rem"},children:"Permanently remove all data"})]})})})]})]}),e.jsxs("div",{className:"modal-footer border-0 py-2",style:{background:"#f8f9fa"},children:[e.jsxs("small",{className:"text-muted mr-auto",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"fas fa-fingerprint mr-1"}),"ID: ",e.jsxs("code",{style:{fontSize:"0.7rem"},children:[s.userId.substring(0,12),"..."]})]}),e.jsxs("button",{type:"button",className:"btn btn-danger btn-sm",onClick:n,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Close"]})]})]})})})]})},Ee=({show:s,onClose:t,onAdd:n,users:f,loading:b=!1})=>{const[d,g]=c.useState({user_id:"",timeframe:"monthly",confidence_score:80}),[l,j]=c.useState({}),[x,o]=c.useState(!1),r=(h,a)=>{g(u=>({...u,[h]:a})),l[h]&&j(u=>({...u,[h]:""}))},S=()=>{const h={};return d.user_id||(h.user_id="Please select a user"),d.timeframe||(h.timeframe="Please select a prediction timeframe"),d.confidence_score&&(d.confidence_score<0||d.confidence_score>100)&&(h.confidence_score="Confidence score must be between 0 and 100"),j(h),Object.keys(h).length===0},N=async h=>{if(h.preventDefault(),!!S()){o(!0);try{await n(d),g({user_id:"",timeframe:"monthly",confidence_score:80}),j({}),t()}catch(a){console.error("Error adding prediction:",a)}finally{o(!1)}}},z=()=>{g({user_id:"",timeframe:"monthly",confidence_score:80}),j({}),t()};if(!s)return null;const T=f.find(h=>h.id===d.user_id);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:z}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:z,children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",onClick:h=>h.stopPropagation(),style:{margin:"auto",maxWidth:"95vw"},children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"90vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-2 md:py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"36px",height:"36px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-plus-circle"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold text-sm md:text-base",children:"Add New Prediction"}),e.jsx("small",{className:"hidden md:inline",style:{opacity:.9},children:"Generate financial forecasts"})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:z,disabled:x,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsx("div",{className:"px-2 md:px-3 py-2",style:{background:"#f8f9fa",borderBottom:"1px solid #e9ecef"},children:e.jsxs("div",{className:"grid grid-cols-3 gap-1 md:gap-2 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("i",{className:"fas fa-user text-red-500 mr-1 md:mr-2 text-[10px] md:text-sm"}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"text-gray-500 block text-[8px] md:text-[10px] leading-tight",children:"User"}),e.jsx("strong",{className:"text-red-500 text-[10px] md:text-xs truncate max-w-[60px] block",children:T?T.user_metadata?.full_name?.split(" ")[0]||"Selected":"None"})]})]}),e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("i",{className:"fas fa-calendar text-red-500 mr-1 md:mr-2 text-[10px] md:text-sm"}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"text-gray-500 block text-[8px] md:text-[10px] leading-tight",children:"Timeframe"}),e.jsx("strong",{className:"text-red-500 text-[10px] md:text-xs capitalize",children:d.timeframe||"Not Set"})]})]}),e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("i",{className:"fas fa-bullseye text-red-500 mr-1 md:mr-2 text-[10px] md:text-sm"}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"text-gray-500 block text-[8px] md:text-[10px] leading-tight",children:"Confidence"}),e.jsxs("strong",{className:"text-red-500 text-[10px] md:text-xs",children:[d.confidence_score,"%"]})]})]})]})}),e.jsxs("div",{className:"modal-body py-2 md:py-3 px-2 md:px-4",style:{maxHeight:"60vh",overflowY:"auto"},children:[e.jsx("div",{className:"hidden md:block p-3 mb-3",style:{background:"#e7f3ff",borderRadius:"8px",borderLeft:"3px solid #007bff"},children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{className:"fas fa-info-circle text-primary mr-2 mt-1"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-primary",style:{fontSize:"0.85rem"},children:"Prophet Forecasting"}),e.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.8rem"},children:"Predictions are generated using the Prophet model and analyze historical transaction data for accurate forecasts."})]})]})}),e.jsxs("form",{id:"add-prediction-form",onSubmit:N,children:[e.jsxs("h6",{className:"text-red-500 mb-2 text-xs md:text-sm flex items-center",children:[e.jsx("i",{className:"fas fa-user mr-2"}),"User Selection"]}),e.jsxs("div",{className:"p-2 md:p-3 mb-3 bg-gray-50 rounded-lg",children:[e.jsxs("label",{htmlFor:"user_id",className:"block text-xs md:text-sm text-gray-700 mb-1",children:["Select User ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:`w-full px-3 py-2 text-xs md:text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${l.user_id?"border-red-500":"border-gray-300"}`,id:"user_id",value:d.user_id,onChange:h=>r("user_id",h.target.value),disabled:b||x,children:[e.jsx("option",{value:"",children:"Choose a user..."}),f.map(h=>e.jsx("option",{value:h.id,children:h.user_metadata?.full_name||h.email},h.id))]}),l.user_id&&e.jsx("p",{className:"text-red-500 text-[10px] md:text-xs mt-1",children:l.user_id})]}),e.jsxs("h6",{className:"text-red-500 mb-2 text-xs md:text-sm flex items-center",children:[e.jsx("i",{className:"fas fa-cog mr-2"}),"Configuration"]}),e.jsx("div",{className:"p-2 md:p-3 mb-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"timeframe",className:"block text-xs md:text-sm text-gray-700 mb-1",children:["Timeframe ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:`w-full px-3 py-2 text-xs md:text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${l.timeframe?"border-red-500":"border-gray-300"}`,id:"timeframe",value:d.timeframe,onChange:h=>r("timeframe",h.target.value),disabled:b||x,children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]}),l.timeframe&&e.jsx("p",{className:"text-red-500 text-[10px] md:text-xs mt-1",children:l.timeframe})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confidence_score",className:"block text-xs md:text-sm text-gray-700 mb-1",children:"Confidence Score"}),e.jsx("input",{type:"number",className:`w-full px-3 py-2 text-xs md:text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${l.confidence_score?"border-red-500":"border-gray-300"}`,id:"confidence_score",min:"0",max:"100",value:d.confidence_score||"",onChange:h=>r("confidence_score",Number(h.target.value)),placeholder:"0-100",disabled:b||x}),l.confidence_score&&e.jsx("p",{className:"text-red-500 text-[10px] md:text-xs mt-1",children:l.confidence_score})]})]})}),e.jsxs("div",{className:"p-2 md:p-3 bg-red-50 rounded-lg border-l-3",style:{borderLeft:"3px solid #dc3545"},children:[e.jsxs("h6",{className:"text-red-500 mb-2 text-[11px] md:text-sm flex items-center",children:[e.jsx("i",{className:"fas fa-lightbulb mr-2"}),"What Happens Next"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-[9px] md:text-xs",children:[e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("i",{className:"fas fa-check-circle text-emerald-500 mt-0.5 text-[8px] md:text-[10px]"}),e.jsx("span",{className:"text-gray-500",children:"Prophet generates forecasts"})]}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("i",{className:"fas fa-check-circle text-emerald-500 mt-0.5 text-[8px] md:text-[10px]"}),e.jsx("span",{className:"text-gray-500",children:"Auto-calculated confidence"})]}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("i",{className:"fas fa-check-circle text-emerald-500 mt-0.5 text-[8px] md:text-[10px]"}),e.jsx("span",{className:"text-gray-500",children:"Historical data analyzed"})]}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("i",{className:"fas fa-check-circle text-emerald-500 mt-0.5 text-[8px] md:text-[10px]"}),e.jsx("span",{className:"text-gray-500",children:"Real-time updates"})]})]})]})]})]}),e.jsxs("div",{className:"modal-footer border-0 py-2 px-2 md:px-3 flex justify-between items-center",style:{background:"#f8f9fa"},children:[e.jsxs("small",{className:"text-gray-400 text-[9px] md:text-xs hidden md:block",children:[e.jsx("i",{className:"fas fa-clock mr-1"}),"Generation may take a moment"]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs("button",{type:"button",className:"flex-1 md:flex-none px-3 py-1.5 text-xs md:text-sm border border-gray-300 text-gray-600 rounded-lg hover:bg-gray-100 disabled:opacity-50",onClick:z,disabled:x,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Cancel"]}),e.jsx("button",{type:"submit",form:"add-prediction-form",className:"flex-1 md:flex-none px-3 py-1.5 text-xs md:text-sm bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50 flex items-center justify-center",disabled:x||b,children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-1",children:"⏳"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-plus-circle mr-1"}),"Create"]})})]})]})]})})})]})},Fe=({show:s,prediction:t,onClose:n,onDelete:f,loading:b=!1})=>{const[d,g]=c.useState(""),[l,j]=c.useState(!1),x=async()=>{if(t&&d==="DELETE"){j(!0);try{await f(t.userId),o()}catch(N){console.error("Error deleting prediction:",N)}finally{j(!1)}}},o=()=>{g(""),n()};if(!s||!t)return null;const r=d==="DELETE"&&!l,S=t.predictionAccuracy||0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:o}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:o,children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",onClick:N=>N.stopPropagation(),style:{margin:"auto",maxWidth:"95vw"},children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"90vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-2 md:py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"36px",height:"36px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-trash-alt"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold text-sm md:text-base",children:"Delete Prediction"}),e.jsx("small",{className:"hidden md:inline",style:{opacity:.9},children:"This action cannot be undone"})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:o,disabled:l,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsxs("div",{className:"modal-body py-2 md:py-3 px-2 md:px-4",style:{maxHeight:"65vh",overflowY:"auto"},children:[e.jsx("div",{className:"p-2 md:p-3 mb-3 bg-red-50 rounded-lg",style:{borderLeft:"3px solid #dc3545"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-red-500 mt-0.5 text-xs md:text-sm"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-red-500 text-xs md:text-sm",children:"Permanent Deletion"}),e.jsx("p",{className:"mb-0 text-gray-500 text-[10px] md:text-xs",children:"This will permanently remove all prediction data for this user."})]})]})}),e.jsxs("div",{className:"p-2 md:p-3 mb-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 md:mb-3",children:[e.jsx("div",{className:"w-8 h-8 md:w-9 md:h-9 rounded-full flex items-center justify-center",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsx("i",{className:"fas fa-chart-line text-white text-xs md:text-sm"})}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-xs md:text-sm block",children:t.username}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`px-1 py-0.5 rounded text-[8px] md:text-[10px] font-semibold ${t.status==="active"?"bg-emerald-100 text-emerald-600":t.status==="pending"?"bg-amber-100 text-amber-600":"bg-red-100 text-red-600"}`,children:t.status}),e.jsxs("span",{className:"bg-blue-100 text-blue-600 px-1 py-0.5 rounded text-[8px] md:text-[10px] font-semibold",children:[t.predictionCount," predictions"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 md:gap-2 text-center",children:[e.jsxs("div",{className:"p-1.5 md:p-2 bg-white rounded-md",children:[e.jsx("span",{className:"text-gray-500 block text-[8px] md:text-[10px]",children:"Predictions"}),e.jsx("strong",{className:"text-red-500 text-xs md:text-sm",children:t.predictionCount})]}),e.jsxs("div",{className:"p-1.5 md:p-2 bg-white rounded-md",children:[e.jsx("span",{className:"text-gray-500 block text-[8px] md:text-[10px]",children:"Accuracy"}),e.jsx("strong",{className:`text-xs md:text-sm ${S>=80?"text-emerald-500":S>=60?"text-amber-500":"text-red-500"}`,children:S>0?`${S.toFixed(1)}%`:"N/A"})]}),e.jsxs("div",{className:"p-1.5 md:p-2 bg-white rounded-md",children:[e.jsx("span",{className:"text-gray-500 block text-[8px] md:text-[10px]",children:"Updated"}),e.jsx("strong",{className:"text-gray-600 text-[10px] md:text-xs",children:t.lastPredictionDate?new Date(t.lastPredictionDate).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"Never"})]})]})]}),e.jsxs("h6",{className:"text-red-500 mb-2 text-[11px] md:text-sm flex items-center",children:[e.jsx("i",{className:"fas fa-list mr-2"}),"What Will Be Deleted"]}),e.jsx("div",{className:"p-2 md:p-3 mb-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-[9px] md:text-xs",children:[e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("i",{className:"fas fa-database text-red-500 mt-0.5 text-[8px] md:text-[10px]"}),e.jsx("span",{className:"text-gray-500",children:"Historical data"})]}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("i",{className:"fas fa-bullseye text-red-500 mt-0.5 text-[8px] md:text-[10px]"}),e.jsx("span",{className:"text-gray-500",children:"Accuracy metrics"})]}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("i",{className:"fas fa-chart-line text-red-500 mt-0.5 text-[8px] md:text-[10px]"}),e.jsx("span",{className:"text-gray-500",children:"Trend analysis"})]}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx("i",{className:"fas fa-history text-red-500 mt-0.5 text-[8px] md:text-[10px]"}),e.jsx("span",{className:"text-gray-500",children:"Confidence scores"})]})]})}),e.jsxs("h6",{className:"text-red-500 mb-2 text-[11px] md:text-sm flex items-center",children:[e.jsx("i",{className:"fas fa-keyboard mr-2"}),"Confirmation Required"]}),e.jsxs("div",{className:"p-2 md:p-3 bg-gray-50 rounded-lg",children:[e.jsxs("p",{className:"text-gray-500 mb-2 text-[10px] md:text-xs",children:["Type ",e.jsx("code",{className:"bg-red-500 text-white px-1.5 py-0.5 rounded text-[10px] md:text-xs",children:"DELETE"})," to confirm:"]}),e.jsx("input",{type:"text",className:`w-full px-3 py-2 text-xs md:text-sm border rounded-lg focus:ring-2 outline-none ${d&&d!=="DELETE"?"border-red-500 focus:ring-red-200":d==="DELETE"?"border-emerald-500 focus:ring-emerald-200":"border-gray-300 focus:ring-red-200 focus:border-red-400"}`,value:d,onChange:N=>g(N.target.value),placeholder:"Type DELETE to confirm",disabled:l,autoComplete:"off"}),d&&d!=="DELETE"&&e.jsx("p",{className:"text-red-500 text-[10px] md:text-xs mt-1",children:'Please type "DELETE" exactly as shown above.'})]})]}),e.jsxs("div",{className:"modal-footer border-0 py-2 px-2 md:px-3 flex justify-between items-center",style:{background:"#f8f9fa"},children:[e.jsxs("small",{className:"text-gray-400 text-[9px] md:text-xs hidden md:block",children:[e.jsx("i",{className:"fas fa-shield-alt mr-1"}),"This action is irreversible"]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs("button",{type:"button",className:"flex-1 md:flex-none px-3 py-1.5 text-xs md:text-sm border border-gray-300 text-gray-600 rounded-lg hover:bg-gray-100 disabled:opacity-50",onClick:o,disabled:l,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Cancel"]}),e.jsx("button",{type:"button",className:"flex-1 md:flex-none px-3 py-1.5 text-xs md:text-sm bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50 flex items-center justify-center",onClick:x,disabled:!r,children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-1",children:"⏳"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-trash-alt mr-1"}),"Delete"]})})]})]})]})})})]})},V=95,le=()=>{try{if(Ne)return Ne}catch{console.log("Admin client not available, using regular client")}return J},Me=()=>{const[s,t]=c.useState([]),[n,f]=c.useState([]),[b,d]=c.useState([]),[g,l]=c.useState({totalPredictions:0,activePredictions:0,predictionUsers:0,averageAccuracy:V,predictionsByStatus:{active:0,pending:0,error:0},predictionsByType:{income:0,expense:0,savings:0},predictionsByUser:{}}),[j,x]=c.useState([]),[o,r]=c.useState([]),[S,N]=c.useState([]),[z,T]=c.useState(!0),[h,a]=c.useState(1),[u,U]=c.useState(0),{showSuccessToast:I,showErrorToast:v}=Te(),G=c.useCallback(async()=>{try{const m=le();if(!m)throw new Error("Supabase client not available");const{data:p,error:A}=await m.from("profiles").select("id, full_name, email, avatar_url");if(A)throw A;const P=(p||[]).map(y=>({id:y.id,email:y.email||"",full_name:y.full_name,avatar_url:y.avatar_url,user_metadata:{full_name:y.full_name,avatar_url:y.avatar_url}}));d(P)}catch(m){console.error("Error fetching users:",m),v("Failed to load users")}},[v]),W=c.useCallback(async()=>{try{const m=le(),{data:p,error:A}=await m.from("prophet_predictions").select("id, generated_at"),P=p?.length||0,y=new Date;y.setDate(y.getDate()-7);const $=p?.filter(_=>new Date(_.generated_at)<y).length||0,E=[{id:"1",name:"Fallback Financial Forecasting",status:"active",type:"Prophet",description:"Local fallback model with 95% confidence for time series forecasting",lastUpdated:new Date().toISOString(),requests:P,errors:$}];f(E)}catch(m){console.error("Error fetching services:",m),v("Failed to load prediction services")}},[v]),Q=c.useCallback(async()=>{try{const m=le(),{data:p,error:A}=await m.from("prophet_predictions").select("generated_at, confidence_score").order("generated_at",{ascending:!0});if(A)throw A;const P={};(p||[]).forEach(E=>{const _=new Date(E.generated_at).toISOString().substring(0,7);P[_]||(P[_]={total:0,count:0});const H=(E.confidence_score||.95)*100;P[_].total+=H,P[_].count+=1});const y=[],$=new Date;for(let E=5;E>=0;E--){const _=new Date($.getFullYear(),$.getMonth()-E,1),H=_.toISOString().substring(0,7),F=_.toLocaleDateString("en-US",{month:"short",year:"2-digit"}),C=P[H],R=C?C.total/C.count:V,Z=Math.max(0,Math.min(20,100-R));y.push({month:F,accuracy:Number(R.toFixed(1)),error:Number(Z.toFixed(1)),predictions:C?.count||0})}return N(y),y}catch(m){console.error("Error generating historical accuracy:",m);const p=[],A=new Date;for(let P=5;P>=0;P--){const y=new Date(A.getFullYear(),A.getMonth()-P,1);p.push({month:y.toLocaleDateString("en-US",{month:"short",year:"2-digit"}),accuracy:V,error:5,predictions:0})}return N(p),p}},[]),B=c.useCallback(async m=>{try{T(!0);const p=le();if(!p)throw new Error("Supabase client not available");const{data:A,error:P}=await p.from("profiles").select("id, full_name, email, avatar_url");if(P)throw P;const y=(A||[]).map(i=>({id:i.id,email:i.email||"",full_name:i.full_name,avatar_url:i.avatar_url,user_metadata:{full_name:i.full_name,avatar_url:i.avatar_url}}));d(y);const{data:$,error:E}=await p.from("prophet_predictions").select("user_id, generated_at, confidence_score"),{data:_,error:H}=await p.from("transactions").select("user_id, amount, type, date, category");if(H&&console.warn("Error fetching transactions:",H),E)throw E;const F=await Promise.all((y||[]).filter(i=>i&&i.id).map(async i=>{const M=$?.filter(w=>w&&w.user_id===i.id)||[],Y=_?.filter(w=>w&&w.user_id===i.id)||[],O=M.length>0?M.filter(w=>w.generated_at).sort((w,L)=>new Date(L.generated_at).getTime()-new Date(w.generated_at).getTime())[0]:null,K=new Date;K.setMonth(K.getMonth()-3);const ee=Y.filter(w=>new Date(w.date)>=K),q={};ee.forEach(w=>{const L=w.date.substring(0,7);q[L]||(q[L]={income:0,expenses:0}),w.type==="income"?q[L].income+=w.amount:q[L].expenses+=w.amount});const se=Object.keys(q).sort();let fe=0,pe=0,be=0;if(se.length>=2){const w=q[se[se.length-1]],L=se.slice(0,-1).map(X=>q[X]),ae=L.reduce((X,me)=>X+me.income,0)/L.length,te=L.reduce((X,me)=>X+me.expenses,0)/L.length,oe=ae-te,Ae=w.income-w.expenses;fe=ae>0?Math.max(-15,Math.min(15,(w.income-ae)/ae*100)):0,pe=te>0?Math.max(-15,Math.min(15,(w.expenses-te)/te*100)):0,be=Math.abs(oe)>0?Math.max(-15,Math.min(15,(Ae-oe)/Math.abs(oe)*100)):0}const De=V;let de="pending";return(Y.length>=7||M.length>0)&&(de="active"),{userId:i.id||"",username:i.user_metadata?.full_name||i.full_name||i.email?.split("@")[0]||"Unknown User",avatarUrl:i.user_metadata?.avatar_url||i.avatar_url||"",lastPredictionDate:O&&O.generated_at?new Date(O.generated_at).toISOString().split("T")[0]:"",predictionAccuracy:De,incomeTrend:Number(fe.toFixed(1)),expenseTrend:Number(pe.toFixed(1)),savingsTrend:Number(be.toFixed(1)),predictionCount:M.length||0,status:de}}));let C=[...F];m.filterStatus!=="all"&&(C=C.filter(i=>i.status===m.filterStatus)),m.searchTerm&&(C=C.filter(i=>i.username.toLowerCase().includes(m.searchTerm.toLowerCase()))),C.sort((i,M)=>{const Y=i[m.sortField],O=M[m.sortField];if(typeof Y=="string"&&typeof O=="string")return m.sortDirection==="asc"?Y.localeCompare(O):O.localeCompare(Y);{const K=Number(Y)||0,ee=Number(O)||0;return m.sortDirection==="asc"?K-ee:ee-K}});const R=C.length,Z=(m.currentPage-1)*m.pageSize,Pe=C.slice(Z,Z+m.pageSize);t(Pe),U(R),a(Math.ceil(R/m.pageSize));const xe=$?.length||0,he=F.filter(i=>i.status==="active").length,ue=_?.filter(i=>i.type==="income").length||0,ge=_?.filter(i=>i.type==="expense").length||0;x([{name:"Model Confidence",value:V,description:"Fallback model confidence score (fixed at 95%)",type:"percentage"},{name:"Total Predictions",value:xe,description:"Total number of predictions generated",type:"count"},{name:"Active Users",value:he,description:"Users with sufficient transaction data",type:"count"},{name:"Total Transactions",value:_?.length||0,description:"All transactions across users",type:"count"}]);const Ce={"High (90-100%)":F.filter(i=>i.predictionAccuracy>=90).length,"Medium (70-89%)":F.filter(i=>i.predictionAccuracy>=70&&i.predictionAccuracy<90).length,"Low (50-69%)":F.filter(i=>i.predictionAccuracy>=50&&i.predictionAccuracy<70).length,"Very Low (<50%)":F.filter(i=>i.predictionAccuracy<50).length},ce=Object.entries(Ce).filter(([i,M])=>M>0).map(([i,M])=>({name:i,value:M}));ce.length===0&&ce.push({name:"No Data",value:1}),r(ce),await Q(),l({totalPredictions:xe,activePredictions:he,predictionUsers:F.length,averageAccuracy:V,predictionsByStatus:{active:F.filter(i=>i.status==="active").length,pending:F.filter(i=>i.status==="pending").length,error:F.filter(i=>i.status==="error").length},predictionsByType:{income:ue,expense:ge,savings:Math.max(0,ue-ge)},predictionsByUser:F.reduce((i,M)=>(i[M.username]=M.predictionCount,i),{})}),T(!1)}catch(p){console.error("Error fetching prediction data:",p),v(`Failed to load predictions: ${p instanceof Error?p.message:"Unknown error"}`),t([]),l({totalPredictions:0,activePredictions:0,predictionUsers:0,averageAccuracy:V,predictionsByStatus:{active:0,pending:0,error:0},predictionsByType:{income:0,expense:0,savings:0},predictionsByUser:{}}),x([]),r([{name:"No Data",value:1}]),T(!1)}},[v,Q]),ne=c.useCallback(async m=>{T(!0);try{await G(),await W(),await B(m),I("Prediction data refreshed successfully")}catch{v("Failed to refresh prediction data")}finally{T(!1)}},[G,W,B,I,v]),D=c.useCallback(async m=>{try{T(!0);const p=s.map(A=>A.userId===m?{...A,lastPredictionDate:new Date().toISOString().split("T")[0],predictionAccuracy:V,status:"active"}:A);t(p),I("Predictions regenerated with 95% confidence fallback model"),T(!1)}catch{v("Failed to regenerate predictions"),T(!1)}},[s,I,v]),ie=c.useCallback(async()=>{try{return T(!0),await new Promise(m=>setTimeout(m,2e3)),I("Fallback model updated successfully (95% confidence)"),T(!1),!0}catch{return v("Failed to update model"),T(!1),!1}},[I,v]);return c.useEffect(()=>{let m;try{if(!J){console.error("Supabase client not available");return}m=J.channel("admin-predictions-channel"),m.on("postgres_changes",{event:"*",schema:"public",table:"prophet_predictions"},()=>{console.log("Prediction data updated")}).on("postgres_changes",{event:"*",schema:"public",table:"transactions"},()=>{console.log("Transaction data updated - trends may change")}).subscribe()}catch(p){console.error("Error setting up real-time subscriptions:",p)}return()=>{if(m&&J)try{J.removeChannel(m)}catch(p){console.error("Error cleaning up channel:",p)}}},[]),c.useEffect(()=>{W()},[W]),{predictions:s,services:n,users:b,stats:g,modelStats:j,userDistribution:o,historicalAccuracy:S,loading:z,totalPages:h,totalItems:u,fetchPredictions:B,fetchServices:W,fetchUsers:G,refreshPredictionData:ne,regeneratePredictions:D,updateModel:ie}},Se={searchTerm:"",filterStatus:"all",filterType:"all",sortField:"username",sortDirection:"asc",currentPage:1,pageSize:10},ze=()=>{const[s,t]=c.useState(Se),n=c.useCallback(r=>{t(S=>({...S,...r,currentPage:r.searchTerm!==void 0||r.filterStatus!==void 0||r.filterType!==void 0?1:r.currentPage||S.currentPage}))},[]),f=c.useCallback(()=>{t(Se)},[]),b=c.useCallback(r=>{n({searchTerm:r,currentPage:1})},[n]),d=c.useCallback(r=>{n({filterStatus:r,currentPage:1})},[n]),g=c.useCallback(r=>{n({filterType:r,currentPage:1})},[n]),l=c.useCallback((r,S)=>{const N=S||(s.sortField===r&&s.sortDirection==="asc"?"desc":"asc");n({sortField:r,sortDirection:N})},[s.sortField,s.sortDirection,n]),j=c.useCallback(r=>{n({currentPage:r})},[n]),x=c.useCallback(r=>{n({pageSize:r,currentPage:1})},[n]),o=c.useCallback(()=>s.searchTerm!==""||s.filterStatus!=="all"||s.filterType!=="all",[s]);return{filters:s,updateFilters:n,resetFilters:f,handleSearch:b,handleStatusFilter:d,handleTypeFilter:g,handleSort:l,handlePageChange:j,handlePageSizeChange:x,hasActiveFilters:o}},Be=()=>{const[s,t]=c.useState(new Date),[n,f]=c.useState(!1),[b,d]=c.useState(!1),[g,l]=c.useState(null),[j,x]=c.useState(!1),[o,r]=c.useState(!1),[S,N]=c.useState(!1),{showSuccessToast:z,showErrorToast:T}=Te(),{predictions:h,users:a,stats:u,userDistribution:U,historicalAccuracy:I,loading:v,totalPages:G,totalItems:W,fetchPredictions:Q,refreshPredictionData:B,updateModel:ne}=Me(),{filters:D,updateFilters:ie,handleSort:m,handlePageChange:p}=ze(),A=c.useCallback(()=>{Q(D)},[Q,D.searchTerm,D.filterStatus,D.filterType,D.sortField,D.sortDirection,D.currentPage,D.pageSize]);c.useEffect(()=>{A()},[A]);const P=c.useCallback(async()=>{f(!0),await B(D),t(new Date),f(!1)},[B,D]),y=C=>{l(C),x(!0)},$=C=>{l(C),N(!0)},E=()=>{l(null),x(!1),N(!1),r(!1)},_=async C=>{try{z("Prediction added successfully!"),r(!1),await B(D)}catch(R){console.error("Error adding prediction:",R),T("Failed to add prediction. Please try again.")}},H=async C=>{try{z("Prediction deleted successfully!"),N(!1),l(null),await B(D)}catch(R){console.error("Error deleting prediction:",R),T("Failed to delete prediction. Please try again.")}},F=async()=>{await ne()&&(d(!0),setTimeout(()=>{d(!1)},5e3))};return v?e.jsxs("div",{className:"modern-user-management",children:[e.jsx("div",{className:"block md:hidden py-12 animate__animated animate__fadeIn",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"mt-3 text-xs text-gray-500 font-medium",children:"Loading predictions..."})]})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"user-management-header mb-5",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start flex-wrap",children:[e.jsx("div",{className:"header-content",children:e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"header-icon-container mr-3",children:e.jsx("div",{className:"skeleton-icon"})}),e.jsxs("div",{children:[e.jsx("div",{className:"skeleton-line skeleton-header-title mb-1"}),e.jsx("div",{className:"skeleton-line skeleton-header-subtitle"})]})]})}),e.jsxs("div",{className:"header-actions d-flex align-items-center",children:[e.jsx("div",{className:"last-updated-info mr-3",children:e.jsx("div",{className:"skeleton-line skeleton-date"})}),e.jsx("div",{className:"skeleton-button mr-2"}),e.jsx("div",{className:"skeleton-button mr-2"}),e.jsx("div",{className:"skeleton-button"})]})]})}),e.jsx("div",{className:"stats-section mb-5",children:e.jsx(ye,{stats:{totalPredictions:0,activePredictions:0,predictionUsers:0,averageAccuracy:95,predictionsByStatus:{},predictionsByType:{},predictionsByUser:{}},loading:!0})}),e.jsx(ve,{stats:u,userDistribution:[],historicalAccuracy:I,predictions:[],loading:!0}),e.jsx(we,{filters:D,onFiltersChange:()=>{},onRefresh:()=>{},loading:!0}),e.jsx(ke,{predictions:[],filters:D,totalPages:1,totalItems:0,loading:!0,onSort:()=>{},onPageChange:()=>{},onPredictionSelect:()=>{},onPredictionDelete:()=>{}})]})]}):e.jsxs("div",{className:"modern-user-management",children:[e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-bold text-gray-800",children:"AI Predictions"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:P,className:"w-9 h-9 rounded-full bg-red-500 hover:bg-red-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95 disabled:opacity-50",disabled:n,"aria-label":"Refresh data",children:e.jsx("i",{className:`fas fa-sync text-xs ${n?"fa-spin":""}`})}),e.jsx("button",{onClick:()=>r(!0),className:"w-9 h-9 rounded-full bg-rose-600 hover:bg-rose-700 text-white flex items-center justify-center shadow-md transition-all active:scale-95","aria-label":"Add prediction",children:e.jsx("i",{className:"fas fa-plus text-xs"})})]})]})}),e.jsxs("div",{className:"user-management-header mb-5 hidden md:block",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start flex-wrap",children:[e.jsx("div",{className:"header-content",children:e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"header-icon-container mr-3",children:e.jsx("i",{className:"fas fa-chart-line"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"header-title mb-1",children:"AI Predictions Management"}),e.jsx("p",{className:"header-subtitle mb-0",children:"Monitor and manage AI financial predictions across all users in the platform"})]})]})}),e.jsxs("div",{className:"header-actions d-flex align-items-center",children:[e.jsx("div",{className:"last-updated-info mr-3",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"far fa-clock mr-1"}),"Last updated: ",s.toLocaleTimeString()]})}),e.jsxs("button",{className:"btn btn-outline-secondary btn-sm shadow-sm mr-2",onClick:F,disabled:v,children:[e.jsx("i",{className:"fas fa-sync-alt mr-1"}),"Update Model"]}),e.jsxs("button",{className:"btn btn-outline-danger btn-sm shadow-sm refresh-btn mr-2",onClick:P,disabled:n,children:[e.jsx("i",{className:`fas fa-sync-alt mr-1 ${n?"fa-spin":""}`}),n?"Refreshing...":"Refresh All"]}),e.jsxs("button",{className:"btn btn-danger btn-sm shadow-sm",onClick:()=>r(!0),children:[e.jsx("i",{className:"fas fa-plus mr-1"}),"Add Prediction"]})]})]}),e.jsx("div",{className:"dashboard-status-bar mt-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"status-indicator status-online mr-2"}),e.jsx("span",{className:"small text-success font-weight-medium",children:"Prediction services operational - Models running normally"}),e.jsx("div",{className:"ml-auto",children:e.jsxs("span",{className:"badge badge-success badge-pill",children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),"Live Data"]})})]})})]}),b&&e.jsxs(je,{variant:"success",onClose:()=>d(!1),dismissible:!0,children:[e.jsx(je.Heading,{children:"Model Updated Successfully!"}),e.jsx("p",{children:"The Prophet model has been updated with the latest data. All user predictions will reflect the updated model on their next forecast."})]}),e.jsx("div",{className:"stats-section mb-5",children:e.jsx(ye,{stats:u,loading:v})}),e.jsx(ve,{stats:u,userDistribution:U,historicalAccuracy:I,predictions:h,loading:v}),e.jsx(we,{filters:D,onFiltersChange:ie,onRefresh:P,loading:v}),e.jsx(ke,{predictions:h,filters:D,totalPages:G,totalItems:W,loading:v,onSort:m,onPageChange:p,onPredictionSelect:y,onPredictionDelete:$}),e.jsx(Ue,{prediction:g,show:j,onClose:E,onDelete:$}),e.jsx(Ee,{show:o,onClose:E,onAdd:_,users:a,loading:v}),e.jsx(Fe,{show:S,prediction:g,onClose:E,onDelete:H,loading:v})]})};export{Be as default};
