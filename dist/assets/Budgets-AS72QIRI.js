const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdfmake-B9-gh6SH.js","assets/react-vendor-D4A9EtXC.js","assets/vfs_fonts-DtMofV48.js"])))=>i.map(i=>d[i]);
import{j as e}from"./ui-vendor-Cn1Vfl4w.js";import{r as c,e as wt,u as vt,L as O}from"./react-vendor-D4A9EtXC.js";import{f as p,c as I,_ as Ze,i as Ft,u as Ct,b as St,B as Et,s as G}from"./index-BbApZ7g3.js";import{d as ye,H as je}from"./chart-vendor-B0c7K_uV.js";import{p as et}from"./utils-vendor-DvLzUnYR.js";import{P as y,A as E,T as b,a as tt,b as T,c as Bt,W as kt,F as _t,d as Dt}from"./index-CY0iYKBs.js";import{L as Tt,B as Rt}from"./BudgetErrorBoundary-CaqcfOPz.js";/* empty css                       */const $t=async()=>{const r=await Ze(()=>import("./pdfmake-B9-gh6SH.js").then(f=>f.p),__vite__mapDeps([0,1])),h=await Ze(()=>import("./vfs_fonts-DtMofV48.js").then(f=>f.v),__vite__mapDeps([2,1])),u=r.default||r,d=h.default||h;return d.pdfMake?u.vfs=d.pdfMake.vfs:d.vfs?u.vfs=d.vfs:u.vfs=d,u},st=r=>new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),$e=r=>r>=100?{color:"#EF4444",bg:"#FEF2F2",status:"Over Budget"}:r>=80?{color:"#F59E0B",bg:"#FFFBEB",status:"Warning"}:{color:"#10B981",bg:"#F0FDF4",status:"On Track"},At=async(r,h)=>{try{const u=new Date,d=`${u.toLocaleDateString()} ${u.toLocaleTimeString()}`,f=r.reduce((g,i)=>g+i.amount,0),N=r.reduce((g,i)=>g+i.spent,0),w=r.reduce((g,i)=>g+(i.remaining??0),0),v=f>0?N/f*100:0,x={pageSize:"A4",pageOrientation:"landscape",pageMargins:[40,80,40,60],content:[{canvas:[{type:"rect",x:-40,y:-80,w:882,h:120,linearGradient:["#4F46E5","#8B5CF6"],color:"#4F46E5"}]},{columns:[{width:"*",stack:[{text:"BudgetMe",style:"logo",margin:[0,-100,0,5]},{text:"Financial Intelligence Platform",style:"logoTagline",margin:[0,0,0,0]}]},{width:"auto",stack:[{text:"Budget Overview",style:"reportTitle",alignment:"right",margin:[0,-100,0,5]},{text:`Generated: ${d}`,style:"dateText",alignment:"right",margin:[0,0,0,0]}]}],margin:[0,0,0,30]},...h?[{text:h,fontSize:10,color:"#64748B",italics:!0,margin:[0,0,0,20]}]:[],{text:"Budget Summary",style:"sectionHeader"},{columns:[{width:"25%",stack:[{canvas:[{type:"rect",x:0,y:0,w:150,h:70,r:8,color:"#EEF2FF"}]},{text:"Total Budgeted",style:"summaryLabel",margin:[10,-60,0,5]},{text:p(f),fontSize:14,bold:!0,color:"#4F46E5",margin:[10,0,0,0]}]},{width:"25%",stack:[{canvas:[{type:"rect",x:0,y:0,w:150,h:70,r:8,color:"#FEF2F2"}]},{text:"Total Spent",style:"summaryLabel",margin:[10,-60,0,5]},{text:p(N),fontSize:14,bold:!0,color:"#EF4444",margin:[10,0,0,0]}]},{width:"25%",stack:[{canvas:[{type:"rect",x:0,y:0,w:150,h:70,r:8,color:"#F0FDF4"}]},{text:"Remaining",style:"summaryLabel",margin:[10,-60,0,5]},{text:p(w),fontSize:14,bold:!0,color:"#10B981",margin:[10,0,0,0]}]},{width:"25%",stack:[{canvas:[{type:"rect",x:0,y:0,w:150,h:70,r:8,color:v>=100?"#FEF2F2":v>=80?"#FFFBEB":"#F0FDF4"}]},{text:"Overall Usage",style:"summaryLabel",margin:[10,-60,0,5]},{text:I(v),fontSize:14,bold:!0,color:v>=100?"#EF4444":v>=80?"#F59E0B":"#10B981",margin:[10,0,0,0]}]}],columnGap:15,margin:[0,10,0,25]},{text:"Budget Details",style:"sectionHeader"},{table:{headerRows:1,widths:["*","auto","auto","auto","auto","auto"],body:[[{text:"Category",style:"tableHeader",alignment:"center"},{text:"Budgeted",style:"tableHeader",alignment:"center"},{text:"Spent",style:"tableHeader",alignment:"center"},{text:"Remaining",style:"tableHeader",alignment:"center"},{text:"Usage %",style:"tableHeader",alignment:"center"},{text:"Status",style:"tableHeader",alignment:"center"}],...r.map((g,i)=>{const R=g.percentage??0,B=g.remaining??0,$=$e(R);return[{text:g.category_name,style:"tableRow",fillColor:i%2===0?"#F8FAFF":"#FFFFFF"},{text:p(g.amount),style:"tableRow",alignment:"right",fillColor:i%2===0?"#F8FAFF":"#FFFFFF"},{text:p(g.spent),style:"tableRow",alignment:"right",bold:!0,color:"#EF4444",fillColor:i%2===0?"#F8FAFF":"#FFFFFF"},{text:p(B),style:"tableRow",alignment:"right",bold:!0,color:B>=0?"#10B981":"#EF4444",fillColor:i%2===0?"#F8FAFF":"#FFFFFF"},{text:I(R),style:"tableRow",alignment:"center",bold:!0,color:$.color,fillColor:i%2===0?"#F8FAFF":"#FFFFFF"},{text:$.status,fontSize:9,color:$.color,bold:!0,fillColor:i%2===0?"#F8FAFF":"#FFFFFF",alignment:"center"}]})]},layout:{fillColor:function(g){return g===0?"#4F46E5":null},hLineWidth:function(g,i){return g===0||g===i.table.body.length?2:.5},vLineWidth:function(){return .5},hLineColor:function(g,i){return g===0||g===i.table.body.length?"#4F46E5":"#E2E8F0"},vLineColor:function(){return"#E2E8F0"},paddingLeft:function(){return 8},paddingRight:function(){return 8},paddingTop:function(){return 6},paddingBottom:function(){return 6}},margin:[0,0,0,20]}],styles:{logo:{fontSize:28,bold:!0,color:"#FFFFFF"},logoTagline:{fontSize:10,color:"#E0E7FF",italics:!0},reportTitle:{fontSize:18,bold:!0,color:"#FFFFFF"},dateText:{fontSize:9,color:"#E0E7FF"},sectionHeader:{fontSize:16,bold:!0,color:"#4F46E5",margin:[0,20,0,12]},tableHeader:{bold:!0,fontSize:10,color:"#FFFFFF",fillColor:"#4F46E5"},tableRow:{fontSize:9,color:"#1F2937"},summaryLabel:{fontSize:10,bold:!0,color:"#64748B"},footerText:{fontSize:9,color:"#94A3B8",italics:!0}},defaultStyle:{font:"Roboto"}};x.footer=function(g,i){return{columns:[{width:"*",text:"Â© 2025 BudgetMe - Financial Intelligence Platform",style:"footerText",margin:[40,20,0,0]},{width:"auto",text:`Page ${g} of ${i}`,style:"footerText",alignment:"right",margin:[0,20,40,0]}]}},(await $t()).createPdf(x).download(`budgetme-budgets-${new Date().toISOString().split("T")[0]}.pdf`)}catch(u){throw console.error("Error generating PDF:",u),new Error("Failed to generate PDF report")}},Pt=(r,h)=>{try{const u=r.map(k=>{const g=k.percentage??0,i=k.remaining??0,R=$e(g);return{Category:k.category_name??"Unknown",Budgeted:k.amount.toFixed(2),Spent:k.spent.toFixed(2),Remaining:i.toFixed(2),"Usage %":g.toFixed(2),Status:R.status,Period:k.period,"Start Date":st(k.start_date),"End Date":st(k.end_date)}}),d=[{"":"BudgetMe Budget Overview"},{"":`Generated: ${new Date().toLocaleString()}`},...h?[{"":h}]:[],{"":""}],f=et.unparse(u,{quotes:!0,header:!0}),w=`${et.unparse(d,{header:!1})}

${f}`,v=new Blob([w],{type:"text/csv;charset=utf-8;"}),x=URL.createObjectURL(v),S=document.createElement("a");S.href=x,S.setAttribute("download",`budgetme-budgets-${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(x)}catch(u){throw console.error("Error generating CSV:",u),new Error("Failed to generate CSV report")}},It=async(r,h)=>{try{const u=new Date,d=`${u.toLocaleDateString()} ${u.toLocaleTimeString()}`,f=r.reduce((_,M)=>_+M.amount,0),N=r.reduce((_,M)=>_+M.spent,0),w=r.reduce((_,M)=>_+(M.remaining??0),0),v=f>0?N/f*100:0,x=[new y({children:[new b({text:"BudgetMe",bold:!0,size:48,color:"4F46E5"})],alignment:E.CENTER,spacing:{after:100}}),new y({children:[new b({text:"Financial Intelligence Platform",size:18,color:"8B5CF6",italics:!0})],alignment:E.CENTER,spacing:{after:300}}),new y({children:[new b({text:"Budget Overview",bold:!0,size:32,color:"1F2937"})],alignment:E.CENTER,spacing:{after:150}}),new y({children:[new b({text:`Generated: ${d}`,size:18,color:"64748B",italics:!0})],alignment:E.CENTER,spacing:{after:400},border:{bottom:{color:"4F46E5",space:1,style:"single",size:6}}})],S=h?[new y({children:[new b({text:h,size:20,color:"64748B",italics:!0})],spacing:{after:300}})]:[],k=[new y({children:[new b({text:"Budget Summary",bold:!0,size:28,color:"4F46E5"})],spacing:{before:300,after:200}}),new y({children:[new b({text:"ðŸ’° Total Budgeted: ",bold:!0,size:22,color:"4F46E5"}),new b({text:p(f),size:22,color:"4F46E5"})],spacing:{after:150}}),new y({children:[new b({text:"ðŸ’¸ Total Spent: ",bold:!0,size:22,color:"EF4444"}),new b({text:p(N),size:22,color:"EF4444"})],spacing:{after:150}}),new y({children:[new b({text:"ðŸ’Ž Remaining: ",bold:!0,size:22,color:"10B981"}),new b({text:p(w),size:22,color:"10B981"})],spacing:{after:150}}),new y({children:[new b({text:"ðŸ“Š Overall Usage: ",bold:!0,size:22,color:"8B5CF6"}),new b({text:I(v),size:22,color:"8B5CF6"})],spacing:{after:300}})],g=[new y({children:[new b({text:"Budget Details",bold:!0,size:28,color:"4F46E5"})],spacing:{before:300,after:200}})],i=[new tt({children:[new T({children:[new y({children:[new b({text:"Category",bold:!0,color:"FFFFFF"})],alignment:E.CENTER})],shading:{fill:"4F46E5"}}),new T({children:[new y({children:[new b({text:"Budgeted",bold:!0,color:"FFFFFF"})],alignment:E.CENTER})],shading:{fill:"4F46E5"}}),new T({children:[new y({children:[new b({text:"Spent",bold:!0,color:"FFFFFF"})],alignment:E.CENTER})],shading:{fill:"4F46E5"}}),new T({children:[new y({children:[new b({text:"Remaining",bold:!0,color:"FFFFFF"})],alignment:E.CENTER})],shading:{fill:"4F46E5"}}),new T({children:[new y({children:[new b({text:"Usage %",bold:!0,color:"FFFFFF"})],alignment:E.CENTER})],shading:{fill:"4F46E5"}}),new T({children:[new y({children:[new b({text:"Status",bold:!0,color:"FFFFFF"})],alignment:E.CENTER})],shading:{fill:"4F46E5"}})]})];r.forEach((_,M)=>{const q=M%2===0?"F8FAFF":"FFFFFF",ae=_.percentage??0,Q=_.remaining??0,de=_.category_name??"Unknown",Z=$e(ae);i.push(new tt({children:[new T({children:[new y(de)],shading:{fill:q}}),new T({children:[new y({children:[new b(p(_.amount))],alignment:E.RIGHT})],shading:{fill:q}}),new T({children:[new y({children:[new b({text:p(_.spent),bold:!0,color:"EF4444"})],alignment:E.RIGHT})],shading:{fill:q}}),new T({children:[new y({children:[new b({text:p(Q),bold:!0,color:Q>=0?"10B981":"EF4444"})],alignment:E.RIGHT})],shading:{fill:q}}),new T({children:[new y({children:[new b({text:I(ae),bold:!0,color:Z.color.replace("#","")})],alignment:E.CENTER})],shading:{fill:q}}),new T({children:[new y({children:[new b({text:Z.status,bold:!0,color:Z.color.replace("#","")})],alignment:E.CENTER})],shading:{fill:q}})]}))});const R=new Bt({rows:i,width:{size:100,type:kt.PERCENTAGE}}),B=new _t({sections:[{properties:{},children:[...x,...S,...k,...g,R,new y({text:"",spacing:{before:600}}),new y({children:[new b({text:"Â© 2025 BudgetMe - Financial Intelligence Platform",size:18,color:"94A3B8",italics:!0})],alignment:E.CENTER,border:{top:{color:"E2E8F0",space:1,style:"single",size:6}},spacing:{before:200}})]}]}),$=await Dt.toBlob(B),z=URL.createObjectURL($),A=document.createElement("a");A.href=z,A.setAttribute("download",`budgetme-budgets-${new Date().toISOString().split("T")[0]}.docx`),document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(z)}catch(u){throw console.error("Error generating DOCX:",u),new Error("Failed to generate DOCX report")}},Ne=c.memo(({title:r,value:h,icon:u,borderColor:d,animationDelay:f="0s",onClick:N,showTooltip:w=!1,tooltipId:v})=>e.jsx("div",{className:"col-xl-4 col-md-6 mb-3 md:mb-4 animate__animated animate__fadeIn",style:{animationDelay:f},children:e.jsx("div",{className:`card border-left-${d} shadow h-100 py-2 md:py-3`,children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsxs("div",{className:`text-xs md:text-sm font-weight-bold text-${d} text-uppercase mb-1 d-flex align-items-center`,children:[r,w&&N&&e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:N,"aria-label":`${r} information`})})]}),e.jsx("div",{className:"text-lg md:text-xl lg:h5 mb-0 font-weight-bold text-gray-800",children:h})]}),e.jsx("div",{className:"col-auto",children:e.jsx("i",{className:`fas fa-${u} fa-lg md:fa-2x text-gray-300`})})]})})})}));Ne.displayName="StatCard";const at=c.memo(({title:r,subtitle:h,children:u,onInfoClick:d,showInfo:f=!1,animationDelay:N="0s"})=>e.jsxs("div",{className:"card shadow mb-3 md:mb-4 animate__animated animate__fadeIn",style:{animationDelay:N},children:[e.jsxs("div",{className:"card-header py-2 md:py-3",children:[e.jsxs("h6",{className:"m-0 text-sm md:text-base font-weight-bold text-primary d-flex align-items-center",children:[r,f&&d&&e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:d,"aria-label":`${r} information`})})]}),h&&e.jsx("p",{className:"m-0 text-xs md:text-sm text-gray-600",children:h})]}),e.jsx("div",{className:"card-body p-3 md:p-4",children:u})]}));at.displayName="ChartContainer";const lt=c.memo(({options:r,chartRef:h})=>r?e.jsx(ye,{highcharts:je,options:r,ref:h}):e.jsxs("div",{className:"text-center py-3 md:py-4",children:[e.jsx("i",{className:"fas fa-chart-bar fa-lg md:fa-2x text-gray-300 mb-1 md:mb-2"}),e.jsx("p",{className:"text-xs md:text-sm text-gray-500",children:"No data available for chart"})]}));lt.displayName="BudgetChart";const rt=c.memo(({budget:r,onView:h,onEdit:u,onDelete:d})=>{const f=Math.min(r.percentage_used||0,100),N=r.status==="danger"?"rose":r.status==="warning"?"amber":"emerald";return e.jsxs("div",{className:"bg-white rounded-xl p-3 border border-gray-100 shadow-sm mb-2",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 truncate",children:r.budget_name||"Unnamed Budget"}),e.jsx("p",{className:"text-[10px] text-gray-500",children:r.category_name||"Uncategorized"})]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[9px] font-semibold ${r.status==="danger"?"bg-rose-100 text-rose-600":r.status==="warning"?"bg-amber-100 text-amber-600":"bg-emerald-100 text-emerald-600"}`,children:(r.percentage_used||0)>=100?"Over":(r.percentage_used||0)>=90?"Near":"On Track"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"Progress"}),e.jsx("span",{className:`font-semibold text-${N}-600`,children:I(f)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 bg-${N}-500`,style:{width:`${f}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] text-gray-400 uppercase",children:"Budget"}),e.jsx("p",{className:"text-xs font-semibold text-gray-800",children:p(r.amount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] text-gray-400 uppercase",children:"Spent"}),e.jsx("p",{className:"text-xs font-semibold text-gray-800",children:p(r.spent)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] text-gray-400 uppercase",children:"Left"}),e.jsx("p",{className:`text-xs font-semibold ${(r.remaining||0)<0?"text-rose-600":"text-emerald-600"}`,children:p(r.remaining||0)})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-gray-100",children:[e.jsx("button",{onClick:()=>h(r.id),className:"w-7 h-7 rounded-full bg-blue-50 text-blue-500 flex items-center justify-center hover:bg-blue-100 transition-colors","aria-label":"View budget",children:e.jsx("i",{className:"fas fa-eye text-[10px]"})}),e.jsx("button",{onClick:()=>u(r.id),className:"w-7 h-7 rounded-full bg-indigo-50 text-indigo-500 flex items-center justify-center hover:bg-indigo-100 transition-colors","aria-label":"Edit budget",children:e.jsx("i",{className:"fas fa-edit text-[10px]"})}),e.jsx("button",{onClick:()=>d(r.id),className:"w-7 h-7 rounded-full bg-rose-50 text-rose-500 flex items-center justify-center hover:bg-rose-100 transition-colors","aria-label":"Delete budget",children:e.jsx("i",{className:"fas fa-trash text-[10px]"})})]})]})});rt.displayName="MobileBudgetCard";const zt=c.memo(()=>{const r=wt(),h=vt(),{currencySymbol:u}=Ft(),{user:d}=Ct(),{showSuccessToast:f,showErrorToast:N}=St(),[w,v]=c.useState([]),[x,S]=c.useState([]),[k,g]=c.useState(!0),[i,R]=c.useState(!1),[B,$]=c.useState(null),[z,A]=c.useState(null),[_,M]=c.useState(null),[q,ae]=c.useState(null),[Q,de]=c.useState([]),[Z,nt]=c.useState(null),[Ae,it]=c.useState(null),[Pe]=c.useState(`budget_updates_${d?.id||"anonymous"}`),[Ie]=c.useState(`transaction_updates_${d?.id||"anonymous"}`),[Mt,Y]=c.useState("view"),[Lt,U]=c.useState(null),le=c.useRef(Et.getInstance()),[ee,we]=c.useState(!1),[ve,ze]=c.useState(null),[,Me]=c.useState(null),[te,Le]=c.useState([]),[Fe,me]=c.useState(!1),[ot,Oe]=c.useState(!1),[xe,Ue]=c.useState(null),[ge,Ce]=c.useState(!1),re=new URLSearchParams(r.search),ct=re.get("month")||"all",dt=re.get("year")||"all",mt=re.get("status")||"all",xt=re.get("categoryId")||"all",gt=re.get("search")||"",[t,He]=c.useState({categoryId:xt,status:mt,search:gt,month:ct,year:dt,scope:"all"}),[F,Se]=c.useState(1),[he,ht]=c.useState(10),ut=c.useRef(null),Ee=c.useRef(null),[V,se]=c.useState(!1),[Ye,Ve]=c.useState(!1),[ne,We]=c.useState("overview"),Ge=s=>{const a=new Date(s.start_date);return{month:["January","February","March","April","May","June","July","August","September","October","November","December"][a.getMonth()],year:a.getFullYear().toString()}},W=(s,a)=>{if(_===s)M(null),ae(null);else if(M(s),a){const l=a.currentTarget.getBoundingClientRect();ae({top:l.bottom+window.scrollY,left:l.left+l.width/2+window.scrollX})}},qe=()=>t.month!=="all"&&t.year!=="all"?`${new Date(0,parseInt(t.month)-1).toLocaleString("default",{month:"long"})} ${t.year}`:t.month!=="all"?`${new Date(0,parseInt(t.month)-1).toLocaleString("default",{month:"long"})} (All Years)`:t.year!=="all"?t.year:"All Time";c.useEffect(()=>((async()=>{try{if(!d){console.log("No user found, redirecting to login"),h("/login");return}g(!0),console.log("Fetching budget data for user:",d.id);const a=await le.current.getBudgets(d.id);if(Y(a.source),a.source==="error")throw U(a.error||"Unknown error occurred"),new Error(a.error||"Failed to fetch budget data");if(U(null),console.log(`Retrieved ${a.data?.length||0} budgets from source: ${a.source}`),a.data&&a.data.length>0){v(a.data),S(a.data);const l=await le.current.getExpenseCategories(d.id);l.success&&l.data?de(l.data.map(m=>({id:m.id,name:m.category_name}))):(console.warn("Failed to fetch categories:",l.error),de([])),ue(a.data)}else v([]),S([]),$(null),A(null);g(!1)}catch(a){console.error("Error fetching budget data:",a);const l=a instanceof Error?a.message:"Unknown error occurred";N(`Failed to load budgets: ${l}`),Y("error"),U(l),g(!1)}})(),()=>{}),[d,h,N]),c.useEffect(()=>{if(!d)return;Z&&(console.log("Removing existing budget subscription"),G.removeChannel(Z)),Ae&&(console.log("Removing existing transaction subscription"),G.removeChannel(Ae)),console.log(`Setting up new subscriptions for user ${d.id}`);const s=G.channel(Pe).on("postgres_changes",{event:"*",schema:"public",table:"budgets",filter:`user_id=eq.${d.id}`},l=>{if(console.log("Budget update received:",l),l.eventType==="DELETE"){const m=l.old?.id;m&&(console.log(`Budget ${m} was deleted, updating UI`),v(n=>n.filter(j=>j.id!==m)),S(n=>{const j=n.filter(K=>K.id!==m);return j.length>0?ue(j):($(null),A(null)),j}))}else(async()=>{try{const n=await le.current.getBudgets(d.id);n.source!=="error"?(v(n.data),Y(n.source),U(null),S(j=>t.categoryId!=="all"||t.status!=="all"||t.month!=="all"||t.year!=="all"||t.search?(Be(n.data),j):n.data),ue(n.data)):(Y("error"),U(n.error||"Failed to refresh budget data"))}catch(n){console.error("Error refreshing budget data:",n),Y("error"),U(n instanceof Error?n.message:"Unknown error")}})()}).subscribe(l=>{console.log(`Budget subscription status: ${l}`)}),a=G.channel(Ie).on("postgres_changes",{event:"*",schema:"public",table:"transactions",filter:`user_id=eq.${d.id}`},l=>{console.log("Transaction update received (may affect budget spent):",l),(async()=>{try{const n=await le.current.getBudgets(d.id);n.source!=="error"?(v(n.data),Y(n.source),U(null),S(j=>t.categoryId!=="all"||t.status!=="all"||t.month!=="all"||t.year!=="all"||t.search?(Be(n.data),j):n.data),ue(n.data)):(Y("error"),U(n.error||"Failed to refresh budget data after transaction change"))}catch(n){console.error("Error refreshing budget data after transaction change:",n),Y("error"),U(n instanceof Error?n.message:"Unknown error")}})()}).subscribe(l=>{console.log(`Transaction subscription status: ${l}`)});return nt(s),it(a),()=>{console.log("Cleaning up subscriptions"),s&&G.removeChannel(s),a&&G.removeChannel(a)}},[d,Pe,Ie]);const ue=s=>{_e(s)};c.useEffect(()=>{if(!w.length)return;const s=new URLSearchParams;t.status!=="all"&&s.set("status",t.status),t.categoryId!=="all"&&s.set("categoryId",t.categoryId),t.month!=="all"&&s.set("month",t.month),t.year!=="all"&&s.set("year",t.year),t.search!==""&&s.set("search",t.search);const a=s.toString(),l=a?`?${a}`:"";h(l,{replace:!0}),Be()},[t,w,h]);const Be=(s=w)=>{if(s.length===0)return;let a=s;if(t.scope==="family"&&te.length>0)a=te,me(!0);else if(t.scope==="personal")a=w,me(!1);else if(t.scope==="all"&&ee){const m=[...w];te.forEach(n=>{m.some(j=>j.id===n.id)||m.push(n)}),a=m,me(!1)}else me(!1);let l=[...a];R(!0),setTimeout(()=>{if(t.categoryId!=="all"&&(l=l.filter(m=>m.category_id===t.categoryId)),t.status!=="all"&&(l=l.filter(m=>m.status===t.status)),t.month!=="all"){const m=parseInt(t.month);l=l.filter(n=>new Date(n.start_date).getMonth()+1===m)}if(t.year!=="all"){const m=parseInt(t.year);l=l.filter(n=>new Date(n.start_date).getFullYear()===m)}if(t.search.trim()!==""){const m=t.search.toLowerCase();l=l.filter(n=>{const j=(n.budget_name||"").toLowerCase(),K=(n.category_name||n.display_category||"").toLowerCase();return j.includes(m)||K.includes(m)})}l.sort((m,n)=>{const j=m.category_name||m.display_category||"Uncategorized",K=n.category_name||n.display_category||"Uncategorized";return j.localeCompare(K)}),S(l),_e(l),Se(1),R(!1)},300)},J=x.length,L=Math.max(1,Math.ceil(J/he)),fe=(F-1)*he,ke=Math.min(fe+he,J),pe=x.slice(fe,ke),ie=s=>{Se(s)},ft=s=>{ht(s),Se(1)},_e=s=>{if(!s||s.length===0){$(null),A(null);return}const a=new Map;s.forEach(C=>{const H=C.category_name||C.display_category||"Uncategorized",P=a.get(H);P?(P.budget+=C.amount,P.spent+=C.spent,P.maxPercentage=Math.max(P.maxPercentage,C.percentage_used||0)):a.set(H,{budget:C.amount,spent:C.spent,maxPercentage:C.percentage_used||0})});const l=Array.from(a.keys()),m=Array.from(a.values()).map(C=>C.budget),n=Array.from(a.values()).map(C=>C.spent),j={chart:{type:"column",style:{fontFamily:'"Nunito", -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},backgroundColor:"transparent",animation:{duration:1e3},height:350},title:{text:null},xAxis:{categories:l,crosshair:!0,labels:{style:{color:"#5a5c69"}}},yAxis:{min:0,title:{text:null},gridLineColor:"#eaecf4",gridLineDashStyle:"dash",labels:{formatter:function(){return u+this.value},style:{color:"#5a5c69"}}},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>{point.y:.2f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0,style:{fontSize:"12px",fontFamily:'"Nunito", -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},valuePrefix:u},plotOptions:{column:{pointPadding:.2,borderWidth:0,borderRadius:2},series:{animation:{duration:1e3}}},credits:{enabled:!1},series:[{name:"Budget",data:m,color:"#4e73df"},{name:"Spent",data:n,color:"#e74a3b"}]},K=Array.from(a.entries()).map(([C,H])=>({name:C,y:H.budget,sliced:H.maxPercentage>=90,selected:H.maxPercentage>=90}));if(ee&&t.scope==="all"&&te.length>0){j.title={text:"Combined Personal & Family Budget Overview"};const C=te.reduce((P,ce)=>P+ce.spent,0),H=s.filter(P=>!te.some(ce=>ce.id===P.id)).reduce((P,ce)=>P+ce.spent,0);j.subtitle?j.subtitle.text=`Family: ${p(C)} | Personal: ${p(H)}`:j.subtitle={text:`Family: ${p(C)} | Personal: ${p(H)}`,style:{fontSize:"12px",color:"#858796"}}}else Fe&&(j.title={text:"Family Budget Overview"});const Nt={chart:{type:"pie",backgroundColor:"transparent",style:{fontFamily:'"Nunito", -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},height:350},title:{text:null},tooltip:{pointFormat:"<b>{point.name}</b>: {point.percentage:.1f}% ("+u+"{point.y:,.2f})",valuePrefix:u},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %",style:{fontWeight:"normal"}},showInLegend:!1,size:"85%"}},legend:{enabled:!1},series:[{name:"Budget Allocation",colorByPoint:!0,data:K}],credits:{enabled:!1}};$(j),A(Nt)},D=s=>{const{name:a,value:l}=s.target;R(!0),He(m=>({...m,[a]:l}))},X=()=>{R(!0),He({categoryId:"all",status:"all",search:"",month:"all",year:"all",scope:"all"}),h("",{replace:!0})},De=()=>{const s=[];if(t.categoryId&&t.categoryId!=="all"){const a=Q.find(l=>l.id===t.categoryId);s.push(`Category: ${a?.name||t.categoryId}`)}return t.status&&t.status!=="all"&&s.push(`Status: ${t.status}`),t.month&&t.month!=="all"&&s.push(`Month: ${t.month}`),t.year&&t.year!=="all"&&s.push(`Year: ${t.year}`),t.search&&s.push(`Search: "${t.search}"`),t.scope&&t.scope!=="all"&&s.push(`Scope: ${t.scope}`),s.length>0?`Filters: ${s.join(", ")}`:void 0},Je=async()=>{try{se(!0),f("Preparing PDF export..."),await At(x,De()),f("PDF downloaded successfully!")}catch(s){console.error("PDF Export Error:",s),N("Failed to generate PDF. Please try again.")}finally{se(!1)}},Xe=()=>{try{se(!0),f("Preparing CSV export..."),Pt(x,De()),f("CSV downloaded successfully!")}catch(s){console.error("CSV Export Error:",s),N("Failed to generate CSV. Please try again.")}finally{se(!1)}},Ke=async()=>{try{se(!0),f("Preparing Word document export..."),await It(x,De()),f("Word document downloaded successfully!")}catch(s){console.error("DOCX Export Error:",s),N("Failed to generate Word document. Please try again.")}finally{se(!1)}},pt=s=>{Ee.current&&(Ee.current.chart=s)},Qe=s=>{Ue(s),Oe(!0)},Te=()=>{Oe(!1),Ue(null),Ce(!1)},bt=async()=>{if(!(!xe||!d))try{Ce(!0);const s=await le.current.deleteBudget(xe,d.id);if(!s.success)throw new Error(s.error||"Failed to delete budget");const a=w.filter(m=>m.id!==xe);v(a);const l=x.filter(m=>m.id!==xe);S(l),l.length>0?_e(l):($(null),A(null)),f("Budget deleted successfully"),Te()}catch(s){console.error("Error deleting budget:",s);const a=s instanceof Error?s.message:"Unknown error occurred";N(`Failed to delete budget: ${a}`),Ce(!1)}};c.useEffect(()=>{(async()=>{if(d)try{const{data:a,error:l}=await G.from("family_members").select(`
            id,
            family_id,
            role,
            status,
            families:family_id (
              id,
              family_name
            )
          `).eq("user_id",d.id).eq("status","active").limit(1);!l&&a&&a.length>0?(we(!0),ze(a[0].family_id),Me(a[0].role)):(console.log("No family_members record found and check_user_family RPC is not available"),we(!1),ze(null),Me(null))}catch(a){console.error("Error checking family status:",a),we(!1)}})()},[d]),c.useEffect(()=>{(async()=>{if(!(!ee||!ve))try{const{data:a,error:l}=await G.from("family_budget_details").select("*").eq("family_id",ve).eq("month",t.month).eq("year",t.year);if(l)throw new Error(l.message);const m=(a||[]).map(n=>({...n,status:yt(n.percentage_used)}));Le(m)}catch(a){console.error("Error fetching family budgets:",a),Le([])}})()},[ee,ve,t.month,t.year]);const yt=s=>s<=75?"success":s<=90?"warning":"danger",jt=s=>{switch(s){case"success":return"success";case"warning":return"warning";case"danger":return"danger";default:return"secondary"}};if(k)return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"block md:hidden py-12 animate__animated animate__fadeIn",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"mt-3 text-xs text-gray-500 font-medium",children:"Loading your budgets..."})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx(Tt,{message:"Please wait while we fetch your budget data..."})})]});const oe=x.reduce((s,a)=>s+a.amount,0),be=x.reduce((s,a)=>s+a.spent,0),Re=oe-be,o=Math.min(oe>0?be/oe*100:0,100);return e.jsx(Rt,{children:e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-bold text-gray-800",children:"Budgets"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"dropdown",children:[e.jsx("button",{className:"w-9 h-9 rounded-full bg-emerald-500 hover:bg-emerald-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95 disabled:opacity-50",type:"button",id:"mobileExportDropdown","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:V||x.length===0,"aria-label":"Export",children:e.jsx("i",{className:"fas fa-download text-xs"})}),e.jsxs("div",{className:"dropdown-menu dropdown-menu-right shadow","aria-labelledby":"mobileExportDropdown",children:[e.jsxs("button",{className:"dropdown-item text-sm",onClick:Je,disabled:V,children:[e.jsx("i",{className:"fas fa-file-pdf fa-sm fa-fw mr-2 text-danger"}),"PDF"]}),e.jsxs("button",{className:"dropdown-item text-sm",onClick:Xe,disabled:V,children:[e.jsx("i",{className:"fas fa-file-csv fa-sm fa-fw mr-2 text-success"}),"CSV"]}),e.jsxs("button",{className:"dropdown-item text-sm",onClick:Ke,disabled:V,children:[e.jsx("i",{className:"fas fa-file-word fa-sm fa-fw mr-2 text-primary"}),"Word"]})]})]}),e.jsx(O,{to:"/budgets/create",className:"w-9 h-9 rounded-full bg-indigo-500 hover:bg-indigo-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95","aria-label":"Create budget",children:e.jsx("i",{className:"fas fa-plus text-xs"})})]})]})}),e.jsxs("div",{className:"d-none d-md-flex align-items-center justify-content-between mb-2 mb-md-4 budgets-header flex-wrap",children:[e.jsx("h1",{className:"h5 h-md-3 mb-1 mb-md-0 text-gray-800",style:{fontSize:"1.1rem"},children:"Budgets"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("div",{className:"dropdown",children:[e.jsxs("button",{className:"btn btn-sm btn-success shadow-sm d-flex align-items-center dropdown-toggle",type:"button",id:"exportDropdown","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:V||x.length===0,style:{padding:"0.25rem 0.5rem"},children:[e.jsx("i",{className:"fas fa-download fa-sm text-white-50",style:{fontSize:"0.7rem"}}),e.jsx("span",{className:"d-none d-md-inline ml-2",children:"Export"})]}),e.jsxs("div",{className:"dropdown-menu dropdown-menu-right shadow","aria-labelledby":"exportDropdown",children:[e.jsxs("button",{className:"dropdown-item",onClick:Je,disabled:V,children:[e.jsx("i",{className:"fas fa-file-pdf fa-sm fa-fw mr-2 text-danger"}),"Export as PDF"]}),e.jsxs("button",{className:"dropdown-item",onClick:Xe,disabled:V,children:[e.jsx("i",{className:"fas fa-file-csv fa-sm fa-fw mr-2 text-success"}),"Export as CSV"]}),e.jsxs("button",{className:"dropdown-item",onClick:Ke,disabled:V,children:[e.jsx("i",{className:"fas fa-file-word fa-sm fa-fw mr-2 text-primary"}),"Export as Word"]})]})]}),e.jsxs(O,{to:"/budgets/create",className:"btn btn-sm btn-primary shadow-sm d-flex align-items-center",style:{padding:"0.25rem 0.5rem"},children:[e.jsx("i",{className:"fas fa-plus fa-sm text-white-50",style:{fontSize:"0.7rem"}}),e.jsx("span",{className:"d-none d-md-inline ml-2",children:"Create Budget"})]})]})]}),e.jsxs("div",{className:"block md:hidden mb-4",children:[e.jsxs("div",{className:`bg-gradient-to-br ${o>=90?"from-rose-500 via-red-500 to-orange-500":o>=75?"from-amber-500 via-orange-500 to-yellow-500":"from-emerald-500 via-teal-500 to-cyan-500"} rounded-2xl p-4 mb-3 shadow-lg`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-white/80 text-xs font-medium",children:"Budget Health"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:`fas fa-${o>=90?"exclamation-triangle":o>=75?"exclamation-circle":"check-circle"} text-white text-sm`})})]}),e.jsxs("div",{className:"text-white text-2xl font-bold mb-1",children:[I(o)," Used"]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{className:`text-xs font-medium ${o>=90?"text-red-200":o>=75?"text-amber-200":"text-green-200"}`,children:[e.jsx("i",{className:`fas fa-${o>=90?"arrow-up":o>=75?"minus":"arrow-down"} text-[10px] mr-1`}),o>=90?"At Risk":o>=75?"Caution":"Healthy"]})}),e.jsx("div",{className:"mt-3 w-full bg-white/20 rounded-full h-1.5",children:e.jsx("div",{className:"bg-white h-1.5 rounded-full transition-all duration-500",style:{width:`${Math.min(o,100)}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-blue-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-wallet text-blue-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Budget"}),e.jsx("p",{className:"text-sm font-bold text-gray-800 truncate",children:p(oe)})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-rose-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-credit-card text-rose-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Spent"}),e.jsx("p",{className:"text-sm font-bold text-gray-800 truncate",children:p(be)})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-emerald-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-piggy-bank text-emerald-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Left"}),e.jsx("p",{className:`text-sm font-bold truncate ${Re<0?"text-rose-600":"text-emerald-600"}`,children:p(Re)})]})]})]}),e.jsxs("div",{className:"d-none d-md-block",children:[(t.categoryId!=="all"||t.status!=="all"||t.month!=="all"||t.year!=="all"||t.search!==""||t.scope!=="all")&&e.jsx("div",{className:"col-12 mb-2",children:e.jsxs("small",{className:"text-muted d-flex align-items-center",style:{fontSize:"0.8rem"},children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Summary cards below reflect filtered data (",x.length," of ",w.length," budgets)"]})}),e.jsxs("div",{className:"row summary-cards",children:[e.jsx(Ne,{title:"Total Budget",value:p(oe),icon:"solid fa-peso-sign",borderColor:"primary",showTooltip:!0,tooltipId:"totalBudget",onClick:s=>W("totalBudget",s),animationDelay:"0s"}),e.jsx(Ne,{title:"Total Spent",value:p(be),icon:"credit-card",borderColor:"danger",showTooltip:!0,tooltipId:"totalSpent",onClick:s=>W("totalSpent",s),animationDelay:"0.1s"}),e.jsx(Ne,{title:"Remaining Budget",value:p(Re),icon:"piggy-bank",borderColor:"success",showTooltip:!0,tooltipId:"remaining",onClick:s=>W("remaining",s),animationDelay:"0.2s"})]})]}),e.jsxs("div",{className:"block md:hidden mb-4",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex bg-slate-50",children:[e.jsxs("button",{onClick:()=>We("overview"),className:`flex-1 py-3.5 text-sm font-semibold transition-all relative ${ne==="overview"?"text-indigo-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx("i",{className:"fas fa-chart-bar mr-2 text-xs"}),"Overview",ne==="overview"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-600"})]}),e.jsxs("button",{onClick:()=>We("allocation"),className:`flex-1 py-3.5 text-sm font-semibold transition-all relative ${ne==="allocation"?"text-indigo-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx("i",{className:"fas fa-chart-pie mr-2 text-xs"}),"Allocation",ne==="allocation"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-600"})]})]}),e.jsx("div",{className:"p-4",children:ne==="overview"?B&&x.length>0?e.jsxs("div",{className:"animate__animated animate__fadeIn",children:[e.jsxs("div",{className:"flex items-center justify-center gap-6 mb-4",children:[e.jsxs("span",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-blue-500"}),"Budget"]}),e.jsxs("span",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500"}),"Spent"]})]}),e.jsx(ye,{highcharts:je,options:{...B,chart:{...B.chart,height:280,spacing:[10,10,10,10]},legend:{enabled:!1},xAxis:{...B.xAxis,labels:{...B.xAxis.labels,style:{fontSize:"10px",color:"#6b7280"},rotation:-45}},yAxis:{...B.yAxis,labels:{...B.yAxis.labels,style:{fontSize:"10px",color:"#6b7280"}}}}})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"fas fa-chart-bar text-gray-400 text-2xl"})}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"No budget data yet"}),e.jsxs(O,{to:"/budgets/create",className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-500 text-white text-sm font-medium rounded-lg hover:bg-indigo-600 transition-colors",children:[e.jsx("i",{className:"fas fa-plus text-xs"}),"Create Budget"]})]}):z&&x.length>0?e.jsx("div",{className:"animate__animated animate__fadeIn",children:e.jsx(ye,{highcharts:je,options:{...z,chart:{...z.chart,height:300},plotOptions:{...z.plotOptions,pie:{...z.plotOptions?.pie,dataLabels:{enabled:!1},showInLegend:!0,size:"70%",innerSize:"50%",center:["50%","35%"]}},legend:{enabled:!0,layout:"horizontal",align:"center",verticalAlign:"bottom",itemStyle:{fontSize:"11px",fontWeight:"normal",color:"#374151"},symbolRadius:2,symbolHeight:10,symbolWidth:10,itemMarginTop:8,itemMarginBottom:4,padding:0},title:{text:null}}})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"fas fa-chart-pie text-gray-400 text-2xl"})}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"No allocation data"}),e.jsxs(O,{to:"/budgets/create",className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-500 text-white text-sm font-medium rounded-lg hover:bg-indigo-600 transition-colors",children:[e.jsx("i",{className:"fas fa-plus text-xs"}),"Create Budget"]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden mt-3",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("h6",{className:"text-xs font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-tasks text-indigo-500 text-[10px]"}),"Overall Progress"]}),x.length>0&&e.jsx("span",{className:`text-[10px] font-semibold px-2 py-0.5 rounded-full ${o>=90?"bg-rose-100 text-rose-600":o>=75?"bg-amber-100 text-amber-600":"bg-emerald-100 text-emerald-600"}`,children:o>=90?"At Risk":o>=75?"Caution":"Healthy"})]}),e.jsx("div",{className:"p-4",children:x.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Budget Used"}),e.jsx("span",{className:`text-sm font-bold ${o>=90?"text-rose-600":o>=75?"text-amber-600":"text-emerald-600"}`,children:I(o)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full transition-all duration-500 ${o>=90?"bg-rose-500":o>=75?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${Math.min(o,100)}%`}})}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-2",children:o>=90?"Consider reviewing your spending habits.":o>=75?"Monitor your expenses closely.":"You're managing your finances well!"})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx("i",{className:"fas fa-tasks text-gray-300 text-2xl mb-2"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Add budgets to track progress"})]})})]})]}),e.jsx("div",{className:"d-none d-md-block",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-xl-8 col-lg-7 mb-3 mb-md-4",children:[e.jsx(at,{title:`Budget vs Spending - ${qe()}${t.categoryId!=="all"||t.status!=="all"||t.search!==""||t.scope!=="all"?" (Filtered)":""}`,showInfo:!0,onInfoClick:s=>W("barChart",s),animationDelay:"0.3s",children:B&&x.length>0?e.jsxs(e.Fragment,{children:[e.jsx(lt,{options:B,chartRef:ut}),e.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:[e.jsx("i",{className:"fas fa-lightbulb text-warning mr-1"}),e.jsx("strong",{children:"Tip:"})," Hover over each bar to see exact budget and spending amounts. Compare blue (budget) with red (spent) to identify overspending."]})]}):e.jsxs("div",{className:"text-center my-5",children:[e.jsx("div",{className:"mb-3",children:e.jsx("i",{className:"fas fa-wallet fa-4x text-gray-300"})}),e.jsx("p",{className:"text-gray-500",children:i?"No budgets match your filters":Fe?"No family budgets found for this period":"No budgets found for this period"}),e.jsxs(O,{to:"/budgets/create",className:"inline-block w-auto px-3 py-2 bg-[#4e73df] hover:bg-[#2e59d9] text-white text-sm font-normal rounded shadow-sm transition-colors",children:[e.jsx("i",{className:"fas fa-plus fa-sm mr-1 mr-md-2"}),e.jsx("span",{className:"d-none d-md-inline",children:"Create Your First "}),"Budget"]})]})}),e.jsxs("div",{className:"card shadow mb-4 animate__animated animate__fadeIn",style:{animationDelay:"0.4s"},children:[e.jsx("div",{className:"card-header py-3",children:e.jsxs("h6",{className:"m-0 font-weight-bold text-primary d-flex align-items-center justify-content-between",style:{fontSize:"0.875rem"},children:[e.jsxs("div",{className:"d-flex align-items-center",children:["Overall Budget Progress",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:s=>W("progress",s),"aria-label":"Budget progress information"})})]}),x.length>0&&e.jsx("div",{className:`badge badge-${o>=90?"danger":o>=75?"warning":"success"} ml-2`,children:o>=90?"At Risk":o>=75?"Caution":"Healthy"})]})}),e.jsx("div",{className:"card-body",children:x.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-2 d-flex justify-content-between",children:[e.jsx("span",{children:"Overall Progress"}),e.jsx("span",{className:`font-weight-bold ${o>=90?"text-danger":o>=75?"text-warning":"text-success"}`,children:I(o)})]}),e.jsx("div",{className:"progress mb-4",children:e.jsx("div",{className:`progress-bar ${o>=90?"bg-danger":o>=75?"bg-warning":"bg-success"}`,role:"progressbar",style:{width:`${o}%`},"aria-valuenow":o,"aria-valuemin":0,"aria-valuemax":100,title:I(o)})}),e.jsx("div",{className:"mt-4 text-xs font-weight-bold text-gray-500 text-uppercase mb-1",children:"Budget Status"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 mb-4",children:e.jsx("div",{className:"card bg-success text-white shadow",children:e.jsxs("div",{className:"card-body py-2 md:py-3",children:["On Track",e.jsx("div",{className:"text-white-50 small",children:"Under budget"})]})})}),e.jsx("div",{className:"col-md-4 mb-4",children:e.jsx("div",{className:"card bg-warning text-white shadow",children:e.jsxs("div",{className:"card-body py-3",children:["Caution",e.jsx("div",{className:"text-white-50 small",children:"Near limit"})]})})}),e.jsx("div",{className:"col-md-4 mb-4",children:e.jsx("div",{className:"card bg-danger text-white shadow",children:e.jsxs("div",{className:"card-body py-3",children:["Attention",e.jsx("div",{className:"text-white-50 small",children:"Over budget"})]})})})]}),e.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:[e.jsx("i",{className:"fas fa-lightbulb text-warning mr-1"}),e.jsx("strong",{children:"Tip:"})," The color of the progress bar indicates your budget health: green is good, yellow means caution, and red indicates potential overspending."]})]}):e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"mb-3",children:e.jsx("i",{className:"fas fa-tasks fa-3x text-gray-300"})}),e.jsx("h5",{className:"text-gray-500 font-weight-light",children:"No budget progress to display"}),e.jsx("p",{className:"text-gray-500 mb-0 small",children:"Add budgets to track your spending progress."})]})})]})]}),e.jsxs("div",{className:"col-xl-4 col-lg-5 mb-3 mb-md-4",children:[e.jsxs("div",{className:"card shadow mb-3 md:mb-4 animate__animated animate__fadeIn",style:{animationDelay:"0.3s"},children:[e.jsx("div",{className:"card-header py-2 md:py-3",children:e.jsxs("h6",{className:"m-0 font-weight-bold text-primary d-flex align-items-center",children:["Budget Allocation - ",qe(),(t.categoryId!=="all"||t.status!=="all"||t.search!==""||t.scope!=="all")&&" (Filtered)",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:s=>W("pieChart",s),"aria-label":"Pie chart information"})})]})}),e.jsx("div",{className:"card-body",children:(()=>{const s=z&&x.length>0,a=x.some(l=>(l.spent||0)>0);return s&&a?e.jsxs(e.Fragment,{children:[e.jsx(ye,{highcharts:je,options:z,callback:pt,ref:Ee}),e.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:[e.jsx("i",{className:"fas fa-lightbulb text-warning mr-1"}),e.jsx("strong",{children:"Tip:"})," Click on a category slice to see more details. Larger segments represent categories with higher budget allocations. Use this visualization to ensure your budget aligns with your priorities and financial goals."]})]}):x.length>0&&!a?e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"mb-3",children:e.jsx("i",{className:"fas fa-chart-pie fa-3x text-gray-300"})}),e.jsx("h5",{className:"text-gray-500 font-weight-light",children:"No spending to visualize"}),e.jsxs("p",{className:"text-gray-500 mb-3 small",children:["You have ",x.length," budget",x.length!==1?"s":""," set up, but no spending has been recorded yet."]}),e.jsxs(O,{to:"/transactions/add",className:"inline-block w-auto px-3 py-2 bg-[#4e73df] hover:bg-[#2e59d9] text-white text-sm font-normal rounded shadow-sm transition-colors",children:[e.jsx("i",{className:"fas fa-plus fa-sm mr-1 mr-md-2"}),e.jsx("span",{className:"d-none d-md-inline",children:"Add Your First "}),"Transaction"]}),e.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:[e.jsx("i",{className:"fas fa-info-circle mr-1"}),e.jsx("strong",{children:"Tip:"})," Start tracking your expenses to see how your spending compares to your budget allocation."]})]}):e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"mb-3",children:e.jsx("i",{className:"fas fa-chart-pie fa-3x text-gray-300"})}),e.jsx("h5",{className:"text-gray-500 font-weight-light",children:"No budget data"}),e.jsx("p",{className:"text-gray-500 mb-3 small",children:i?"No budgets match your current filters.":Fe?"No family budgets found for this period.":"Add budgets to see your budget allocation."}),!i&&e.jsxs(O,{to:"/budgets/create",className:"inline-block w-auto px-3 py-2 bg-[#4e73df] hover:bg-[#2e59d9] text-white text-sm font-normal rounded shadow-sm transition-colors",children:[e.jsx("i",{className:"fas fa-plus fa-sm mr-1 mr-md-2"}),e.jsx("span",{className:"d-none d-md-inline",children:"Create Your First "}),"Budget"]})]})})()})]}),e.jsxs("div",{className:"card shadow mb-4 animate__animated animate__fadeIn",style:{animationDelay:"0.4s"},children:[e.jsx("div",{className:"card-header py-3",children:e.jsxs("h6",{className:"m-0 font-weight-bold text-primary d-flex align-items-center",children:["Budget Health",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:s=>W("health",s),"aria-label":"Budget health information"})})]})}),e.jsx("div",{className:"card-body",children:x.length>0?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-3",children:e.jsx("i",{className:`fas fa-${o>=90?"exclamation-triangle text-danger":o>=75?"exclamation-circle text-warning":"check-circle text-success"} fa-3x mb-3`})}),e.jsx("h4",{className:"font-weight-bold",style:{color:o>=90?"#e74a3b":o>=75?"#f6c23e":"#1cc88a"},children:o>=90?"At Risk":o>=75?"Caution":"Healthy"}),e.jsxs("p",{className:"mb-0",children:["You've spent ",I(o)," of your total budget.",o>=90?" Consider reviewing your spending habits.":o>=75?" Monitor your expenses closely.":" You're managing your finances well!"]}),e.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:[e.jsx("i",{className:"fas fa-lightbulb text-warning mr-1"}),e.jsx("strong",{children:"Tip:"})," Your budget health status considers all your spending across categories and provides an overall assessment of your financial situation."]})]}):e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"mb-3",children:e.jsx("i",{className:"fas fa-heartbeat fa-3x text-gray-300"})}),e.jsx("h5",{className:"text-gray-500 font-weight-light",children:"No budget health data"}),e.jsx("p",{className:"text-gray-500 mb-0 small",children:"Create budgets to see your financial health status."})]})})]})]})]})}),(t.categoryId!=="all"||t.status!=="all"||t.month!=="all"||t.year!=="all"||t.search!==""||t.scope!=="all")&&e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"bg-blue-50 rounded-xl px-3 py-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-filter text-blue-500 text-[10px]"}),e.jsxs("span",{className:"text-[11px] text-blue-700",children:[e.jsx("span",{className:"font-semibold",children:x.length})," of ",w.length," budgets"]})]}),e.jsxs("button",{onClick:X,className:"text-[10px] text-blue-600 font-medium flex items-center gap-1",children:[e.jsx("i",{className:"fas fa-times text-[8px]"}),"Clear"]})]})}),e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2.5 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("h6",{className:"text-[11px] font-bold text-gray-800 flex items-center gap-1.5",children:[e.jsx("i",{className:"fas fa-list text-indigo-500 text-[10px]"}),"Budget List",J>0&&e.jsx("span",{className:"bg-indigo-100 text-indigo-600 px-1.5 py-0.5 rounded-full text-[9px]",children:J})]}),e.jsxs("button",{className:"text-[10px] text-gray-500 flex items-center gap-1",onClick:X,children:[e.jsx("i",{className:"fas fa-undo text-[8px]"}),"Reset"]})]}),e.jsxs("div",{className:"px-3 py-2 bg-gray-50 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[e.jsxs("button",{onClick:()=>Ve(!Ye),className:`flex-shrink-0 flex items-center gap-1.5 px-3 py-1.5 rounded-full text-[11px] font-medium transition-all ${t.categoryId!=="all"||t.status!=="all"||t.month!=="all"||t.year!=="all"||t.search!==""||t.scope!=="all"?"bg-indigo-500 text-white shadow-md":"bg-white text-gray-600 border border-gray-200"}`,children:[e.jsx("i",{className:"fas fa-sliders-h text-[10px]"}),"Filters",(t.categoryId!=="all"||t.status!=="all"||t.month!=="all"||t.year!=="all"||t.search!==""||t.scope!=="all")&&e.jsx("span",{className:"w-4 h-4 rounded-full bg-white/30 flex items-center justify-center text-[9px]",children:(t.categoryId!=="all"?1:0)+(t.status!=="all"?1:0)+(t.month!=="all"?1:0)+(t.year!=="all"?1:0)+(t.search!==""?1:0)+(t.scope!=="all"?1:0)})]}),["all","success","warning","danger"].map(s=>e.jsx("button",{onClick:()=>D({target:{name:"status",value:s}}),className:`flex-shrink-0 px-3 py-1.5 rounded-full text-[11px] font-medium transition-all ${t.status===s?s==="success"?"bg-emerald-500 text-white shadow-sm":s==="warning"?"bg-amber-500 text-white shadow-sm":s==="danger"?"bg-rose-500 text-white shadow-sm":"bg-indigo-500 text-white shadow-sm":"bg-white text-gray-600 border border-gray-200"}`,children:s==="all"?"All":s==="success"?"On Track":s==="warning"?"Caution":"At Risk"},s)),(t.categoryId!=="all"||t.status!=="all"||t.month!=="all"||t.year!=="all"||t.search!==""||t.scope!=="all")&&e.jsx("button",{onClick:X,className:"flex-shrink-0 w-7 h-7 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center hover:bg-gray-300 transition-colors",children:e.jsx("i",{className:"fas fa-times text-[10px]"})})]}),Ye&&e.jsxs("div",{className:"mt-2 bg-white rounded-xl shadow-lg border border-gray-100 p-3 animate__animated animate__fadeIn",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase mb-1 block",children:"Category"}),e.jsxs("select",{name:"categoryId",className:"w-full px-2 py-1.5 bg-gray-50 border border-gray-200 rounded-lg text-[11px] text-gray-700 focus:ring-2 focus:ring-indigo-200 focus:border-indigo-400",value:t.categoryId,onChange:D,disabled:i,children:[e.jsx("option",{value:"all",children:"All Categories"}),Q.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase mb-1 block",children:"Status"}),e.jsxs("select",{name:"status",className:"w-full px-2 py-1.5 bg-gray-50 border border-gray-200 rounded-lg text-[11px] text-gray-700 focus:ring-2 focus:ring-indigo-200 focus:border-indigo-400",value:t.status,onChange:D,disabled:i,children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"success",children:"On Track"}),e.jsx("option",{value:"warning",children:"Caution"}),e.jsx("option",{value:"danger",children:"At Risk"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase mb-1 block",children:"Month"}),e.jsxs("select",{name:"month",className:"w-full px-2 py-1.5 bg-gray-50 border border-gray-200 rounded-lg text-[11px] text-gray-700",value:t.month,onChange:D,disabled:i,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"1",children:"Jan"}),e.jsx("option",{value:"2",children:"Feb"}),e.jsx("option",{value:"3",children:"Mar"}),e.jsx("option",{value:"4",children:"Apr"}),e.jsx("option",{value:"5",children:"May"}),e.jsx("option",{value:"6",children:"Jun"}),e.jsx("option",{value:"7",children:"Jul"}),e.jsx("option",{value:"8",children:"Aug"}),e.jsx("option",{value:"9",children:"Sep"}),e.jsx("option",{value:"10",children:"Oct"}),e.jsx("option",{value:"11",children:"Nov"}),e.jsx("option",{value:"12",children:"Dec"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase mb-1 block",children:"Year"}),e.jsxs("select",{name:"year",className:"w-full px-2 py-1.5 bg-gray-50 border border-gray-200 rounded-lg text-[11px] text-gray-700",value:t.year,onChange:D,disabled:i,children:[e.jsx("option",{value:"all",children:"All"}),Array.from({length:5},(s,a)=>{const l=new Date().getFullYear()-2+a;return e.jsx("option",{value:l.toString(),children:l},l)})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase mb-1 block",children:"Search"}),e.jsx("input",{type:"text",name:"search",className:"w-full px-2 py-1.5 bg-gray-50 border border-gray-200 rounded-lg text-[11px] text-gray-700",placeholder:"Search budget or category...",value:t.search,onChange:D,disabled:i})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase mb-1 block",children:"Scope"}),e.jsxs("select",{name:"scope",className:"w-full px-2 py-1.5 bg-gray-50 border border-gray-200 rounded-lg text-[11px] text-gray-700",value:t.scope,onChange:D,disabled:i,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"personal",children:"Personal"}),ee&&e.jsx("option",{value:"family",children:"Family"})]})]})]}),e.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-100 flex items-center justify-between",children:[e.jsxs("button",{onClick:X,className:"text-[10px] text-gray-500 font-medium",disabled:i,children:[e.jsx("i",{className:"fas fa-undo mr-1 text-[8px]"}),"Reset"]}),e.jsx("button",{onClick:()=>Ve(!1),className:"text-[10px] text-indigo-600 font-medium",children:"Done"})]})]})]}),e.jsx("div",{className:"p-3",children:i?e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Filtering budgets..."})]}):pe.length>0?e.jsxs(e.Fragment,{children:[pe.map(s=>e.jsx(rt,{budget:s,onView:a=>h(`/budgets/${a}`),onEdit:a=>h(`/budgets/${a}/edit`),onDelete:Qe},s.id)),L>1&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] text-gray-500",children:[fe+1,"-",ke," of ",J]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>ie(F-1),disabled:F===1,className:"w-7 h-7 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx("i",{className:"fas fa-chevron-left text-[10px]"})}),e.jsxs("span",{className:"text-[11px] text-gray-700 px-2",children:[F," / ",L]}),e.jsx("button",{onClick:()=>ie(F+1),disabled:F===L,className:"w-7 h-7 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx("i",{className:"fas fa-chevron-right text-[10px]"})})]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-3",children:e.jsx("i",{className:"fas fa-filter text-gray-400 text-lg"})}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"No budgets found"}),e.jsxs(O,{to:"/budgets/create",className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-500 text-white text-sm font-medium rounded-lg hover:bg-indigo-600 transition-colors",children:[e.jsx("i",{className:"fas fa-plus text-xs"}),"Create Budget"]})]})})]})}),e.jsxs("div",{className:"d-none d-md-block",children:[(t.categoryId!=="all"||t.status!=="all"||t.month!=="all"||t.year!=="all"||t.search!==""||t.scope!=="all")&&e.jsxs("div",{className:"alert alert-info alert-dismissible fade show mb-3 animate__animated animate__fadeIn",role:"alert",style:{fontSize:"0.875rem"},children:[e.jsx("i",{className:"fas fa-filter mr-2"}),e.jsx("strong",{children:"Filters Active:"})," Showing ",x.length," of ",w.length," budgets",t.categoryId!=="all"&&" â€¢ Category filtered",t.status!=="all"&&" â€¢ Status filtered",t.month!=="all"&&" â€¢ Month filtered",t.year!=="all"&&" â€¢ Year filtered",t.search!==""&&' â€¢ Search: "'+t.search+'"',t.scope!=="all"&&" â€¢ Scope: "+t.scope,e.jsx("button",{type:"button",className:"close",onClick:X,style:{fontSize:"1.2rem"},children:e.jsx("span",{"aria-hidden":"true",children:"Ã—"})})]}),e.jsxs("div",{className:"card shadow mb-3 md:mb-4 budget-table",children:[e.jsxs("div",{className:"card-header py-2 md:py-3 d-flex flex-row align-items-center justify-content-between",children:[e.jsxs("h6",{className:"m-0 font-weight-bold text-primary d-flex align-items-center",children:["Budget Categories",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:s=>W("budgetCategories",s),"aria-label":"Budget categories information",style:{cursor:"pointer"}})})]}),e.jsx("div",{children:e.jsxs("button",{className:"btn btn-sm btn-outline-secondary",onClick:X,children:[e.jsx("i",{className:"fas fa-undo fa-sm mr-1"})," Reset Filters"]})})]}),e.jsxs("div",{className:"card-body border-bottom bg-light py-2 md:py-3",children:[e.jsxs("div",{className:"row align-items-end",children:[e.jsxs("div",{className:"col-lg-2 col-md-3 col-6 mb-2",children:[e.jsxs("label",{htmlFor:"categoryFilter",className:"text-xs font-weight-bold text-gray-700 mb-1",children:[e.jsx("span",{className:"d-none d-md-inline",children:"Category"}),e.jsx("span",{className:"d-inline d-md-none",children:"Category"})]}),e.jsxs("select",{id:"categoryFilter",name:"categoryId",value:t.categoryId,onChange:D,className:"form-control form-control-sm",disabled:i,children:[e.jsx("option",{value:"all",children:"All Categories"}),Q.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"col-lg-2 col-md-3 col-6 mb-2",children:[e.jsxs("label",{htmlFor:"statusFilter",className:"text-xs font-weight-bold text-gray-700 mb-1",children:[e.jsx("span",{className:"d-none d-md-inline",children:"Status"}),e.jsx("span",{className:"d-inline d-md-none",children:"Status"})]}),e.jsxs("select",{id:"statusFilter",name:"status",value:t.status,onChange:D,className:"form-control form-control-sm",disabled:i,children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"success",children:"On Track"}),e.jsx("option",{value:"warning",children:"Caution"}),e.jsx("option",{value:"danger",children:"At Risk"})]})]}),e.jsxs("div",{className:"col-lg-2 col-md-3 col-6 mb-2",children:[e.jsxs("label",{htmlFor:"monthFilter",className:"text-xs font-weight-bold text-gray-700 mb-1",children:[e.jsx("span",{className:"d-none d-md-inline",children:"Month"}),e.jsx("span",{className:"d-inline d-md-none",children:"Month"})]}),e.jsxs("select",{id:"monthFilter",name:"month",value:t.month,onChange:D,className:"form-control form-control-sm",disabled:i,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"1",children:"January"}),e.jsx("option",{value:"2",children:"February"}),e.jsx("option",{value:"3",children:"March"}),e.jsx("option",{value:"4",children:"April"}),e.jsx("option",{value:"5",children:"May"}),e.jsx("option",{value:"6",children:"June"}),e.jsx("option",{value:"7",children:"July"}),e.jsx("option",{value:"8",children:"August"}),e.jsx("option",{value:"9",children:"September"}),e.jsx("option",{value:"10",children:"October"}),e.jsx("option",{value:"11",children:"November"}),e.jsx("option",{value:"12",children:"December"})]})]}),e.jsxs("div",{className:"col-lg-2 col-md-3 col-6 mb-2",children:[e.jsxs("label",{htmlFor:"yearFilter",className:"text-xs font-weight-bold text-gray-700 mb-1",children:[e.jsx("span",{className:"d-none d-md-inline",children:"Year"}),e.jsx("span",{className:"d-inline d-md-none",children:"Year"})]}),e.jsxs("select",{id:"yearFilter",name:"year",value:t.year,onChange:D,className:"form-control form-control-sm",disabled:i,children:[e.jsx("option",{value:"all",children:"All"}),Array.from({length:5},(s,a)=>{const l=new Date().getFullYear()-2+a;return e.jsx("option",{value:l.toString(),children:l},l)})]})]}),e.jsxs("div",{className:"col-lg-3 col-md-6 col-12 mb-2",children:[e.jsxs("label",{htmlFor:"searchFilter",className:"text-xs font-weight-bold text-gray-700 mb-1",children:[e.jsx("span",{className:"d-none d-md-inline",children:"Search"}),e.jsx("span",{className:"d-inline d-md-none",children:"Search"})]}),e.jsx("input",{type:"text",id:"searchFilter",name:"search",value:t.search,onChange:D,placeholder:"Search budget or category...",className:"form-control form-control-sm",disabled:i})]}),e.jsxs("div",{className:"col-lg-1 col-md-3 col-12 mb-2",children:[e.jsxs("label",{htmlFor:"scopeFilter",className:"text-xs font-weight-bold text-gray-700 mb-1",children:[e.jsx("span",{className:"d-none d-md-inline",children:"Scope"}),e.jsx("span",{className:"d-inline d-md-none",children:"Scope"})]}),e.jsxs("select",{id:"scopeFilter",name:"scope",value:t.scope,onChange:D,className:"form-control form-control-sm",disabled:i,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"personal",children:"Personal"}),ee&&e.jsx("option",{value:"family",children:"Family"})]})]})]}),e.jsx("div",{className:"row mt-2",children:e.jsx("div",{className:"col-12 text-right",children:e.jsxs("button",{className:"btn btn-sm btn-outline-secondary",onClick:X,disabled:i,style:{fontSize:"0.7rem",padding:"0.25rem 0.5rem"},children:[e.jsx("i",{className:"fas fa-undo fa-sm",style:{fontSize:"0.7rem"}}),e.jsx("span",{className:"d-none d-md-inline ml-1",children:i?"Filtering...":"Reset Filters"}),e.jsx("span",{className:"d-inline d-md-none ml-1",children:i?"Filtering...":"Reset"})]})})})]}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered",width:"100%",cellSpacing:"0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Period"}),e.jsx("th",{children:"Budget"}),e.jsx("th",{children:"Spent"}),e.jsx("th",{children:"Remaining"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Progress"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:i?e.jsx("tr",{children:e.jsxs("td",{colSpan:9,className:"text-center py-5",children:[e.jsx("div",{className:"spinner-border text-primary mb-3",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}),e.jsx("p",{className:"text-gray-600 mt-3",children:"Filtering budgets..."})]})}):pe.length>0?pe.map(s=>{const a=jt(s.status),l=Math.min(s.percentage_used||0,100);return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"font-weight-bold text-primary",children:s.budget_name||"Unnamed Budget"})}),e.jsx("td",{children:e.jsx("span",{className:"font-weight-bold",children:s.category_name})}),e.jsxs("td",{children:[e.jsxs("div",{children:[Ge(s).month," ",Ge(s).year]}),e.jsx("small",{className:"text-gray-600",children:s.period})]}),e.jsx("td",{className:"font-weight-bold",children:p(s.amount)}),e.jsx("td",{children:p(s.spent)}),e.jsx("td",{className:(s.remaining||0)<0?"text-danger font-weight-bold":"text-success font-weight-bold",children:p(s.remaining||0)}),e.jsx("td",{children:(s.percentage_used||0)>=100?e.jsxs("span",{className:"badge badge-danger",children:[e.jsx("i",{className:"fas fa-exclamation-circle mr-1"}),"Over Budget"]}):(s.percentage_used||0)>=90?e.jsxs("span",{className:"badge badge-warning",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-1"}),"Near Limit"]}):e.jsxs("span",{className:"badge badge-success",children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),"On Track"]})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"progress mr-2",style:{height:"10px",width:"80px"},children:e.jsx("div",{className:`progress-bar bg-${a}`,role:"progressbar",style:{width:`${l}%`},"aria-valuenow":l,"aria-valuemin":0,"aria-valuemax":100})}),e.jsx("span",{className:`text-${a}`,children:I(l)})]})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center",children:[e.jsx(O,{to:`/budgets/${s.id}`,className:"btn btn-info btn-circle btn-sm mx-1",title:"View Budget Details",children:e.jsx("i",{className:"fas fa-eye"})}),e.jsx(O,{to:`/budgets/${s.id}/edit`,className:"btn btn-primary btn-circle btn-sm mx-1",title:"Edit Budget",children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{className:"btn btn-danger btn-circle btn-sm mx-1",onClick:()=>Qe(s.id),title:"Delete Budget",children:e.jsx("i",{className:"fas fa-trash"})})]})})]},s.id)}):e.jsx("tr",{children:e.jsxs("td",{colSpan:9,className:"text-center py-4",children:[e.jsx("i",{className:"fas fa-filter fa-2x text-gray-300 mb-3 d-block"}),e.jsx("p",{className:"text-gray-500",children:"No budgets found matching your filters."})]})})})]})}),L>1&&e.jsx("div",{className:"card-footer bg-white border-0",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-4 text-center text-md-start mb-2 mb-md-0",children:e.jsxs("span",{className:"text-muted",style:{fontSize:"0.875rem"},children:["Showing ",Math.min(fe+1,J)," to ",ke," of ",J," entries"]})}),e.jsxs("div",{className:"col-md-4 text-center mb-2 mb-md-0",children:[e.jsx("label",{className:"me-2 mb-0",style:{fontSize:"0.875rem"},children:"Show"}),e.jsxs("select",{className:"form-select d-inline-block w-auto",style:{fontSize:"0.875rem"},value:he,onChange:s=>ft(Number(s.target.value)),children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),e.jsx("label",{className:"ms-2 mb-0",style:{fontSize:"0.875rem"},children:"per page"})]}),e.jsx("div",{className:"col-md-4 text-center text-md-end",children:e.jsx("nav",{children:e.jsxs("ul",{className:"pagination mb-0 justify-content-center justify-content-md-end",children:[e.jsx("li",{className:`page-item ${F===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>ie(F-1),disabled:F===1,children:e.jsx("i",{className:"fas fa-chevron-left"})})}),Array.from({length:Math.min(L,5)},(s,a)=>{let l;return L<=5||F<=3?l=a+1:F>=L-2?l=L-4+a:l=F-2+a,e.jsx("li",{className:`page-item ${F===l?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>ie(l),style:F===l?{color:"white"}:{},children:l})},l)}),e.jsx("li",{className:`page-item ${F===L?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>ie(F+1),disabled:F===L,children:e.jsx("i",{className:"fas fa-chevron-right"})})})]})})})]})})]})]})]}),ot&&e.jsx("div",{className:"modal fade show",style:{display:"block"},"aria-modal":"true",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Confirm Deletion"}),e.jsx("button",{type:"button",className:"close",onClick:Te,disabled:ge,children:e.jsx("span",{"aria-hidden":"true",children:"Ã—"})})]}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"rounded-circle mx-auto d-flex align-items-center justify-content-center",style:{width:"80px",height:"80px",backgroundColor:"rgba(246, 194, 62, 0.2)"},children:e.jsx("i",{className:"fas fa-exclamation-triangle fa-3x text-warning"})})}),e.jsx("p",{children:"Are you sure you want to delete this budget? This action cannot be undone."})]}),e.jsxs("div",{className:"modal-footer d-flex justify-content-center",children:[e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Te,disabled:ge,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:bt,disabled:ge,children:ge?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"Delete"]}):"Delete"})]})]})})})]})})});zt.displayName="Budgets";export{zt as default};
