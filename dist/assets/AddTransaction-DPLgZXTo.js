import{j as e}from"./ui-vendor-Cn1Vfl4w.js";import{u as le,e as de,r as x,L as T}from"./react-vendor-D4A9EtXC.js";import{u as me,b as xe,s as w}from"./index-BbApZ7g3.js";import{u as ue}from"./PermissionErrorModal-Dc2W8uaB.js";import{U as B}from"./userOnboardingService-C949bn3s.js";import{A as ge}from"./accountService-CFCTGWw4.js";import{B as he}from"./BudgetSelector-D5tTEr2o.js";import{C as fe}from"./CentavoInput-HJGBXETA.js";import{f as V,r as pe,s as be}from"./currencyUtils-BZq_rNNs.js";import{A as ye}from"./AccountSelector-Bv9lXSIJ.js";import{C as je}from"./CategorySelector-DIi64-QW.js";import{G as Ne}from"./GoalSelector-BkgJuR_a.js";import{T as X}from"./transactions-CJCWbHAc.js";import{E as ve}from"./ErrorBoundary-BBG4Eo_2.js";/* empty css                       */import"./chart-vendor-B0c7K_uV.js";const we=()=>{const k=le();de();const{user:h}=me(),{showSuccessToast:J,showErrorToast:f}=xe();ue();const[l,K]=x.useState({accounts:[],incomeCategories:[],expenseCategories:[],goals:[]}),[F,j]=x.useState(null),[N,P]=x.useState(null),[Q,q]=x.useState(!0),[E,L]=x.useState(!1),[Z,D]=x.useState("form"),[S,R]=x.useState(!1),[A,M]=x.useState(null),[$,z]=x.useState(null),[n,v]=x.useState(null),[r,_]=x.useState(null),[ee,te]=x.useState(null),[_e,Ce]=x.useState({isOpen:!1,title:"",message:""}),[t,m]=x.useState({type:"expense",account_id:"",category_id:"",goal_id:"",budget_id:"",amount:0,date:new Date().toISOString().slice(0,10),description:""}),ae=s=>{if(s>9999999999999e-2){f("Amount too large: maximum supported amount is â‚±99,999,999,999.99");return}m(i=>({...i,amount:s}))};x.useEffect(()=>{(async()=>{try{if(!h){f("You must be logged in to add transactions"),k("/auth/login");return}if(q(!0),E){console.log("Setup already in progress, skipping...");return}console.log("Ensuring user setup for transaction form..."),L(!0);const i=await B.ensureUserSetup(h.id);L(!1),i||console.warn("User setup incomplete, but continuing with existing data");let a=[];const c=await ge.fetchUserAccounts(h.id);if(c.success)a=c.data||[];else{console.warn("Failed to fetch accounts with AccountService:",c.error);const{data:g,error:y}=await w.from("accounts").select("id, user_id, account_name, account_type, balance, status, is_default, currency, created_at, updated_at").eq("user_id",h.id).eq("status","active").order("account_name");if(y)throw y;a=g||[]}let o=[];try{o=await B.getUserDefaultIncomeCategories(h.id)}catch(g){console.warn("Service method failed, falling back to direct query:",g);const{data:y,error:C}=await w.from("income_categories").select("id, category_name, icon").eq("user_id",h.id).order("category_name");if(C)throw C;o=y||[]}let d=[];try{d=await B.getUserDefaultExpenseCategories(h.id)}catch(g){console.warn("Service method failed, falling back to direct query:",g);const{data:y,error:C}=await w.from("expense_categories").select("id, category_name, icon").eq("user_id",h.id).order("category_name");if(C)throw C;d=y||[]}const{data:u,error:p}=await w.from("goals").select("id, goal_name, target_amount, current_amount, target_date, priority, status, is_family_goal").eq("user_id",h.id).eq("status","in_progress").order("goal_name");if(p)throw p;const b=(u||[]).map(g=>({...g,target_date:g.target_date||new Date().toISOString().slice(0,10),priority:g.priority||"medium",status:g.status||"in_progress",is_family_goal:g.is_family_goal||!1}));if(K({accounts:a||[],incomeCategories:o||[],expenseCategories:d||[],goals:b||[]}),a&&a.length>0){const y=a.find(G=>G.is_default)||a[0],C=y?.id||"";P(y),m(G=>({...G,account_id:C}))}console.log("Fetched user data:",{accounts:a?.length||0,incomeCategories:o?.length||0,expenseCategories:d?.length||0,goals:u?.length||0})}catch(i){console.error("Error fetching user data:",i),f("Failed to load user data")}finally{q(!1)}})()},[h?.id,k,f]);const U=x.useCallback(s=>{const{name:i,value:a}=s.target;if(i==="type"){const c=a;m(o=>({...o,type:c,category_id:"",budget_id:"",goal_id:""})),v(null),j(null),_(null);return}if(m(c=>({...c,[i]:a})),i==="category_id"){const o=(t.type==="income"?l.incomeCategories:l.expenseCategories).find(d=>d.id===a);j(o||null),m(d=>({...d,budget_id:""})),v(null)}if(i==="goal_id")if(a){const c=l.goals.find(o=>o.id===a);_(c||null)}else _(null)},[t.type,l.incomeCategories,l.expenseCategories,l.goals]),se=s=>{P(s),m(i=>({...i,account_id:s?.id||""}))},ne=s=>{console.log("ðŸ·ï¸ AddTransaction: Category selected",{category:s,transactionType:t.type,previousCategoryId:t.category_id,newCategoryId:s?.id||""}),j(s),m(i=>({...i,category_id:s?.id||""})),v(null),m(i=>({...i,budget_id:""})),console.log("ðŸ”„ AddTransaction: After category selection, transaction state will be:",{type:t.type,category_id:s?.id||"",budget_id:"",previousBudgetCleared:!0})},ie=s=>{console.log("ðŸ’° AddTransaction: Budget selected",{budgetId:s?.id,budgetName:s?.budget_name,categoryId:s?.category_id,categoryName:s?.category_name}),v(s),m(i=>({...i,budget_id:s?.id||""}))},re=x.useCallback((s,i)=>{console.log("ðŸŽ AddTransaction: Auto-selecting category from budget",{categoryId:s,categoryName:i,currentCategoryId:t.category_id,forceSelection:!0,usingNameFallback:!s&&!!i});const a=t.type==="income"?l.incomeCategories:l.expenseCategories;let c;if(s?c=a.find(o=>o.id===s):i&&(c=a.find(o=>o.category_name===i)),c){console.log("âœ¨ AddTransaction: Force auto-selecting category from budget",{categoryId:c.id,categoryName:c.category_name,previousCategoryId:t.category_id,replacingExisting:!!t.category_id,matchedBy:s?"ID":"Name"});const o=c;setTimeout(()=>{j(o||null),o&&m(d=>({...d,category_id:o.id}))},0)}else console.warn("âš ï¸ AddTransaction: Category not found for auto-selection",{categoryId:s,categoryName:i,searchMethod:s?"ID":"Name",availableCategories:a.map(o=>({id:o.id,name:o.category_name}))})},[t.type,t.category_id,l.incomeCategories,l.expenseCategories]),oe=s=>{if(_(s),s&&(t.type==="contribution"||t.type==="expense")){let i=l.expenseCategories.find(a=>a.category_name.toLowerCase()==="contribution");i||(i=l.expenseCategories.find(a=>a.category_name.toLowerCase().includes("goal")||a.category_name.toLowerCase().includes("saving")||a.category_name.toLowerCase().includes("investment"))),i?(j(i),m(a=>({...a,goal_id:s.id||"",category_id:i?.id||""})),v(null),m(a=>({...a,budget_id:""}))):(m(a=>({...a,goal_id:s.id||"",category_id:t.type==="contribution"?"":a.category_id})),t.type==="contribution"&&j(null))}else m(i=>({...i,goal_id:s?.id||""}))},ce=s=>{if(s.preventDefault(),!t.amount||t.amount<=0){f("Please enter a valid amount");return}if(!t.date){f("Please select a date");return}if(!t.account_id){f("Please select an account");return}if(!t.category_id&&t.type!=="contribution"){f("Please select a category");return}const i=t.type==="income",a=t.type==="contribution";let c=!1;if(i?c=l.incomeCategories.some(o=>o.id===t.category_id):a?t.category_id?c=l.expenseCategories.some(o=>o.id===t.category_id):c=!0:c=l.expenseCategories.some(o=>o.id===t.category_id),!c){f(`Selected category does not match transaction type. Please select a ${i?"income":a?"expense (for contributions)":"expense"} category.`);return}if(t.type==="contribution"&&!t.goal_id){f("Please select a goal for your contribution.");return}if(a&&r&&t.amount>0){const o=r.target_amount-r.current_amount;if(t.amount>o&&!window.confirm(`This contribution (â‚±${t.amount.toFixed(2)}) exceeds the goal's remaining amount (â‚±${o.toFixed(2)}) by â‚±${(t.amount-o).toFixed(2)}. Do you want to proceed?`))return}if(t.type==="contribution"&&N&&t.amount>N.balance){f(`Insufficient funds for goal contribution in ${N.account_name}. Available balance: â‚±${N.balance.toFixed(2)}`);return}if(t.type==="expense"&&n){const o=t.amount,u=((n.spent||0)+o)/n.amount*100,p=(n.alert_threshold||.8)*100;if(u>=p&&u<100&&!window.confirm(`This transaction would put the budget "${n.budget_name}" at ${u.toFixed(1)}% utilization. Do you want to proceed?`))return}D("review"),window.scrollTo(0,0)},W=async()=>{if(!h){f("You must be logged in to add transactions");return}R(!0);try{const s=pe(t.amount),i=t.account_id;if(console.log("Transaction amount processing:",{originalAmount:t.amount,roundedAmount:s,amountType:typeof s,isValid:!isNaN(s)&&isFinite(s),maxSafeInteger:Number.MAX_SAFE_INTEGER,exceedsLimit:s>9999999999999e-2}),!isFinite(s)||isNaN(s))throw new Error("Invalid amount: must be a valid number");if(s>9999999999999e-2)throw new Error("Amount too large: maximum supported amount is â‚±99,999,999,999.99");if(s<=0)throw new Error("Amount must be greater than zero");if(t.category_id&&t.type){const d=t.type==="income",u=t.type==="contribution";let p=!1;if(d?p=l.incomeCategories.some(b=>b.id===t.category_id):u?t.category_id?p=l.expenseCategories.some(b=>b.id===t.category_id):p=!0:p=l.expenseCategories.some(b=>b.id===t.category_id),!p){const b=d?"income":u?"expense (for contributions)":"expense";throw new Error(`Selected category does not match transaction type. Please select a ${b} category.`)}}if(t.type==="contribution"&&!t.goal_id)throw new Error("Please select a goal for your contribution.");if(t.type==="contribution"&&r&&t.amount>0){const d=r.target_amount-r.current_amount;t.amount>d&&console.warn(`Contribution exceeds goal remaining amount by â‚±${(t.amount-d).toFixed(2)}`)}if(t.type==="contribution"&&N&&t.amount>N.balance)throw new Error(`Insufficient funds for goal contribution in ${N.account_name}. Available balance: â‚±${N.balance.toFixed(2)}`);const a={user_id:h.id,account_id:i,goal_id:t.goal_id||null,type:t.type,amount:s,date:t.date,description:be(t.description),created_at:new Date().toISOString()};console.log("Transaction data being inserted:",{...a,amount:s,amountType:typeof s,amountString:s.toString(),category_id_original:t.category_id,selected_category:F}),t.type==="income"?a.income_category_id=t.category_id||null:(t.type==="expense"||t.type==="contribution")&&(a.expense_category_id=t.category_id||null);const{data:c,error:o}=await w.from("transactions").insert([a]).select();if(o)throw console.error("Supabase transaction insert error:",{error:o,code:o.code,message:o.message,details:o.details,hint:o.hint,transactionData:a}),o;if(console.log("Transaction inserted successfully:",c),t.goal_id){const{error:d}=await w.rpc("update_goal_progress",{p_goal_id:t.goal_id,p_amount:s});if(d){const{data:u,error:p}=await w.from("goals").select("current_amount, target_amount").eq("id",t.goal_id).single();if(p)throw p;const b=u.current_amount+s,g=b>=u.target_amount?"completed":"in_progress",{error:y}=await w.from("goals").update({current_amount:b,status:g}).eq("id",t.goal_id);if(y)throw y}}try{if(c&&c[0]){const d=X.extractTransactionAuditData(c[0],N,F,r);X.logTransactionCreated(h.id,d,navigator.userAgent).catch(u=>{console.error("Failed to log transaction creation to audit:",u)})}}catch(d){console.error("Error preparing transaction audit log:",d)}J("Transaction added successfully!"),k("/transactions")}catch(s){console.error("Error adding transaction:",s),console.error("Error details:",{code:s.code,message:s.message,details:s.details,hint:s.hint}),f(s.message||"Failed to add transaction")}finally{R(!1)}},O=(s,i)=>{if(A===s)M(null),z(null);else if(M(s),i){const a=i.currentTarget.getBoundingClientRect();z({top:a.bottom+window.scrollY,left:a.left+a.width/2+window.scrollX})}},Y={"transaction-details":{title:"Transaction Details",description:"Enter the details of your transaction including the amount, date, category, and account. All fields marked with * are required."},"transaction-tips":{title:"Transaction Tips",description:"Tips to help you categorize and track your spending effectively. Adding clear descriptions and choosing the right category helps with better financial analysis."}};if(Q)return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"block md:hidden py-12 animate__animated animate__fadeIn",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"mt-3 text-xs text-gray-500 font-medium",children:E?"Setting up your account...":"Loading transaction form..."})]})}),e.jsxs("div",{className:"text-center my-5 hidden md:block",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}),e.jsx("p",{className:"mt-3 text-gray-700",children:E?"Setting up your account...":"Loading transaction form..."}),e.jsx("small",{className:"text-muted",children:E?"Creating default accounts and categories if needed":"Please wait"})]})]});const I=l.accounts.length>0,H=l.incomeCategories.length>0||l.expenseCategories.length>0;if(!I||!H)return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-sm-flex align-items-center justify-content-between mb-4",children:[e.jsx("h1",{className:"h3 mb-0 text-gray-800",children:"Add Transaction"}),e.jsxs(T,{to:"/transactions",className:"inline-flex items-center justify-center px-2 py-1.5 md:px-3 md:py-2 bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 text-xs md:text-sm font-medium rounded shadow-sm transition-colors",children:[e.jsx("i",{className:"fas fa-arrow-left text-xs mr-1"})," Back to Transactions"]})]}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-lg-8",children:e.jsxs("div",{className:"card shadow mb-4 border-left-warning",children:[e.jsx("div",{className:"card-header py-3",children:e.jsxs("h6",{className:"m-0 font-weight-bold text-warning",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),"Account Setup Required"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"text-center py-4",children:[e.jsx("i",{className:"fas fa-cogs fa-3x text-warning mb-3"}),e.jsx("h4",{className:"mb-3",children:"Setting up your account..."}),e.jsx("p",{className:"text-muted mb-4",children:!I&&!H?"We're creating your default accounts and categories. This usually takes a moment.":I?"We're setting up your default categories.":"We're setting up your default accounts."}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center justify-center px-4 py-2 md:px-6 md:py-2.5 bg-[#f6c23e] hover:bg-[#dda20a] text-white text-sm md:text-base font-medium rounded shadow-sm transition-colors",children:[e.jsx("i",{className:"fas fa-sync-alt text-xs mr-2"}),"Refresh Page"]}),e.jsx("div",{className:"mt-3",children:e.jsx("small",{className:"text-muted",children:"If this persists, please go to Settings to set up your accounts and categories manually."})})]})})]})})})]});if(Z==="review"){const s=l.accounts.find(c=>c.id===t.account_id),i=t.type==="income"?l.incomeCategories.find(c=>c.id===t.category_id):l.expenseCategories.find(c=>c.id===t.category_id),a=t.goal_id?l.goals.find(c=>c.id===t.goal_id):null;return e.jsxs("div",{className:"container-fluid animate__animated animate__fadeIn",children:[e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-bold text-gray-800",children:"Review Transaction"}),e.jsx(T,{to:"/transactions",className:"w-9 h-9 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 flex items-center justify-center shadow-sm transition-all active:scale-95","aria-label":"Cancel",children:e.jsx("i",{className:"fas fa-times text-xs"})})]})}),e.jsxs("div",{className:"d-none d-md-flex align-items-center justify-content-between mb-4",children:[e.jsx("h1",{className:"h3 mb-0 text-gray-800",children:"Review Transaction"}),e.jsxs(T,{to:"/transactions",className:"inline-flex items-center justify-center px-2 py-1.5 md:px-3 md:py-2 bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 text-xs md:text-sm font-medium rounded shadow-sm transition-colors",children:[e.jsx("i",{className:"fas fa-arrow-left text-xs mr-1"})," Cancel"]})]}),e.jsxs("div",{className:"block md:hidden mb-4",children:[e.jsxs("div",{className:`bg-gradient-to-br ${t.type==="income"?"from-emerald-500 via-teal-500 to-cyan-500":t.type==="contribution"?"from-blue-500 via-indigo-500 to-purple-500":"from-rose-500 via-red-500 to-orange-500"} rounded-2xl p-4 shadow-lg`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-white/80 text-xs font-medium",children:t.type==="income"?"Income":t.type==="contribution"?"Contribution":"Expense"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:`fas fa-${t.type==="income"?"plus":t.type==="contribution"?"flag":"minus"} text-white text-sm`})})]}),e.jsx("div",{className:"text-white text-2xl font-bold mb-1",children:V(t.amount)}),e.jsx("div",{className:"text-white/70 text-xs",children:new Date(t.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-blue-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-university text-blue-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Account"}),e.jsx("p",{className:"text-xs font-bold text-gray-800 truncate",children:s?.account_name||"N/A"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-amber-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-tag text-amber-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Category"}),e.jsx("p",{className:"text-xs font-bold text-gray-800 truncate",children:i?.category_name||"N/A"})]})]}),a&&e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-indigo-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-flag text-indigo-500 text-xs"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Goal"}),e.jsx("p",{className:"text-xs font-bold text-gray-800 truncate",children:a.goal_name})]}),a.is_family_goal&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-blue-100 text-blue-600 text-[9px] font-semibold",children:"Family"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5 mb-1",children:e.jsx("div",{className:"bg-indigo-500 h-1.5 rounded-full transition-all duration-500",style:{width:`${a.target_amount>0?Math.min(100,a.current_amount/a.target_amount*100):0}%`}})}),e.jsxs("p",{className:"text-[10px] text-gray-500",children:[a.target_amount>0?(a.current_amount/a.target_amount*100).toFixed(1):0,"% complete"]})]}),n&&e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-emerald-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-wallet text-emerald-500 text-xs"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Budget"}),e.jsx("p",{className:"text-xs font-bold text-gray-800 truncate",children:n.budget_name})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5 mb-1",children:e.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 ${((n.spent||0)+t.amount)/n.amount>=.9?"bg-rose-500":((n.spent||0)+t.amount)/n.amount>=.8?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${Math.min(100,((n.spent||0)+t.amount)/n.amount*100)}%`}})}),e.jsxs("p",{className:"text-[10px] text-gray-500",children:[(((n.spent||0)+t.amount)/n.amount*100).toFixed(1),"% after this transaction"]})]}),t.description&&e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100 mt-2",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide mb-1",children:"Description"}),e.jsx("p",{className:"text-xs text-gray-700",children:t.description})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>D("form"),className:"flex-1 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm font-medium rounded-xl transition-colors flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-arrow-left text-xs"}),"Edit"]}),e.jsxs("button",{onClick:W,disabled:S,className:`flex-1 py-3 ${t.type==="income"?"bg-emerald-500 hover:bg-emerald-600":t.type==="contribution"?"bg-indigo-500 hover:bg-indigo-600":"bg-rose-500 hover:bg-rose-600"} text-white text-sm font-medium rounded-xl transition-colors flex items-center justify-center gap-2 disabled:opacity-50`,children:[e.jsx("i",{className:`${S?"fas fa-spinner fa-spin":"fas fa-check"} text-xs`}),S?"Saving...":"Save"]})]})]}),e.jsx("div",{className:"row d-none d-md-flex",children:e.jsx("div",{className:"col-lg-8 mx-auto",children:e.jsxs("div",{className:"card shadow mb-4",children:[e.jsxs("div",{className:"card-header py-3 d-flex align-items-center",children:[e.jsx("span",{className:`badge mr-2 ${t.type==="income"?"badge-success":t.type==="contribution"?"badge-info":"badge-danger"}`,children:t.type==="income"?"Income":t.type==="contribution"?"Contribute":"Expense"}),e.jsx("h6",{className:"m-0 font-weight-bold text-primary",children:"Transaction Details"})]}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-6 mb-4 mb-md-0",children:e.jsx("div",{className:"card border-left-primary shadow h-100 py-2",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"text-xs font-weight-bold text-primary text-uppercase mb-1",children:"Amount"}),e.jsx("div",{className:"h5 mb-0 font-weight-bold text-gray-800",children:V(t.amount)})]}),e.jsx("div",{className:"col-auto",children:e.jsx("i",{className:"fas fa-solid fa-peso-sign fa-2x text-gray-300"})})]})})})}),e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"card border-left-info shadow h-100 py-2",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"text-xs font-weight-bold text-info text-uppercase mb-1",children:"Date"}),e.jsx("div",{className:"h5 mb-0 font-weight-bold text-gray-800",children:new Date(t.date).toLocaleDateString()})]}),e.jsx("div",{className:"col-auto",children:e.jsx("i",{className:"fas fa-calendar fa-2x text-gray-300"})})]})})})})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-6 mb-4 mb-md-0",children:e.jsx("div",{className:"card border-left-success shadow h-100 py-2",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"text-xs font-weight-bold text-success text-uppercase mb-1",children:"Account"}),e.jsx("div",{className:"h5 mb-0 font-weight-bold text-gray-800",children:s?.account_name})]}),e.jsx("div",{className:"col-auto",children:e.jsx("i",{className:"fas fa-university fa-2x text-gray-300"})})]})})})}),e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"card border-left-warning shadow h-100 py-2",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"text-xs font-weight-bold text-warning text-uppercase mb-1",children:"Category"}),e.jsx("div",{className:"h5 mb-0 font-weight-bold text-gray-800",children:i?.category_name})]}),e.jsx("div",{className:"col-auto",children:e.jsx("i",{className:"fas fa-tag fa-2x text-gray-300"})})]})})})})]}),a&&e.jsx("div",{className:"card bg-white shadow mb-4",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsxs("div",{className:"text-xs font-weight-bold text-primary text-uppercase mb-1",children:["Associated Goal",t.type==="contribution"&&e.jsxs("span",{className:"badge badge-info ml-2",children:[e.jsx("i",{className:"fas fa-flag mr-1"})," Contribution Target"]})]}),e.jsxs("div",{className:"h5 mb-0 font-weight-bold text-primary d-flex align-items-center",children:[a.goal_name,a.is_family_goal?e.jsxs("span",{className:"badge badge-info ml-2",children:[e.jsx("i",{className:"fas fa-users mr-1"})," Family"]}):e.jsxs("span",{className:"badge badge-secondary ml-2",children:[e.jsx("i",{className:"fas fa-user mr-1"})," Personal"]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"d-flex justify-content-between text-sm mb-1",children:[e.jsx("span",{children:"Goal Progress"}),e.jsxs("span",{children:[a.target_amount>0?(a.current_amount/a.target_amount*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"progress",style:{height:"8px"},children:e.jsx("div",{className:`progress-bar ${a.target_amount>0&&a.current_amount/a.target_amount*100>=90?"bg-success":a.target_amount>0&&a.current_amount/a.target_amount*100>=75?"bg-info":a.target_amount>0&&a.current_amount/a.target_amount*100>=50?"bg-warning":"bg-danger"}`,role:"progressbar",style:{width:`${a.target_amount>0?Math.min(100,a.current_amount/a.target_amount*100):0}%`},"aria-valuenow":a.target_amount>0?Math.min(100,a.current_amount/a.target_amount*100):0,"aria-valuemin":0,"aria-valuemax":100})})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["â‚±",(a.target_amount-a.current_amount).toFixed(2)," remaining",t.type==="contribution"&&t.amount>0&&e.jsx("span",{className:"ml-2",children:t.amount>a.target_amount-a.current_amount?e.jsxs("span",{className:"text-warning",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-1"}),"Exceeds goal by â‚±",(t.amount-(a.target_amount-a.current_amount)).toFixed(2)]}):e.jsxs("span",{className:"text-success",children:[e.jsx("i",{className:"fas fa-check mr-1"}),"Will contribute â‚±",t.amount.toFixed(2)]})})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("i",{className:"fas fa-flag fa-2x text-gray-300"})})]})})}),n&&e.jsx("div",{className:"card bg-white border-left-primary shadow mb-4",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsxs("div",{className:"text-xs font-weight-bold text-primary text-uppercase mb-1",children:["Assigned Budget",e.jsxs("span",{className:"badge badge-primary ml-2",children:[e.jsx("i",{className:"fas fa-wallet mr-1"})," Budget Tracking"]})]}),e.jsxs("div",{className:"h5 mb-0 font-weight-bold text-gray-800 d-flex align-items-center",children:[n.budget_name,n.category_name&&e.jsxs("span",{className:"badge badge-secondary ml-2",children:[e.jsx("i",{className:"fas fa-tag mr-1"})," ",n.category_name]})]}),e.jsxs("div",{className:"mt-3 mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsx("span",{className:"text-sm font-weight-medium text-gray-700",children:"Budget Utilization (After Transaction)"}),e.jsxs("span",{className:`font-weight-bold text-sm ${((n.spent||0)+t.amount)/n.amount>=.9?"text-danger":((n.spent||0)+t.amount)/n.amount>=.8?"text-warning":((n.spent||0)+t.amount)/n.amount>=.6?"text-info":"text-success"}`,children:[(((n.spent||0)+t.amount)/n.amount*100).toFixed(1),"%"]})]}),e.jsxs("div",{className:"position-relative",children:[e.jsxs("div",{className:"progress",style:{height:"12px",borderRadius:"6px",backgroundColor:"#f1f3f4",boxShadow:"inset 0 1px 2px rgba(0, 0, 0, 0.1)"},children:[e.jsx("div",{className:"progress-bar bg-secondary",style:{width:`${Math.min(100,(n.spent||0)/n.amount*100)}%`,borderRadius:"6px 0 0 6px"}}),e.jsx("div",{className:`progress-bar ${((n.spent||0)+t.amount)/n.amount>=.9?"bg-danger":((n.spent||0)+t.amount)/n.amount>=.8?"bg-warning":((n.spent||0)+t.amount)/n.amount>=.6?"bg-info":"bg-success"}`,role:"progressbar",style:{width:`${Math.min(100,t.amount/n.amount*100)}%`,borderRadius:"0 6px 6px 0",transition:"width 0.6s ease-in-out, background-color 0.3s ease",background:((n.spent||0)+t.amount)/n.amount>=.9?"linear-gradient(45deg, #dc3545, #c82333)":((n.spent||0)+t.amount)/n.amount>=.8?"linear-gradient(45deg, #ffc107, #e0a800)":((n.spent||0)+t.amount)/n.amount>=.6?"linear-gradient(45deg, #17a2b8, #138496)":"linear-gradient(45deg, #28a745, #218838)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},"aria-valuenow":Math.min(100,((n.spent||0)+t.amount)/n.amount*100),"aria-valuemin":0,"aria-valuemax":100,"aria-label":`Budget utilization after transaction: ${(((n.spent||0)+t.amount)/n.amount*100).toFixed(1)}% of ${n.budget_name}`,children:((n.spent||0)+t.amount)/n.amount>=.8&&e.jsx("div",{className:"progress-bar-striped progress-bar-animated",style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",background:"linear-gradient(45deg, rgba(255,255,255,0.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, transparent 75%, transparent)",backgroundSize:"1rem 1rem",animation:"progress-bar-stripes 1s linear infinite"}})})]}),e.jsxs("div",{className:"position-absolute d-flex justify-content-between w-100",style:{top:"-2px",fontSize:"10px"},children:[e.jsx("div",{className:"text-muted",style:{marginLeft:"60%"},children:"60%"}),e.jsx("div",{className:"text-muted",style:{marginRight:"20%"},children:"80%"})]})]}),e.jsxs("div",{className:"mt-2 d-flex align-items-center justify-content-between",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:`fas fa-circle mr-2 ${((n.spent||0)+t.amount)/n.amount>=.9?"text-danger":((n.spent||0)+t.amount)/n.amount>=.8?"text-warning":((n.spent||0)+t.amount)/n.amount>=.6?"text-info":"text-success"}`,style:{fontSize:"8px"}}),e.jsx("span",{className:"text-xs text-muted",children:((n.spent||0)+t.amount)/n.amount>=.9?"Critical: Near budget limit":((n.spent||0)+t.amount)/n.amount>=.8?"Warning: Approaching budget limit":((n.spent||0)+t.amount)/n.amount>=.6?"Moderate: Good progress":"Healthy: Well within budget"})]}),e.jsxs("span",{className:"text-xs font-weight-bold text-primary",children:["+â‚±",t.amount.toFixed(2)," this transaction"]})]})]}),e.jsxs("div",{className:"row text-sm mt-3",children:[e.jsxs("div",{className:"col-4 text-center",children:[e.jsxs("div",{className:"font-weight-bold text-gray-800",children:["â‚±",n.amount.toFixed(2)]}),e.jsx("div",{className:"text-muted",children:"Total Budget"})]}),e.jsxs("div",{className:"col-4 text-center",children:[e.jsxs("div",{className:"font-weight-bold text-gray-600",children:["â‚±",(n.spent||0).toFixed(2)]}),e.jsx("div",{className:"text-muted",children:"Current Spent"})]}),e.jsxs("div",{className:"col-4 text-center",children:[e.jsxs("div",{className:`font-weight-bold ${n.amount-(n.spent||0)-t.amount<0?"text-danger":"text-success"}`,children:["â‚±",(n.amount-(n.spent||0)-t.amount).toFixed(2)]}),e.jsx("div",{className:"text-muted",children:"After Transaction"})]})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("i",{className:"fas fa-wallet fa-2x text-gray-300"})})]})})}),e.jsx("div",{className:"card bg-light mb-4",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"text-xs font-weight-bold text-primary text-uppercase mb-1",children:"Description"}),e.jsx("p",{className:"mb-0",children:t.description})]})}),e.jsxs("div",{className:"text-center mt-4",children:[e.jsxs("button",{onClick:()=>D("form"),className:"inline-flex items-center justify-center px-3 py-2 md:px-4 md:py-2 bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 text-xs md:text-sm font-medium rounded shadow-sm transition-colors mr-2",children:[e.jsx("i",{className:"fas fa-arrow-left text-xs mr-1"}),e.jsx("span",{className:"d-none d-md-inline",children:"Back to Edit"}),e.jsx("span",{className:"d-inline d-md-none",children:"Back"})]}),e.jsxs("button",{onClick:W,disabled:S,className:"inline-flex items-center justify-center px-3 py-2 md:px-4 md:py-2 bg-[#1cc88a] hover:bg-[#17a673] text-white text-xs md:text-sm font-medium rounded shadow-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("i",{className:`${S?"fas fa-spinner fa-spin":"fas fa-check"} text-xs mr-1`}),S?"Saving...":"Save Transaction"]})]})]})]})})})]})}return e.jsxs("div",{className:"container-fluid animate__animated animate__fadeIn",children:[e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-bold text-gray-800",children:"Add Transaction"}),e.jsx(T,{to:"/transactions",className:"w-9 h-9 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 flex items-center justify-center shadow-sm transition-all active:scale-95","aria-label":"Back to transactions",children:e.jsx("i",{className:"fas fa-arrow-left text-xs"})})]})}),e.jsxs("div",{className:"d-none d-md-flex align-items-center justify-content-between mb-2 mb-md-4 flex-wrap",children:[e.jsxs("h1",{className:"h5 h-md-3 mb-1 mb-md-0 text-gray-800",style:{fontSize:"0.95rem"},children:[e.jsx("span",{className:"d-none d-md-inline",children:"Add Transaction"}),e.jsx("span",{className:"d-inline d-md-none",children:"Add"})]}),e.jsxs(T,{to:"/transactions",className:"inline-flex items-center justify-center px-2 py-1.5 md:px-3 md:py-2 bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 text-xs md:text-sm font-medium rounded shadow-sm transition-colors",children:[e.jsx("i",{className:"fas fa-arrow-left text-xs mr-1"}),e.jsx("span",{className:"d-none d-md-inline",children:"Back to Transactions"}),e.jsx("span",{className:"d-inline d-md-none",children:"Back"})]})]}),A&&$&&e.jsx("div",{className:"tip-box light",style:{position:"absolute",top:`${$.top}px`,left:`${$.left}px`,transform:"translateX(-50%)",zIndex:1e3,background:"white",padding:"12px 15px",borderRadius:"8px",boxShadow:"0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15)",maxWidth:"300px",border:"1px solid rgba(0, 0, 0, 0.05)"},children:A&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-weight-bold mb-2",children:Y[A].title}),e.jsx("p",{className:"mb-0",children:Y[A].description})]})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-8 mx-auto",children:e.jsxs("div",{className:"card shadow mb-4 transaction-form",children:[e.jsx("div",{className:"card-header py-3",children:e.jsxs("h6",{className:"m-0 font-weight-bold text-primary",children:[e.jsx("span",{className:"d-none d-md-inline",children:"Transaction Details"}),e.jsx("span",{className:"d-inline d-md-none",children:"Details"}),e.jsx("i",{className:"fas fa-info-circle ml-1 text-gray-400",style:{cursor:"pointer"},onClick:s=>O("transaction-details",s)})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:ce,children:[e.jsxs("div",{className:"form-group mb-4",children:[e.jsxs("label",{className:"font-weight-bold text-gray-800",children:["Transaction Type ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 mb-3 mb-md-0",children:e.jsx("div",{className:`card ${t.type==="income"?"bg-success text-white":"bg-light"} py-3 text-center shadow-sm`,style:{cursor:"pointer"},onClick:()=>{m(s=>({...s,type:"income",category_id:"",budget_id:"",goal_id:""})),j(null),v(null),_(null)},children:e.jsxs("div",{className:"card-body transaction-type-card",children:[e.jsx("i",{className:"fas fa-plus-circle fa-2x mb-2"}),e.jsx("h5",{className:"mb-0",children:"Income"})]})})}),e.jsx("div",{className:"col-md-4 mb-3 mb-md-0",children:e.jsx("div",{className:`card ${t.type==="expense"?"bg-danger text-white":"bg-light"} py-3 text-center shadow-sm`,style:{cursor:"pointer"},onClick:()=>{m(s=>({...s,type:"expense",category_id:"",budget_id:"",goal_id:""})),j(null),v(null),_(null)},children:e.jsxs("div",{className:"card-body transaction-type-card",children:[e.jsx("i",{className:"fas fa-minus-circle fa-2x mb-2"}),e.jsx("h5",{className:"mb-0",children:"Expense"})]})})}),e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:`card ${t.type==="contribution"?"bg-info text-white":"bg-light"} py-3 text-center shadow-sm`,style:{cursor:"pointer"},onClick:()=>{m(s=>({...s,type:"contribution",category_id:"",budget_id:"",goal_id:""})),j(null),v(null),_(null),setTimeout(()=>{const s=l.expenseCategories.find(i=>i.category_name==="Contribution");s&&(j(s),m(i=>({...i,category_id:s.id})))},100)},children:e.jsxs("div",{className:"card-body transaction-type-card",children:[e.jsx("i",{className:"fas fa-flag fa-2x mb-2"}),e.jsx("h5",{className:"mb-0",children:"Contribute"})]})})})]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(fe,{value:t.amount,onChange:ae,currency:"PHP",label:"Amount",placeholder:"0.00",required:!0,min:.01,max:9999999999999e-2,className:"mb-3"})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"date",className:"font-weight-bold text-gray-800",children:["Date ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"date",id:"date",name:"date",value:t.date,onChange:U,className:"form-control form-control-user",required:!0}),e.jsx("small",{className:"form-text text-muted",children:"When did this transaction occur?"})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(ye,{selectedAccountId:t.account_id,onAccountSelect:se,required:!0,label:"Account",showBalance:!0,showAccountType:!0,autoSelectDefault:!0,className:"mb-3"})}),e.jsxs("div",{className:"col-md-6",children:[t.type!=="contribution"?e.jsx(je,{selectedCategoryId:t.category_id,onCategorySelect:ne,transactionType:t.type,incomeCategories:l.incomeCategories,expenseCategories:l.expenseCategories,required:!0,label:"Category",showIcons:!0}):e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"font-weight-bold text-gray-800",children:["Category ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("div",{className:"form-control d-flex align-items-center bg-contribute text-white",style:{border:"1px solid #17a2b8"},children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"fas fa-flag mr-2"}),e.jsx("span",{className:"font-weight-bold",children:"Contribution"}),e.jsxs("span",{className:"badge badge-light text-contribute ml-2",children:[e.jsx("i",{className:"fas fa-magic mr-1"}),"Auto-selected"]})]})})]}),t.type==="contribution"&&e.jsx("div",{className:"card mt-3 border-left-contribute shadow-sm mb-4",children:e.jsx("div",{className:"card-body py-3",children:e.jsx("div",{className:"row no-gutters align-items-center",children:e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"d-flex align-items-center mb-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-weight-bold text-contribute",children:[e.jsx("i",{className:"fas fa-flag mr-2"}),"Contribution Transaction"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Category: Contribution â€¢ Goal Contribution"})]})}),r&&t.amount>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsx("span",{className:"text-xs font-weight-bold text-gray-600 text-uppercase",children:"Goal Progress Impact"}),e.jsxs("span",{className:"font-weight-bold text-contribute",children:["+â‚±",t.amount.toFixed(2)]})]}),e.jsx("div",{className:"mb-2",children:e.jsx("div",{className:"progress",style:{height:"6px"},children:e.jsx("div",{className:"progress-bar bg-contribute",role:"progressbar",style:{width:`${r.target_amount>0?Math.min(100,(r.current_amount+t.amount)/r.target_amount*100):0}%`}})})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:[r.target_amount>0?((r.current_amount+t.amount)/r.target_amount*100).toFixed(1):0,"% of ",r.goal_name]}),e.jsxs("span",{className:"text-xs text-gray-600",children:["â‚±",Math.max(0,r.target_amount-r.current_amount-t.amount).toFixed(2)," remaining"]})]})]}),(!r||t.amount<=0)&&e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("span",{className:"text-xs font-weight-bold text-gray-600 text-uppercase",children:"Category & Goal"}),e.jsx("span",{className:"text-xs text-contribute font-weight-bold",children:"Auto-assigned"})]})]})})})})]})]}),t.type==="expense"&&e.jsxs(e.Fragment,{children:[console.log("ðŸ“„ AddTransaction: Rendering BudgetSelector with props:",{selectedBudgetId:t.budget_id,selectedCategoryId:t.category_id,transactionAmount:t.amount||0,transactionType:t.type,selectedCategory:F}),e.jsx(he,{selectedBudgetId:t.budget_id,selectedCategoryId:t.category_id,transactionAmount:t.amount||0,transactionType:t.type,onBudgetSelect:ie,onCategoryAutoSelect:re,className:"mb-4"})]}),ee===!1?e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"font-weight-bold text-gray-800",children:t.type==="contribution"?"Goal *":"Goal Assignment (Optional)"}),e.jsx("div",{className:"card border-dashed border-primary bg-light text-center py-4",children:e.jsxs("div",{className:"card-body",children:[e.jsx("i",{className:"fas fa-flag fa-3x text-primary mb-3"}),e.jsx("h5",{className:"text-primary mb-2",children:"No Goals Available"}),e.jsx("p",{className:"text-muted mb-3",children:t.type==="contribution"?"You need to create a goal before making a contribution transaction.":"Create your first financial goal to track your progress."}),e.jsxs("button",{type:"button",className:"inline-flex items-center justify-center px-4 py-2.5 md:px-6 md:py-3 bg-[#4e73df] hover:bg-[#2e59d9] text-white text-sm md:text-base font-medium rounded shadow-sm transition-colors",onClick:()=>k("/goals/create"),children:[e.jsx("i",{className:"fas fa-plus text-xs mr-2"}),"Create Your First Goal"]}),t.type==="contribution"&&e.jsx("div",{className:"mt-3",children:e.jsxs("small",{className:"text-danger",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-1"}),"Goal creation is required for contribution transactions"]})})]})})]}):e.jsx(Ne,{selectedGoal:r,onGoalSelect:oe,className:`mb-4 ${t.type==="contribution"&&!r?"is-invalid":""}`,required:t.type==="contribution",label:t.type==="contribution"?"Goal *":"Goal Assignment (Optional)",isContributionType:t.type==="contribution",showValidationError:t.type==="contribution"&&!r,onGoalsLoaded:te,validateFamilyGoalAccess:!0}),r&&e.jsx("div",{className:"card bg-white shadow mb-4",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"text-xs font-weight-bold text-primary text-uppercase mb-1",children:"Associated Goal"}),e.jsxs("div",{className:"h5 mb-0 font-weight-bold text-primary d-flex align-items-center",children:[r.goal_name,r.is_family_goal?e.jsxs("span",{className:"badge badge-info ml-2",children:[e.jsx("i",{className:"fas fa-users mr-1"})," Family"]}):e.jsxs("span",{className:"badge badge-secondary ml-2",children:[e.jsx("i",{className:"fas fa-user mr-1"})," Personal"]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"d-flex justify-content-between text-sm mb-1",children:[e.jsx("span",{children:"Goal Progress"}),e.jsxs("span",{children:[r.target_amount>0?(r.current_amount/r.target_amount*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"progress",style:{height:"8px"},children:e.jsx("div",{className:`progress-bar ${r.target_amount>0&&r.current_amount/r.target_amount*100>=90?"bg-success":r.target_amount>0&&r.current_amount/r.target_amount*100>=75?"bg-info":r.target_amount>0&&r.current_amount/r.target_amount*100>=50?"bg-warning":"bg-danger"}`,role:"progressbar",style:{width:`${r.target_amount>0?Math.min(100,r.current_amount/r.target_amount*100):0}%`},"aria-valuenow":r.target_amount>0?Math.min(100,r.current_amount/r.target_amount*100):0,"aria-valuemin":0,"aria-valuemax":100})})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["â‚±",(r.target_amount-r.current_amount).toFixed(2)," remaining"]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("i",{className:"fas fa-flag fa-2x text-gray-300"})})]})})}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{htmlFor:"description",className:"font-weight-bold text-gray-800",children:["Description ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("textarea",{id:"description",name:"description",value:t.description,onChange:U,className:"form-control",rows:3,placeholder:"Enter a description for this transaction",required:!0}),e.jsx("small",{className:"form-text text-muted",children:"Briefly describe this transaction"})]}),e.jsx("hr",{className:"my-4"}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{type:"submit",className:"inline-flex items-center justify-center px-3 py-2 md:px-4 md:py-2 bg-[#4e73df] hover:bg-[#2e59d9] text-white text-xs md:text-sm font-medium rounded shadow-sm transition-colors",children:[e.jsx("i",{className:"fas fa-arrow-right text-xs mr-1"}),e.jsx("span",{className:"d-none d-md-inline",children:"Continue to Review"}),e.jsx("span",{className:"d-inline d-md-none",children:"Review"})]})})]})})]})}),e.jsx("div",{className:"col-lg-4 d-none d-lg-block",children:e.jsxs("div",{className:"card shadow mb-4",children:[e.jsx("div",{className:"card-header py-3",children:e.jsxs("h6",{className:"m-0 font-weight-bold text-primary",children:["Transaction Tips",e.jsx("i",{className:"fas fa-info-circle ml-1 text-gray-400",style:{cursor:"pointer"},onClick:s=>O("transaction-tips",s)})]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"rounded-circle p-2 mr-3",style:{backgroundColor:"rgba(78, 115, 223, 0.2)"},children:e.jsx("i",{className:"fas fa-tag text-primary"})}),e.jsx("p",{className:"font-weight-bold mb-0",children:"Categorize Properly"})]}),e.jsx("p",{className:"text-sm text-muted ml-5",children:"Accurate categories help track your spending"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"rounded-circle p-2 mr-3",style:{backgroundColor:"rgba(28, 200, 138, 0.2)"},children:e.jsx("i",{className:"fas fa-calendar-alt text-success"})}),e.jsx("p",{className:"font-weight-bold mb-0",children:"Add Promptly"})]}),e.jsx("p",{className:"text-sm text-muted ml-5",children:"Record transactions as soon as they happen"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"rounded-circle p-2 mr-3",style:{backgroundColor:"rgba(246, 194, 62, 0.2)"},children:e.jsx("i",{className:"fas fa-lightbulb text-warning"})}),e.jsx("p",{className:"font-weight-bold mb-0",children:"Be Specific"})]}),e.jsx("p",{className:"text-sm text-muted ml-5",children:"Add detailed descriptions for future reference"})]})]})]})})]})]})},ze=()=>e.jsx(ve,{fallback:e.jsx("div",{className:"container-fluid",children:e.jsx("div",{className:"text-center my-5",children:e.jsxs("div",{className:"alert alert-danger",children:[e.jsx("h5",{children:"Transaction Form Error"}),e.jsx("p",{children:"There was an error loading the transaction form. Please try refreshing the page."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center justify-center px-4 py-2 bg-[#4e73df] hover:bg-[#2e59d9] text-white text-sm font-medium rounded shadow-sm transition-colors",children:"Refresh Page"})]})})}),children:e.jsx(we,{})});export{ze as default};
