import{j as e}from"./ui-vendor-Cn1Vfl4w.js";import{i as je,u as Ne,r as i,L as m}from"./react-vendor-D4A9EtXC.js";import{u as ve,b as we,f as k,d as D,s as x}from"./index-BbApZ7g3.js";import{T as se}from"./transactions-CJCWbHAc.js";import{E as ne}from"./enhancedTransactionService-DaGM5j0a.js";import{d as $,H as F}from"./chart-vendor-B0c7K_uV.js";import"./transactionService-B7dXImam.js";const Ae=()=>{const{id:h}=je(),R=Ne(),{user:o}=ve(),{showSuccessToast:G,showErrorToast:H}=we(),[t,ie]=i.useState(null),[v,re]=i.useState([]),[L,z]=i.useState(!0),[A,oe]=i.useState(!1),[M,le]=i.useState(!1),[O,ce]=i.useState({income:[],expense:[]}),[P,de]=i.useState([]),[V,me]=i.useState([]),[f,X]=i.useState(null),[B,Y]=i.useState(null),J=i.useRef(null),K=i.useRef(null),[w,xe]=i.useState(null),[p,he]=i.useState(null),[fe,Q]=i.useState(!1),[U,W]=i.useState(!1),[C,Z]=i.useState("breakdown"),ee=async()=>{if(!h||!o){z(!1);return}try{z(!0);const a=await ne.fetchTransactionForEdit(h,o.id);if(!a.success)throw new Error(a.error||"Failed to fetch transaction");const s=a.data;if(!s){z(!1);return}ie(s);const{data:l,error:n}=await x.from("accounts").select("*").eq("user_id",o.id);if(n)throw n;de(l||[]);const{data:_,error:g}=await x.from("income_categories").select("*").eq("user_id",o.id);if(g)throw g;const{data:d,error:b}=await x.from("expense_categories").select("*").eq("user_id",o.id);if(b)throw b;ce({income:_||[],expense:d||[]});const{data:y,error:r}=await x.from("goals").select("*").eq("user_id",o.id);if(r)throw r;if(me(y||[]),s.category_id){const N=await ne.fetchTransactionsWithMapping(o.id,{type:s.type,category_id:s.category_id,limit:5});if(N.success){const E=(N.data||[]).filter(ye=>ye.id!==h);re(E)}}pe(s,{accounts:l||[],incomeCategories:_||[],expenseCategories:d||[]}),oe(!0)}catch(a){console.error("Error fetching transaction data:",a),H(a.message||"Failed to load transaction data")}finally{z(!1)}},ge=()=>{if(!o||!h||M)return;const a=x.channel(`transaction-${h}`).on("postgres_changes",{event:"*",schema:"public",table:"transactions",filter:`id=eq.${h}`},s=>{if(s.eventType==="DELETE"){G("This transaction has been deleted"),R("/transactions");return}ee()}).subscribe();return le(!0),()=>{a.unsubscribe()}};i.useEffect(()=>{o?ee():R("/auth/login")},[h,o]),i.useEffect(()=>{if(o&&!L&&!M)return ge()},[o,L,M]);const pe=(a,s)=>{const l=a.category_id?s.incomeCategories.find(r=>r.id===a.category_id)||s.expenseCategories.find(r=>r.id===a.category_id):null,n=a.type==="contribution"?a.goal_id?"Goal Contribution":"Contribution":l?l.category_name:"Uncategorized",g=v.concat(a).reduce((r,N)=>r+N.amount,0);a.amount/g*100,xe({chart:{type:"pie",height:250,backgroundColor:"transparent",style:{fontFamily:"'Nunito', 'Segoe UI', Roboto, sans-serif"}},title:{text:null},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b> (${point.y:.2f})"},accessibility:{point:{valueSuffix:"%"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %",style:{fontWeight:"normal"},connectorWidth:0,distance:15},showInLegend:!1,size:"85%"}},legend:{enabled:!1},series:[{name:`${a.type==="income"?"Income":"Spending"} in ${n}`,colorByPoint:!0,data:[{name:"This Transaction",y:a.amount,sliced:!0,selected:!0},{name:"Other Transactions",y:g-a.amount}]}],credits:{enabled:!1}});const d=v,b=d.length>0?d.reduce((r,N)=>r+N.amount,0)/d.length:0,y=d.length>0?Math.max(...d.map(r=>r.amount)):a.amount;he({chart:{type:"column",height:250,backgroundColor:"transparent",style:{fontFamily:"'Nunito', 'Segoe UI', Roboto, sans-serif"}},title:{text:null},xAxis:{categories:["This Transaction","Category Average","Category Highest"],crosshair:!0},yAxis:{min:0,title:{text:null},labels:{format:"${value}"},gridLineColor:"#eaecf4",gridLineDashStyle:"dash"},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">{series.name}: </td><td style="padding:0"><b>${point.y:.2f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0},plotOptions:{column:{pointPadding:.2,borderWidth:0,colorByPoint:!0,colors:[a.type==="income"?"#1cc88a":"#e74a3b","#4e73df","#f6c23e"]}},series:[{name:"Amount",showInLegend:!1,data:[{y:a.amount,color:a.type==="income"?"#1cc88a":"#e74a3b"},{y:b,color:"#4e73df"},{y,color:"#f6c23e"}]}],credits:{enabled:!1}})},ae=()=>{Q(!0)},I=()=>{Q(!1)},ue=async()=>{if(!(!t||!o))try{W(!0);const a=se.extractTransactionAuditData(t,P?.find(n=>n.id===t.account_id),O.income?.find(n=>n.id===t.category_id)||O.expense?.find(n=>n.id===t.category_id),V?.find(n=>n.id===t.goal_id)),s=t.type==="income"?-t.amount:t.amount,{error:l}=await x.from("transactions").delete().eq("id",t.id);if(l)throw l;se.logTransactionDeleted(o.id,a,"User deleted transaction",navigator.userAgent).catch(n=>{console.error("Failed to log transaction deletion to audit:",n)}),G("Transaction deleted successfully!"),I(),R("/transactions"),be(t.account_id,s,t.amount,t.goal_id)}catch(a){console.error("Error deleting transaction:",a),H(a.message||"Failed to delete transaction"),W(!1),I()}},be=async(a,s,l,n)=>{try{const{error:_}=await x.rpc("update_account_balance",{p_account_id:a,p_amount_change:s});if(_){const{data:g,error:d}=await x.from("accounts").select("balance").eq("id",a).single();if(d)throw d;const b=g.balance+s,{error:y}=await x.from("accounts").update({balance:b}).eq("id",a);if(y)throw y}if(n){const g=-l,{error:d}=await x.rpc("update_goal_progress",{p_goal_id:n,p_amount:g});if(d){const{data:b,error:y}=await x.from("goals").select("current_amount, target_amount").eq("id",n).single();if(y)throw y;const r=Math.max(0,b.current_amount+g),N=r>=b.target_amount?"completed":"in_progress",{error:E}=await x.from("goals").update({current_amount:r,status:N}).eq("id",n);if(E)throw E}}}catch(_){console.error("Error updating related data after transaction deletion:",_)}finally{W(!1)}},j=(a,s)=>{if(f===a)X(null),Y(null);else if(X(a),s){const l=s.currentTarget.getBoundingClientRect();Y({top:l.bottom+window.scrollY,left:l.left+l.width/2+window.scrollX})}};if(L)return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"block md:hidden py-12 animate__animated animate__fadeIn",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"mt-3 text-xs text-gray-500 font-medium",children:"Loading transaction details..."})]})}),e.jsxs("div",{className:"text-center my-5 hidden md:block",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}),e.jsx("p",{className:"mt-3 text-gray-700",children:"Loading transaction details..."})]})]});if(!t)return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"block md:hidden py-12 animate__animated animate__fadeIn",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center px-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-amber-100 flex items-center justify-center mb-4",children:e.jsx("i",{className:"fas fa-exclamation-triangle text-amber-500 text-2xl"})}),e.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-2",children:"Transaction not found"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"The transaction you're looking for does not exist or has been deleted."}),e.jsxs(m,{to:"/transactions",className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-500 text-white text-sm font-medium rounded-lg hover:bg-indigo-600 transition-colors",children:[e.jsx("i",{className:"fas fa-arrow-left text-xs"}),"Back to Transactions"]})]})}),e.jsxs("div",{className:"text-center my-5 animate__animated animate__fadeIn hidden md:block",children:[e.jsx("div",{className:"error-icon mb-4",children:e.jsx("i",{className:"fas fa-exclamation-triangle fa-4x text-warning"})}),e.jsx("h1",{className:"h3 mb-3 font-weight-bold text-gray-800",children:"Transaction not found"}),e.jsx("p",{className:"mb-4",children:"The transaction you're looking for does not exist or has been deleted."}),e.jsxs(m,{to:"/transactions",className:"btn btn-primary",children:[e.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Transactions"]})]})]});const q=t.category_id?O[t.type==="income"?"income":"expense"].find(a=>a.id===t.category_id):null,S=t.type==="contribution"?t.goal_id?"Goal Contribution":"Contribution":q?q.category_name:"Uncategorized",u=P.find(a=>a.id===t.account_id),c=t.goal_id?V.find(a=>a.id===t.goal_id):null,T=t.type==="income"?"success":"danger",te=t.type==="income"?"arrow-up":"arrow-down";return t.type,t.type,e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-bold text-gray-800",children:"Transaction Details"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:ae,className:"w-9 h-9 rounded-full bg-rose-500 hover:bg-rose-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95","aria-label":"Delete transaction",children:e.jsx("i",{className:"fas fa-trash text-xs"})}),e.jsx(m,{to:`/transactions/${h}/edit`,className:"w-9 h-9 rounded-full bg-indigo-500 hover:bg-indigo-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95","aria-label":"Edit transaction",children:e.jsx("i",{className:"fas fa-edit text-xs"})}),e.jsx(m,{to:"/transactions",className:"w-9 h-9 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 flex items-center justify-center shadow-sm transition-all active:scale-95","aria-label":"Back to transactions",children:e.jsx("i",{className:"fas fa-arrow-left text-xs"})})]})]})}),e.jsxs("div",{className:"block md:hidden mb-4",children:[e.jsxs("div",{className:`bg-gradient-to-br ${t.type==="income"?"from-emerald-500 via-teal-500 to-cyan-500":t.type==="contribution"?"from-blue-500 via-indigo-500 to-purple-500":"from-rose-500 via-red-500 to-orange-500"} rounded-2xl p-4 shadow-lg`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-semibold ${t.type==="income"||t.type==="contribution","bg-white/20 text-white"}`,children:t.type==="income"?"Income":t.type==="contribution"?"Contribution":"Expense"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:`fas fa-${t.type==="income"?"arrow-up":t.type==="contribution"?"flag":"arrow-down"} text-white text-sm`})})]}),e.jsx("div",{className:"text-white text-2xl font-bold mb-1",children:k(t.amount)}),e.jsx("div",{className:"text-white/70 text-xs",children:D(t.date)})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3",children:[e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-blue-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-wallet text-blue-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Account"}),e.jsx("p",{className:"text-[11px] font-bold text-gray-800 truncate",children:u?.account_name||"Unknown"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-amber-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-tag text-amber-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Category"}),e.jsx("p",{className:"text-[11px] font-bold text-gray-800 truncate",children:S})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-indigo-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-calendar text-indigo-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Date"}),e.jsx("p",{className:"text-[11px] font-bold text-gray-800 truncate",children:new Date(t.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]})]}),t.description&&t.description.trim()&&e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100 mt-2",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide mb-1",children:"Description"}),e.jsx("p",{className:"text-xs text-gray-700",children:t.description})]}),c&&e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-emerald-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-bullseye text-emerald-500 text-xs"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Related Goal"}),e.jsx("p",{className:"text-xs font-bold text-gray-800 truncate",children:c.goal_name})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5 mb-1",children:e.jsx("div",{className:"bg-emerald-500 h-1.5 rounded-full transition-all duration-500",style:{width:`${c.target_amount>0?Math.min(100,c.current_amount/c.target_amount*100):0}%`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-[10px] text-gray-500",children:[(c.current_amount/c.target_amount*100).toFixed(1),"% complete"]}),e.jsx(m,{to:`/goals/${t.goal_id}`,className:"text-[10px] text-indigo-500 font-medium",children:"View Goal →"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden mt-3",children:[e.jsxs("div",{className:"flex bg-slate-50",children:[e.jsxs("button",{onClick:()=>Z("breakdown"),className:`flex-1 py-3.5 text-sm font-semibold transition-all relative ${C==="breakdown"?"text-indigo-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx("i",{className:"fas fa-chart-pie mr-2 text-xs"}),"Breakdown",C==="breakdown"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-600"})]}),e.jsxs("button",{onClick:()=>Z("impact"),className:`flex-1 py-3.5 text-sm font-semibold transition-all relative ${C==="impact"?"text-indigo-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx("i",{className:"fas fa-chart-bar mr-2 text-xs"}),"Impact",C==="impact"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-600"})]})]}),e.jsx("div",{className:"p-4",children:C==="breakdown"?A&&w?e.jsx("div",{className:"animate__animated animate__fadeIn",children:e.jsx($,{highcharts:F,options:{...w,chart:{...w.chart,height:250},plotOptions:{...w.plotOptions,pie:{...w.plotOptions?.pie,dataLabels:{enabled:!1},showInLegend:!0,size:"70%",innerSize:"50%",center:["50%","40%"]}},legend:{enabled:!0,layout:"horizontal",align:"center",verticalAlign:"bottom",itemStyle:{fontSize:"11px",fontWeight:"normal",color:"#374151"},symbolRadius:2,symbolHeight:10,symbolWidth:10,itemMarginTop:8,itemMarginBottom:4,padding:0},title:{text:null}},ref:J})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"fas fa-chart-pie text-gray-400 text-2xl"})}),e.jsx("p",{className:"text-sm text-gray-500",children:"No category data available"})]}):A&&p?e.jsx("div",{className:"animate__animated animate__fadeIn",children:e.jsx($,{highcharts:F,options:{...p,chart:{...p.chart,height:250},xAxis:{...p.xAxis,labels:{...p.xAxis?.labels,style:{fontSize:"10px",color:"#6b7280"}}},yAxis:{...p.yAxis,labels:{...p.yAxis?.labels,style:{fontSize:"10px",color:"#6b7280"}}}},ref:K})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"fas fa-chart-bar text-gray-400 text-2xl"})}),e.jsx("p",{className:"text-sm text-gray-500",children:"No impact data available"})]})})]}),v.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden mt-3 mb-4",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:e.jsxs("h6",{className:"text-xs font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-list text-indigo-500 text-[10px]"}),"Related Transactions",e.jsx("span",{className:"bg-indigo-100 text-indigo-600 px-1.5 py-0.5 rounded-full text-[9px]",children:v.length})]})}),e.jsx("div",{className:"divide-y divide-gray-100",children:v.slice(0,3).map(a=>e.jsxs(m,{to:`/transactions/${a.id}`,className:"flex items-center justify-between px-4 py-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${a.type==="income"?"bg-emerald-100":"bg-rose-100"}`,children:e.jsx("i",{className:`fas fa-${a.type==="income"?"arrow-up":"arrow-down"} text-xs ${a.type==="income"?"text-emerald-500":"text-rose-500"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-800",children:k(a.amount)}),e.jsx("p",{className:"text-[10px] text-gray-500",children:D(a.date)})]})]}),e.jsx("i",{className:"fas fa-chevron-right text-gray-400 text-[10px]"})]},a.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100 mb-4",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide mb-1",children:"Transaction ID"}),e.jsx("p",{className:"text-[10px] text-gray-600 font-mono truncate",children:t.id})]})]}),e.jsxs("div",{className:"d-none d-md-flex align-items-center justify-content-between mb-4 animate__animated animate__fadeInDown",children:[e.jsx("h1",{className:"h3 mb-0 text-gray-800",children:"Transaction Details"}),e.jsxs("div",{className:"d-flex",children:[e.jsxs("button",{onClick:ae,className:"btn btn-primary btn-sm shadow-sm mr-2",style:{backgroundColor:"#e74a3b",borderColor:"#e74a3b"},children:[e.jsx("i",{className:"fas fa-trash fa-sm mr-2"})," Delete Transaction"]}),e.jsxs(m,{to:`/transactions/${h}/edit`,className:"btn btn-primary btn-sm mr-2 shadow-sm",children:[e.jsx("i",{className:"fas fa-edit fa-sm",style:{marginLeft:"0.125rem",marginRight:"0.5rem"}})," Edit Transaction"]}),e.jsxs(m,{to:"/transactions",className:"btn btn-sm btn-secondary shadow-sm",children:[e.jsx("i",{className:"fas fa-arrow-left fa-sm mr-2"})," Back to Transactions"]})]})]}),e.jsxs("div",{className:"row d-none d-md-flex",children:[e.jsx("div",{className:"col-xl-4 col-md-6 col-6 mb-3 mb-md-4 animate__animated animate__fadeIn",style:{animationDelay:"0.1s"},children:e.jsx("div",{className:`card border-left-${T} shadow h-100 py-2`,children:e.jsx("div",{className:"card-body p-3",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsxs("div",{className:`text-xs font-weight-bold text-${T} text-uppercase mb-1 d-flex align-items-center`,style:{fontSize:"0.6rem"},children:[e.jsxs("span",{className:"d-none d-md-inline",children:[t.type==="income"?"Income":t.type==="contribution"?"Contribution":"Expense"," Amount"]}),e.jsx("span",{className:"d-inline d-md-none",children:"Amt"}),e.jsx("div",{className:"ml-2 position-relative d-none d-md-block",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:a=>j("amountInfo",a),"aria-label":"Amount information"})})]}),e.jsx("div",{className:"h5 h6-mobile mb-0 font-weight-bold text-gray-800",children:k(t.amount)})]}),e.jsx("div",{className:"col-auto d-none d-md-block",children:e.jsx("i",{className:`fas fa-${te} fa-2x text-gray-300`})})]})})})}),e.jsx("div",{className:"col-xl-4 col-md-6 col-6 mb-3 mb-md-4 animate__animated animate__fadeIn",style:{animationDelay:"0.2s"},children:e.jsx("div",{className:"card border-left-info shadow h-100 py-2",children:e.jsx("div",{className:"card-body p-3",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsxs("div",{className:"text-xs font-weight-bold text-info text-uppercase mb-1 d-flex align-items-center",style:{fontSize:"0.6rem"},children:[e.jsx("span",{className:"d-none d-md-inline",children:"Category"}),e.jsx("span",{className:"d-inline d-md-none",children:"Cat"}),e.jsx("div",{className:"ml-2 position-relative d-none d-md-block",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:a=>j("categoryInfo",a),"aria-label":"Category information"})})]}),e.jsxs("div",{className:"h5 h6-mobile mb-0 font-weight-bold text-gray-800",children:[q||t.type==="contribution"?e.jsx("span",{className:"d-none d-md-inline",children:S}):e.jsxs("span",{className:"text-warning",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-1 d-none d-md-inline"}),e.jsx("span",{className:"d-none d-md-inline",children:"Uncategorized"}),e.jsx("span",{className:"d-inline d-md-none",children:"Uncat."})]}),e.jsx("span",{className:"d-inline d-md-none",children:S.length>12?S.substring(0,12)+"...":S})]})]}),e.jsx("div",{className:"col-auto d-none d-md-block",children:e.jsx("i",{className:"fas fa-tag fa-2x text-gray-300"})})]})})})}),e.jsx("div",{className:"col-xl-4 col-md-6 col-12 mb-3 mb-md-4 animate__animated animate__fadeIn",style:{animationDelay:"0.3s"},children:e.jsx("div",{className:"card border-left-primary shadow h-100 py-2",children:e.jsx("div",{className:"card-body p-3",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsxs("div",{className:"text-xs font-weight-bold text-primary text-uppercase mb-1 d-flex align-items-center",style:{fontSize:"0.6rem"},children:[e.jsx("span",{className:"d-none d-md-inline",children:"Account"}),e.jsx("span",{className:"d-inline d-md-none",children:"Acct"}),e.jsx("div",{className:"ml-2 position-relative d-none d-md-block",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:a=>j("accountInfo",a),"aria-label":"Account information"})})]}),e.jsxs("div",{className:"h5 h6-mobile mb-0 font-weight-bold text-gray-800",children:[e.jsx("span",{className:"d-none d-md-inline",children:u?u.account_name:"Unknown Account"}),e.jsx("span",{className:"d-inline d-md-none",children:u?u.account_name.length>15?u.account_name.substring(0,15)+"...":u.account_name:"Unknown"}),u&&e.jsx(m,{to:`/accounts/${u.id}`,className:"btn btn-sm btn-outline-primary ml-2 d-none d-md-inline-block",style:{fontSize:"0.65rem",padding:"0.15rem 0.4rem"},children:e.jsx("i",{className:"fas fa-external-link-alt",style:{fontSize:"0.6rem"}})})]})]}),e.jsx("div",{className:"col-auto d-none d-md-block",children:e.jsx("i",{className:"fas fa-wallet fa-2x text-gray-300"})})]})})})})]}),e.jsxs("div",{className:"row d-none d-md-flex",children:[e.jsx("div",{className:"col-lg-8 mb-4 animate__animated animate__fadeIn",style:{animationDelay:"0.4s"},children:e.jsxs("div",{className:"card shadow",children:[e.jsxs("div",{className:"card-header py-3 d-flex flex-row align-items-center justify-content-between",children:[e.jsxs("h6",{className:"m-0 font-weight-bold text-primary d-flex align-items-center",style:{fontSize:"0.75rem"},children:[e.jsx("span",{className:"d-none d-md-inline",children:"Transaction Details"}),e.jsx("span",{className:"d-inline d-md-none",children:"Details"}),e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:a=>j("transactionDetails",a),"aria-label":"Transaction details information"})})]}),e.jsx("div",{className:`badge ${t.type==="contribution"?"badge-info":`badge-${T}`}`,style:{fontSize:"0.6rem"},children:t.type})]}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"mb-2",children:[e.jsx("h4",{className:"small font-weight-bold",style:{fontSize:"0.7rem"},children:"Description"}),e.jsx("div",{className:"p-3 bg-light rounded",children:t.description&&t.description.trim()?e.jsx("p",{className:"mb-0 text-gray-700",style:{fontSize:"0.75rem"},children:t.description}):e.jsx("p",{className:"mb-0 text-muted font-italic",style:{fontSize:"0.7rem"},children:"No description provided"})})]})}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("h4",{className:"small font-weight-bold",style:{fontSize:"0.7rem"},children:"Transaction Date"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"p-2 rounded mr-2",style:{backgroundColor:"rgba(78, 115, 223, 0.15)"},children:e.jsx("i",{className:"fas fa-calendar text-primary",style:{fontSize:"0.75rem"}})}),e.jsx("span",{className:"text-gray-800",style:{fontSize:"0.75rem"},children:D(t.date)})]})]}),t.created_at&&e.jsxs("div",{className:"col-md-6",children:[e.jsx("h4",{className:"small font-weight-bold",style:{fontSize:"0.7rem"},children:"Created At"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"p-2 rounded mr-2",style:{backgroundColor:"rgba(246, 194, 62, 0.15)"},children:e.jsx("i",{className:"fas fa-clock text-warning",style:{fontSize:"0.75rem"}})}),e.jsx("span",{className:"text-gray-800",style:{fontSize:"0.75rem"},children:D(t.created_at)})]})]})]}),c&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"small font-weight-bold",style:{fontSize:"0.7rem"},children:"Related Goal"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"p-2 rounded mr-2",style:{backgroundColor:"rgba(28, 200, 138, 0.15)"},children:e.jsx("i",{className:"fas fa-bullseye text-success",style:{fontSize:"0.75rem"}})}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-800",style:{fontSize:"0.75rem"},children:["This transaction contributes to ",e.jsx("strong",{children:c.goal_name})]}),e.jsxs("div",{className:"small text-gray-600 mt-1",style:{fontSize:"0.65rem"},children:["Progress: ",k(c.current_amount)," of ",k(c.target_amount),"(",(c.current_amount/c.target_amount*100).toFixed(1),"%)"]}),e.jsx("div",{className:"mt-2",children:e.jsxs(m,{to:`/goals/${t.goal_id}`,className:"btn btn-sm btn-outline-primary",style:{fontSize:"0.65rem",padding:"0.2rem 0.4rem"},children:[e.jsx("i",{className:"fas fa-eye mr-1",style:{fontSize:"0.6rem"}}),e.jsx("span",{className:"d-none d-md-inline",children:"View Goal Details"}),e.jsx("span",{className:"d-inline d-md-none",children:"View Goal"})]})})]})]})]}),e.jsxs("div",{className:"mt-4 impact-analysis-section",children:[e.jsxs("h6",{className:"font-weight-bold text-primary mb-3 d-flex align-items-center",style:{fontSize:"0.75rem"},children:[e.jsx("span",{className:"d-none d-md-inline",children:"Transaction Impact Analysis"}),e.jsx("span",{className:"d-inline d-md-none",children:"Impact"}),e.jsx("div",{className:"ml-2 position-relative d-none d-md-block",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:a=>j("impactAnalysis",a),"aria-label":"Impact analysis information"})})]}),e.jsxs("p",{className:"small text-gray-600 mb-3 d-none d-md-block",style:{fontSize:"0.65rem"},children:["How this ",t.type==="income"?"income":t.type==="contribution"?"contribution":"expense"," compares to other transactions in the same category"]}),A&&p&&e.jsx("div",{className:"chart-area",children:e.jsx($,{highcharts:F,options:p,ref:K})})]}),v.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h6",{className:"font-weight-bold text-primary mb-3 d-flex align-items-center",children:[e.jsx("span",{className:"d-none d-md-inline",children:"Related Transactions"}),e.jsx("span",{className:"d-inline d-md-none",children:"Related"}),e.jsx("div",{className:"ml-2 position-relative d-none d-md-block",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:a=>j("relatedTransactions",a),"aria-label":"Related transactions information"})})]}),e.jsx("div",{className:"table-responsive related-transactions-table",children:e.jsxs("table",{className:"table table-bordered table-hover",id:"dataTable",width:"100%",cellSpacing:"0",children:[e.jsx("thead",{className:"bg-light",children:e.jsxs("tr",{children:[e.jsx("th",{className:"d-none d-md-table-cell",children:"Date"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{className:"d-none d-lg-table-cell",children:"Description"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:v.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"d-none d-md-table-cell",children:D(a.date)}),e.jsx("td",{className:a.type==="income"?"text-success":"text-danger",children:k(a.amount)}),e.jsx("td",{className:"d-none d-lg-table-cell",children:a.description&&a.description.trim()?a.description:e.jsx("span",{className:"text-muted font-italic",children:"No description"})}),e.jsx("td",{children:e.jsx(m,{to:`/transactions/${a.id}`,className:"btn btn-sm btn-primary",style:{fontSize:"0.65rem",padding:"0.2rem 0.4rem"},children:e.jsx("i",{className:"fas fa-eye fa-sm",style:{fontSize:"0.65rem"}})})})]},a.id))})]})})]})]})]})}),e.jsxs("div",{className:"col-lg-4 mb-4 animate__animated animate__fadeIn",style:{animationDelay:"0.5s"},children:[e.jsxs("div",{className:"card shadow mb-4",children:[e.jsx("div",{className:"card-header py-3",children:e.jsxs("h6",{className:"m-0 font-weight-bold text-primary d-flex align-items-center",children:["Category Breakdown",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:a=>j("categoryBreakdown",a),"aria-label":"Category breakdown information"})})]})}),e.jsx("div",{className:"card-body",children:A&&w?e.jsx("div",{className:"chart-pie",children:e.jsx($,{highcharts:F,options:w,ref:J})}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"mb-3",children:e.jsx("i",{className:"fas fa-chart-pie fa-3x text-gray-300"})}),e.jsx("p",{className:"text-gray-600 mb-0",children:"No category data available"})]})})]}),e.jsxs("div",{className:"card shadow mb-4",children:[e.jsx("div",{className:"card-header py-3",children:e.jsxs("h6",{className:"m-0 font-weight-bold text-primary d-flex align-items-center",children:["Transaction Info",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:a=>j("transactionInfo",a),"aria-label":"Transaction info information"})})]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"p-3 bg-light rounded mb-3",children:[e.jsx("div",{className:"small text-gray-500",children:"Transaction ID"}),e.jsx("div",{className:"font-weight-bold",children:t.id})]}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("div",{className:`bg-${T} p-2 rounded mr-2`,style:{opacity:.5},children:e.jsx("i",{className:`fas fa-${te} text-${T}`})}),e.jsxs("div",{children:[e.jsx("div",{className:"small text-gray-500",children:"Transaction Type"}),e.jsx("div",{className:`font-weight-bold ${t.type==="contribution"?"text-info":`text-${T}`}`,children:t.type.charAt(0).toUpperCase()+t.type.slice(1)})]})]}),e.jsxs(m,{to:`/transactions/${h}/edit`,className:"btn btn-primary btn-block",style:{fontSize:"0.65rem",padding:"0.25rem 0.4rem"},children:[e.jsx("i",{className:"fas fa-edit mr-1",style:{fontSize:"0.65rem"}}),e.jsx("span",{className:"d-none d-md-inline",children:"Edit Transaction"}),e.jsx("span",{className:"d-inline d-md-none",children:"Edit"})]})]})]})]})]}),f&&B&&e.jsxs("div",{className:"tip-box light",style:{top:`${B.top}px`,left:`${B.left}px`,position:"absolute",zIndex:1e3,maxWidth:"300px",padding:"15px",background:"white",borderRadius:"5px",boxShadow:"0 0.25rem 0.75rem rgba(0, 0, 0, 0.1)",transform:"translateX(-50%)"},children:[f==="amountInfo"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Transaction Amount"}),e.jsxs("p",{className:"tip-description mb-0",children:["The monetary value of this ",t.type,". For expenses, this represents money spent. For income, this represents money received."]})]}),f==="categoryInfo"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Transaction Category"}),e.jsx("p",{className:"tip-description mb-0",children:"Categories help organize your transactions for better budgeting and reporting. They allow you to track spending patterns across specific areas."})]}),f==="accountInfo"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Account Information"}),e.jsx("p",{className:"tip-description mb-0",children:"The financial account associated with this transaction. This could be a checking account, credit card, savings account, or any other account you've set up."})]}),f==="impactAnalysis"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Transaction Impact Analysis"}),e.jsx("p",{className:"tip-description mb-0",children:"This chart compares your transaction to the average and highest amounts in the same category. It helps you understand how this transaction fits into your overall spending or income pattern for this category."})]}),f==="categoryBreakdown"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Category Breakdown"}),e.jsx("p",{className:"tip-description mb-0",children:"This visualization shows how this transaction compares to all other transactions in the same category. The highlighted slice represents this specific transaction, while the remaining slice shows all other transactions combined."})]}),f==="transactionInfo"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Transaction Information"}),e.jsx("p",{className:"tip-description mb-0",children:"Technical details about this transaction including its unique ID and type. This information is useful for reference purposes and tracking the transaction in your financial records."})]}),f==="relatedTransactions"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Related Transactions"}),e.jsx("p",{className:"tip-description mb-0",children:"Other transactions that share the same category as this one. Viewing related transactions helps identify patterns in your spending or income for this particular category."})]}),f==="transactionDetails"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Transaction Details"}),e.jsx("p",{className:"tip-description mb-0",children:"This section provides comprehensive information about this transaction, including description, dates, and related goal information. You can see when the transaction was created and its purpose."})]})]}),fe&&e.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1050,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",style:{maxWidth:"450px",margin:"1.75rem",position:"relative",width:"auto",pointerEvents:"none",zIndex:1060},children:e.jsxs("div",{className:"modal-content",style:{position:"relative",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"0.5rem",pointerEvents:"auto",boxShadow:"0 0.5rem 1rem rgba(0, 0, 0, 0.15)"},children:[e.jsxs("div",{className:"modal-header border-0 pt-4 px-4 pb-0",children:[e.jsx("h3",{className:"modal-title w-100 text-center",style:{color:"#4e73df",fontWeight:600},children:"Confirm Deletion"}),e.jsx("button",{type:"button",className:"close",onClick:I,style:{position:"absolute",top:"1rem",right:"1rem",fontSize:"1.5rem",fontWeight:700,color:"#999",background:"none",border:"none",cursor:"pointer"},"aria-label":"Close",children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]}),e.jsxs("div",{className:"modal-body text-center p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"warning-icon",style:{backgroundColor:"#FFEFD5",width:"80px",height:"80px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto"},children:e.jsx("i",{className:"fas fa-exclamation-triangle fa-3x",style:{color:"#FFA500"}})})}),e.jsx("p",{style:{fontSize:"1rem",color:"#555"},children:"Are you sure you want to delete this transaction? This action cannot be undone."})]}),e.jsxs("div",{className:"modal-footer border-0 pb-4 pt-0 justify-content-center",children:[e.jsx("button",{type:"button",className:"btn",onClick:I,disabled:U,style:{padding:"0.5rem 1.5rem",backgroundColor:"transparent",color:"#4e73df",border:"1px solid #4e73df",borderRadius:"30px",fontWeight:500,transition:"all 0.2s ease",marginRight:"1rem"},onMouseOver:a=>a.currentTarget.style.backgroundColor="rgba(78, 115, 223, 0.1)",onMouseOut:a=>a.currentTarget.style.backgroundColor="transparent",children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:ue,disabled:U,style:{padding:"0.5rem 1.5rem",backgroundColor:"#e74a3b",borderColor:"#e74a3b",borderRadius:"30px",fontWeight:500,transition:"all 0.2s ease"},onMouseOver:a=>{a.currentTarget.style.backgroundColor="#d52a1a",a.currentTarget.style.borderColor="#d52a1a"},onMouseOut:a=>{a.currentTarget.style.backgroundColor="#e74a3b",a.currentTarget.style.borderColor="#e74a3b"},children:U?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"Deleting..."]}):"Delete"})]})]})})})]})};export{Ae as default};
