import{j as e}from"./ui-vendor-Cn1Vfl4w.js";import{r,L as j,i as je,u as ye}from"./react-vendor-D4A9EtXC.js";import{u as Ne,b as ve,B as we,s as f,f as m,c as T,d as p}from"./index-BbApZ7g3.js";import{d as E,H as A}from"./chart-vendor-B0c7K_uV.js";import{L as _e,B as Be}from"./BudgetErrorBoundary-CaqcfOPz.js";const le=r.memo(({title:l="Budget not found",message:v,showBackButton:c=!0,backTo:I="/budgets",backLabel:w="Back to Budgets"})=>e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"text-center my-3 md:my-5 py-4 md:py-8 animate__animated animate__fadeIn",children:[e.jsx("div",{className:"error-icon mb-3 md:mb-4",children:e.jsx("i",{className:"fas fa-exclamation-triangle fa-3x md:fa-4x text-warning"})}),e.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl mb-2 md:mb-3 font-bold text-gray-800",children:l}),e.jsx("p",{className:"mb-3 md:mb-4 text-sm md:text-base text-gray-600 px-4",children:v}),c&&e.jsxs(j,{to:I,className:"inline-flex items-center px-4 py-2 md:px-5 md:py-2.5 bg-[#4e73df] hover:bg-[#2e59d9] text-white text-sm md:text-base font-medium rounded shadow-sm transition-colors",children:[e.jsx("i",{className:"fas fa-arrow-left mr-2 text-xs md:text-sm"}),e.jsx("span",{children:w})]})]})}));le.displayName="ErrorMessage";const Ae=()=>{const{id:l}=je(),v=ye(),{user:c}=Ne(),{showSuccessToast:I,showErrorToast:w}=ve(),[s,q]=r.useState(null),[_,H]=r.useState([]),[B,S]=r.useState([]),[de,k]=r.useState(!0),[z,F]=r.useState(null),[D,oe]=r.useState(!1),[Y,ce]=r.useState(null),[J,me]=r.useState(null),[ke,X]=r.useState("view"),[Ce,R]=r.useState(null),$=r.useRef(we.getInstance()),[x,G]=r.useState(null),[O,K]=r.useState(null),Q=r.useRef(null),V=r.useRef(null),[y,xe]=r.useState(null),[g,ge]=r.useState(null),[Z]=r.useState(`budget_detail_updates_${l}`),[ee]=r.useState(`budget_transactions_updates_${l}`),[he,te]=r.useState(!1),[M,L]=r.useState(!1),[C,se]=r.useState("allocation"),P=t=>{if(t.month&&t.year)return{month:t.month,year:t.year};const a=new Date(t.start_date);return{month:["January","February","March","April","May","June","July","August","September","October","November","December"][a.getMonth()],year:a.getFullYear().toString()}};r.useEffect(()=>{(async()=>{try{if(!l){k(!1),F("No budget ID provided");return}if(!c){console.log("No user found, redirecting to login"),v("/login");return}k(!0),console.log(`Loading budget details for ID: ${l}`);const a=await $.current.getBudgetById(l,c.id);if(X(a.source),a.source==="error")throw R(a.error||"Unknown error occurred"),new Error(a.error||"Failed to fetch budget data");if(R(null),!a.data||a.data.length===0){F("Budget not found"),k(!1);return}const i=a.data[0];console.log("Found budget:",i),q(i);try{const n=await $.current.getBudgets(c.id);if(n.source!=="error"&&n.data){const o=n.data.filter(u=>u.category_id===i.category_id&&u.id!==l).slice(0,5);H(o),console.log(`Found ${o.length} related budgets`)}}catch(n){console.error("Error fetching related budgets:",n),H([])}try{const{data:n,error:o}=await f.from("transactions").select("*").eq("category_id",i.category_id).eq("user_id",c.id).eq("type","expense").gte("date",i.start_date).lte("date",i.end_date).order("date",{ascending:!1});o?(console.error("Error fetching transactions:",o),S([])):(console.log(`Found ${n?.length||0} related transactions`),S(n||[]))}catch(n){console.error("Error fetching transactions:",n),S([])}try{const n=await $.current.getBudgets(c.id);n.source!=="error"&&n.data&&ue(i,n.data)}catch(n){console.error("Error fetching all budgets for charts:",n)}oe(!0),k(!1)}catch(a){console.error("Error loading budget details:",a);const i=a instanceof Error?a.message:"Unknown error occurred";F(i),w(`Failed to load budget details: ${i}`),X("error"),R(i),k(!1)}})()},[l,c,v,w]),r.useEffect(()=>{if(!c||!l)return;Y&&(console.log("Removing existing budget subscription"),f.removeChannel(Y)),J&&(console.log("Removing existing transaction subscription"),f.removeChannel(J)),console.log(`Setting up new subscriptions for budget ${l}`);const t=f.channel(Z).on("postgres_changes",{event:"*",schema:"public",table:"budgets",filter:`id=eq.${l}`},i=>{console.log("Budget update received:",i),(async()=>{try{const{data:o,error:u}=await f.from("budget_details").select("*").eq("id",l).eq("user_id",c.id).single();!u&&o&&q(o)}catch(o){console.error("Error refreshing budget data:",o)}})()}).subscribe(i=>{console.log(`Budget subscription status: ${i}`)}),a=f.channel(ee).on("postgres_changes",{event:"*",schema:"public",table:"transactions",filter:`user_id=eq.${c.id}`},i=>{console.log("Transaction update received:",i),(async()=>{if(s)try{const{data:o,error:u}=await f.from("transactions").select("*").eq("category_id",s.category_id).eq("user_id",c.id).eq("type","expense").gte("date",s.start_date).lte("date",s.end_date).order("date",{ascending:!1});!u&&o&&S(o)}catch(o){console.error("Error refreshing transaction data:",o)}})()}).subscribe(i=>{console.log(`Transaction subscription status: ${i}`)});return ce(t),me(a),()=>{console.log("Cleaning up subscriptions"),t&&f.removeChannel(t),a&&f.removeChannel(a)}},[l,c,Z,ee]);const h=(t,a)=>{if(x===t)G(null),K(null);else if(G(t),a){const i=a.currentTarget.getBoundingClientRect();K({top:i.bottom+window.scrollY,left:i.left+i.width/2+window.scrollX})}},ue=(t,a)=>{const i=a.filter(d=>d.id!==t.id).sort((d,b)=>b.amount-d.amount).slice(0,4),n=[{name:t.category_name,y:t.amount,selected:!0,sliced:!0,color:"#4e73df"},...i.map(d=>({name:d.category_name,y:d.amount}))];xe({chart:{type:"pie",height:250,backgroundColor:"transparent",style:{fontFamily:"'Nunito', 'Segoe UI', Roboto, sans-serif"}},title:{text:null},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b> (${point.y:.2f})",valuePrefix:"$"},accessibility:{point:{valueSuffix:"%"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %",style:{fontWeight:"normal"},connectorWidth:0,distance:15},showInLegend:!1,size:"85%"}},legend:{enabled:!1},series:[{name:"Budget Allocation",colorByPoint:!0,data:n}],credits:{enabled:!1}});const o=a.reduce((d,b)=>{const U=b.category_name||b.display_category||"Uncategorized";return d[U]||(d[U]=0),d[U]+=b.amount,d},{}),u=Object.entries(o).sort((d,b)=>b[1]-d[1]).slice(0,8);ge({chart:{type:"bar",height:300,backgroundColor:"transparent",style:{fontFamily:"'Nunito', 'Segoe UI', Roboto, sans-serif"}},title:{text:null},xAxis:{categories:u.map(([d])=>d),title:{text:null},lineWidth:0,gridLineWidth:0,labels:{style:{color:"#858796",fontSize:"11px"}}},yAxis:{min:0,title:{text:null},labels:{format:"${value}",style:{color:"#858796",fontSize:"11px"}},gridLineColor:"#eaecf4",gridLineDashStyle:"dash"},legend:{enabled:!1},tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span><table>',pointFormat:'<tr><td style="color:{series.color};padding:0">Budget: </td><td style="padding:0"><b>${point.y:.2f}</b></td></tr>',footerFormat:"</table>",shared:!0,useHTML:!0},plotOptions:{bar:{borderRadius:3,dataLabels:{enabled:!0,format:"${y}"},pointWidth:20}},credits:{enabled:!1},series:[{name:"Budget Amount",colorByPoint:!0,data:u.map(([d,b])=>({name:d,y:b,color:d===(t.category_name||t.display_category)?"#4e73df":"#858796"}))}]})},ae=()=>{te(!0)},ie=()=>{te(!1),L(!1)},be=async()=>{if(!(!l||!c))try{L(!0);const t=await $.current.deleteBudget(l,c.id);if(!t.success)throw new Error(t.error||"Failed to delete budget");I("Budget deleted successfully!"),setTimeout(()=>{v("/budgets")},300)}catch(t){console.error("Error deleting budget:",t);const a=t instanceof Error?t.message:"Unknown error occurred";w(`Failed to delete budget: ${a}`),L(!1)}};if(de)return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"block md:hidden py-12 animate__animated animate__fadeIn",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"mt-3 text-xs text-gray-500 font-medium",children:"Loading budget details..."})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx(_e,{message:"Loading budget details..."})})]});if(z||!s)return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"block md:hidden py-12 animate__animated animate__fadeIn",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center px-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-amber-100 flex items-center justify-center mb-4",children:e.jsx("i",{className:"fas fa-exclamation-triangle text-amber-500 text-2xl"})}),e.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-2",children:"Budget not found"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:z||"The budget you're looking for does not exist or has been deleted."}),e.jsxs(j,{to:"/budgets",className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-500 text-white text-sm font-medium rounded-lg hover:bg-indigo-600 transition-colors",children:[e.jsx("i",{className:"fas fa-arrow-left text-xs"}),"Back to Budgets"]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx(le,{title:"Budget not found",message:z||"The budget you're looking for does not exist or has been deleted.",showBackButton:!0,backTo:"/budgets",backLabel:"Back to Budgets"})})]});const{month:re,year:ne}=P(s),N=s.status==="danger"?"danger":s.status==="warning"?"warning":"success",W=s.status==="danger"?"exclamation-circle":s.status==="warning"?"exclamation-triangle":"check-circle",fe=s.status==="danger"?"rgba(231, 74, 59, 0.1)":s.status==="warning"?"rgba(246, 194, 62, 0.1)":"rgba(28, 200, 138, 0.1)",pe=s.status==="danger"?"#e74a3b":s.status==="warning"?"#f6c23e":"#1cc88a";return e.jsx(Be,{children:e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-bold text-gray-800",children:"Budget Details"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:ae,className:"w-9 h-9 rounded-full bg-rose-500 hover:bg-rose-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95","aria-label":"Delete budget",children:e.jsx("i",{className:"fas fa-trash text-xs"})}),e.jsx(j,{to:`/budgets/${l}/edit`,className:"w-9 h-9 rounded-full bg-indigo-500 hover:bg-indigo-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95","aria-label":"Edit budget",children:e.jsx("i",{className:"fas fa-edit text-xs"})}),e.jsx(j,{to:"/budgets",className:"w-9 h-9 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 flex items-center justify-center shadow-sm transition-all active:scale-95","aria-label":"Back to budgets",children:e.jsx("i",{className:"fas fa-arrow-left text-xs"})})]})]})}),e.jsxs("div",{className:"block md:hidden mb-4",children:[e.jsxs("div",{className:`bg-gradient-to-br ${s.status==="danger"?"from-rose-500 via-red-500 to-orange-500":s.status==="warning"?"from-amber-500 via-orange-500 to-yellow-500":"from-emerald-500 via-teal-500 to-cyan-500"} rounded-2xl p-4 shadow-lg`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"px-2 py-0.5 rounded-full text-[10px] font-semibold bg-white/20 text-white",children:s.status==="danger"?"Overspent":s.status==="warning"?"Warning":"On Track"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:`fas fa-${W} text-white text-sm`})})]}),e.jsx("div",{className:"text-white text-2xl font-bold mb-1",children:m(s.amount)}),e.jsxs("div",{className:"text-white/70 text-xs mb-3",children:[s.category_name||s.display_category||"Uncategorized"," • ",re," ",ne]}),e.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-white h-2 rounded-full transition-all duration-500",style:{width:`${Math.min(s.percentage_used||0,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-white/80 text-[10px]",children:[e.jsxs("span",{children:[T(s.percentage_used||0)," used"]}),e.jsxs("span",{children:[m(s.remaining||0)," left"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3",children:[e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-blue-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-coins text-blue-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Budget"}),e.jsx("p",{className:"text-[11px] font-bold text-gray-800 truncate",children:m(s.amount)})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-rose-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-credit-card text-rose-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Spent"}),e.jsx("p",{className:"text-[11px] font-bold text-gray-800 truncate",children:m(s.spent)})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-emerald-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-piggy-bank text-emerald-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Left"}),e.jsx("p",{className:`text-[11px] font-bold truncate ${(s.remaining||0)<0?"text-rose-600":"text-emerald-600"}`,children:m(s.remaining||0)})]})]}),e.jsx("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100 mt-2",children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-indigo-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-calendar text-indigo-500 text-xs"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Period"}),e.jsxs("p",{className:"text-xs font-bold text-gray-800 truncate",children:[p(s.start_date)," - ",p(s.end_date)]})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden mt-3",children:[e.jsxs("div",{className:"flex bg-slate-50",children:[e.jsxs("button",{onClick:()=>se("allocation"),className:`flex-1 py-3.5 text-sm font-semibold transition-all relative ${C==="allocation"?"text-indigo-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx("i",{className:"fas fa-chart-pie mr-2 text-xs"}),"Allocation",C==="allocation"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-600"})]}),e.jsxs("button",{onClick:()=>se("distribution"),className:`flex-1 py-3.5 text-sm font-semibold transition-all relative ${C==="distribution"?"text-indigo-600 bg-white":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx("i",{className:"fas fa-chart-bar mr-2 text-xs"}),"Distribution",C==="distribution"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-indigo-600"})]})]}),e.jsx("div",{className:"p-4",children:C==="allocation"?D&&y?e.jsx("div",{className:"animate__animated animate__fadeIn",children:e.jsx(E,{highcharts:A,options:{...y,chart:{...y.chart,height:250},plotOptions:{...y.plotOptions,pie:{...y.plotOptions?.pie,dataLabels:{enabled:!1},showInLegend:!0,size:"70%",innerSize:"50%",center:["50%","40%"]}},legend:{enabled:!0,layout:"horizontal",align:"center",verticalAlign:"bottom",itemStyle:{fontSize:"11px",fontWeight:"normal",color:"#374151"},symbolRadius:2,symbolHeight:10,symbolWidth:10,itemMarginTop:8},title:{text:null}},ref:Q})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"fas fa-chart-pie text-gray-400 text-2xl"})}),e.jsx("p",{className:"text-sm text-gray-500",children:"No allocation data available"})]}):D&&g?e.jsx("div",{className:"animate__animated animate__fadeIn",children:e.jsx(E,{highcharts:A,options:{...g,chart:{...g.chart,height:280},xAxis:{...g.xAxis,labels:{...g.xAxis?.labels,style:{fontSize:"10px",color:"#6b7280"}}},yAxis:{...g.yAxis,labels:{...g.yAxis?.labels,style:{fontSize:"10px",color:"#6b7280"}}}},ref:V})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"fas fa-chart-bar text-gray-400 text-2xl"})}),e.jsx("p",{className:"text-sm text-gray-500",children:"No distribution data available"})]})})]}),B.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden mt-3",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:e.jsxs("h6",{className:"text-xs font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-list text-indigo-500 text-[10px]"}),"Budget Expenses",e.jsx("span",{className:"bg-indigo-100 text-indigo-600 px-1.5 py-0.5 rounded-full text-[9px]",children:B.length})]})}),e.jsx("div",{className:"divide-y divide-gray-100",children:B.slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-rose-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-arrow-down text-xs text-rose-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-800",children:m(t.amount)}),e.jsx("p",{className:"text-[10px] text-gray-500",children:p(t.date)})]})]}),e.jsx("span",{className:"text-[10px] text-gray-500",children:T(t.amount/s.amount*100)})]},t.id))})]}),_.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden mt-3 mb-4",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:e.jsxs("h6",{className:"text-xs font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-folder text-indigo-500 text-[10px]"}),"Related Budgets",e.jsx("span",{className:"bg-indigo-100 text-indigo-600 px-1.5 py-0.5 rounded-full text-[9px]",children:_.length})]})}),e.jsx("div",{className:"divide-y divide-gray-100",children:_.slice(0,3).map(t=>{const a=P(t);return e.jsxs(j,{to:`/budgets/${t.id}`,className:"flex items-center justify-between px-4 py-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${t.status==="danger"?"bg-rose-100":t.status==="warning"?"bg-amber-100":"bg-emerald-100"}`,children:e.jsx("i",{className:`fas fa-${t.status==="danger"?"exclamation-circle":t.status==="warning"?"exclamation-triangle":"check-circle"} text-xs ${t.status==="danger"?"text-rose-500":t.status==="warning"?"text-amber-500":"text-emerald-500"}`})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium text-gray-800",children:[a.month," ",a.year]}),e.jsx("p",{className:"text-[10px] text-gray-500",children:m(t.amount)})]})]}),e.jsx("i",{className:"fas fa-chevron-right text-gray-400 text-[10px]"})]},t.id)})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100 mb-4",children:[e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide mb-1",children:"Budget ID"}),e.jsx("p",{className:"text-[10px] text-gray-600 font-mono truncate",children:s.id})]})]}),e.jsxs("div",{className:"d-none d-md-flex align-items-center justify-content-between mb-2 mb-md-4 animate__animated animate__fadeInDown",children:[e.jsx("h1",{className:"h5 h-md-3 mb-1 mb-md-0 text-gray-800",style:{fontSize:"1.1rem"},children:"Budget Details"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("button",{onClick:ae,className:"btn btn-sm btn-danger shadow-sm d-flex align-items-center",style:{padding:"0.25rem 0.5rem"},children:[e.jsx("i",{className:"fas fa-trash fa-sm",style:{fontSize:"0.7rem"}}),e.jsx("span",{className:"d-none d-md-inline ml-2",children:"Delete Budget"})]}),e.jsxs(j,{to:`/budgets/${l}/edit`,className:"btn btn-sm btn-primary shadow-sm d-flex align-items-center",style:{padding:"0.25rem 0.5rem"},children:[e.jsx("i",{className:"fas fa-edit fa-sm",style:{fontSize:"0.7rem"}}),e.jsx("span",{className:"d-none d-md-inline ml-2",children:"Edit Budget"})]}),e.jsxs(j,{to:"/budgets",className:"btn btn-sm btn-secondary shadow-sm d-flex align-items-center",style:{padding:"0.25rem 0.5rem"},children:[e.jsx("i",{className:"fas fa-arrow-left fa-sm",style:{fontSize:"0.7rem"}}),e.jsx("span",{className:"d-none d-md-inline ml-2",children:"Back to Budgets"})]})]})]}),e.jsxs("div",{className:"row d-none d-md-flex",children:[e.jsx("div",{className:"col-xl-4 col-md-6 col-12 mb-3 mb-md-4 animate__animated animate__fadeIn",style:{animationDelay:"0.1s"},children:e.jsx("div",{className:`card border-left-${N} shadow h-100 py-2`,children:e.jsx("div",{className:"card-body p-3",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsxs("div",{className:`text-xs font-weight-bold text-${N} text-uppercase mb-1 d-flex align-items-center`,children:["Budget Amount",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:t=>h("budgetAmount",t),"aria-label":"Budget amount information"})})]}),e.jsx("div",{className:"h5 h6-mobile mb-0 font-weight-bold text-gray-800",children:m(s.amount)})]}),e.jsx("div",{className:"col-auto d-none d-md-block",children:e.jsx("i",{className:"fas fa-coins fa-2x text-gray-300"})})]})})})}),e.jsx("div",{className:"col-xl-4 col-md-6 col-12 mb-3 mb-md-4 animate__animated animate__fadeIn",style:{animationDelay:"0.2s"},children:e.jsx("div",{className:"card border-left-info shadow h-100 py-2",children:e.jsx("div",{className:"card-body p-3",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsxs("div",{className:"text-xs font-weight-bold text-info text-uppercase mb-1 d-flex align-items-center",style:{fontSize:"0.65rem"},children:["Category",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:t=>h("budgetCategory",t),"aria-label":"Category information"})})]}),e.jsx("div",{className:"h5 h6-mobile mb-0 font-weight-bold text-gray-800",children:s.category_name||s.display_category||e.jsxs("span",{className:"text-warning",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-1"}),"Uncategorized"]})})]}),e.jsx("div",{className:"col-auto d-none d-md-block",children:e.jsx("i",{className:"fas fa-tag fa-2x text-gray-300"})})]})})})}),e.jsx("div",{className:"col-xl-4 col-md-6 col-12 mb-3 mb-md-4 animate__animated animate__fadeIn",style:{animationDelay:"0.3s"},children:e.jsx("div",{className:"card border-left-primary shadow h-100 py-2",children:e.jsx("div",{className:"card-body p-3",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsxs("div",{className:"text-xs font-weight-bold text-primary text-uppercase mb-1 d-flex align-items-center",style:{fontSize:"0.65rem"},children:["Budget Period",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:t=>h("budgetPeriod",t),"aria-label":"Budget period information"})})]}),e.jsxs("div",{className:"h5 h6-mobile mb-0 font-weight-bold text-gray-800",children:[re," ",ne]})]}),e.jsx("div",{className:"col-auto d-none d-md-block",children:e.jsx("i",{className:"fas fa-calendar fa-2x text-gray-300"})})]})})})})]}),e.jsxs("div",{className:"row d-none d-md-flex",children:[e.jsx("div",{className:"col-lg-8 mb-3 mb-md-4 animate__animated animate__fadeIn",style:{animationDelay:"0.4s"},children:e.jsxs("div",{className:"card shadow",children:[e.jsxs("div",{className:"card-header py-2 d-flex flex-row align-items-center justify-content-between",children:[e.jsxs("h6",{className:"m-0 font-weight-bold text-primary d-flex align-items-center",style:{fontSize:"0.875rem"},children:["Budget Details",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:t=>h("budgetDetails",t),"aria-label":"Budget details information"})})]}),e.jsx("div",{className:`badge badge-${N}`,children:s.status==="danger"?"Overspent":s.status==="warning"?"Warning":"On Track"})]}),e.jsxs("div",{className:"card-body p-3",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"mb-2",children:[e.jsx("h4",{className:"small font-weight-bold",children:"Budget Name"}),e.jsx("div",{className:"p-3 bg-light rounded",children:s.budget_name&&s.budget_name.trim()?e.jsx("p",{className:"mb-0 text-gray-700",children:s.budget_name}):e.jsx("p",{className:"mb-0 text-muted font-italic",children:"No budget name provided"})})]})}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("h4",{className:"small font-weight-bold",children:"Budget Period"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"p-2 rounded mr-2",style:{backgroundColor:"rgba(78, 115, 223, 0.15)"},children:e.jsx("i",{className:"fas fa-calendar text-primary"})}),e.jsxs("span",{className:"text-gray-800",children:[p(s.start_date)," - ",p(s.end_date)]})]})]}),s.created_at&&e.jsxs("div",{className:"col-md-6",children:[e.jsx("h4",{className:"small font-weight-bold",children:"Created At"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"p-2 rounded mr-2",style:{backgroundColor:"rgba(246, 194, 62, 0.15)"},children:e.jsx("i",{className:"fas fa-clock text-warning"})}),e.jsx("span",{className:"text-gray-800",children:p(s.created_at)})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"small font-weight-bold",children:"Budget Progress"}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"p-2 rounded mr-2",style:{backgroundColor:fe},children:e.jsx("i",{className:`fas fa-${W}`,style:{color:pe}})}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-800",children:[e.jsx("strong",{children:T(s.percentage_used||0)})," of budget used"]}),e.jsxs("div",{className:"small text-gray-600 mt-1",children:["Spent: ",m(s.spent)," of ",m(s.amount),"(Remaining: ",m(s.remaining||0),")"]}),e.jsx("div",{className:"progress mt-2",style:{height:"10px"},children:e.jsx("div",{className:`progress-bar bg-${N}`,role:"progressbar",style:{width:`${Math.min(s.percentage_used||0,100)}%`},"aria-valuenow":s.percentage_used||0,"aria-valuemin":0,"aria-valuemax":100})})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("h6",{className:"font-weight-bold text-primary mb-3 d-flex align-items-center",children:["Budget Category Distribution",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:t=>h("categoryDistribution",t),"aria-label":"Category distribution information"})})]}),e.jsx("p",{className:"small text-gray-600 mb-3",children:"How this budget compares to other category budgets in the same period"}),D&&g&&e.jsx("div",{className:"chart-area",children:e.jsx(E,{highcharts:A,options:g,ref:V})})]}),B.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h6",{className:"font-weight-bold text-primary mb-3 d-flex align-items-center",children:["Budget Expenses",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:t=>h("budgetExpenses",t),"aria-label":"Budget expenses information"})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered table-hover",width:"100%",cellSpacing:"0",children:[e.jsx("thead",{className:"bg-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"% of Budget"})]})}),e.jsx("tbody",{children:B.map(t=>{const a=t.amount/s.amount*100;return e.jsxs("tr",{children:[e.jsx("td",{children:p(t.date)}),e.jsx("td",{className:"text-danger",children:m(t.amount)}),e.jsx("td",{children:t.notes&&t.notes.trim()?t.notes:e.jsx("span",{className:"text-muted font-italic",children:"No description"})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"progress mr-2",style:{height:"15px",width:"80px"},children:e.jsx("div",{className:`progress-bar ${a>=20?"bg-danger":a>=10?"bg-warning":"bg-success"}`,role:"progressbar",style:{width:`${Math.min(a,100)}%`},"aria-valuenow":a,"aria-valuemin":0,"aria-valuemax":100})}),e.jsx("span",{className:"small",children:T(a)})]})})]},t.id)})})]})})]}),_.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h6",{className:"font-weight-bold text-primary mb-3 d-flex align-items-center",children:["Related Budgets",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:t=>h("relatedBudgets",t),"aria-label":"Related budgets information"})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered table-hover",width:"100%",cellSpacing:"0",children:[e.jsx("thead",{className:"bg-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Period"}),e.jsx("th",{children:"Budget"}),e.jsx("th",{children:"Spent"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:_.map(t=>{const a=P(t);return e.jsxs("tr",{children:[e.jsxs("td",{children:[a.month," ",a.year]}),e.jsx("td",{children:m(t.amount)}),e.jsx("td",{className:t.status==="danger"?"text-danger":t.status==="warning"?"text-warning":"text-success",children:m(t.spent)}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${t.status==="danger"?"danger":t.status==="warning"?"warning":"success"}`,children:t.status==="danger"?"Overspent":t.status==="warning"?"Warning":"On Track"})}),e.jsx("td",{children:e.jsx(j,{to:`/budgets/${t.id}`,className:"btn btn-sm btn-primary",children:e.jsx("i",{className:"fas fa-eye fa-sm"})})})]},t.id)})})]})})]})]})]})}),e.jsxs("div",{className:"col-lg-4 mb-3 mb-md-4 animate__animated animate__fadeIn",style:{animationDelay:"0.5s"},children:[e.jsxs("div",{className:"card shadow mb-3 mb-md-4",children:[e.jsx("div",{className:"card-header py-2",children:e.jsxs("h6",{className:"m-0 font-weight-bold text-primary d-flex align-items-center",style:{fontSize:"0.875rem"},children:["Budget Allocation",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:t=>h("budgetAllocation",t),"aria-label":"Budget allocation information"})})]})}),e.jsx("div",{className:"card-body p-3",children:D&&y?e.jsx("div",{className:"chart-pie",children:e.jsx(E,{highcharts:A,options:y,ref:Q})}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"mb-3",children:e.jsx("i",{className:"fas fa-chart-pie fa-3x text-gray-300"})}),e.jsx("p",{className:"text-gray-600 mb-0",children:"No allocation data available"})]})})]}),e.jsxs("div",{className:"card shadow mb-3 mb-md-4",children:[e.jsx("div",{className:"card-header py-2",children:e.jsxs("h6",{className:"m-0 font-weight-bold text-primary d-flex align-items-center",style:{fontSize:"0.875rem"},children:["Budget Info",e.jsx("div",{className:"ml-2 position-relative",children:e.jsx("i",{className:"fas fa-info-circle text-gray-400 cursor-pointer",onClick:t=>h("budgetInfo",t),"aria-label":"Budget info information"})})]})}),e.jsxs("div",{className:"card-body p-3",children:[e.jsxs("div",{className:"p-3 bg-light rounded mb-3",children:[e.jsx("div",{className:"small text-gray-500",children:"Budget ID"}),e.jsx("div",{className:"font-weight-bold",children:s.id})]}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("div",{className:`bg-${N} p-2 rounded mr-2`,style:{opacity:.5},children:e.jsx("i",{className:`fas fa-${W} text-${N}`})}),e.jsxs("div",{children:[e.jsx("div",{className:"small text-gray-500",children:"Budget Status"}),e.jsx("div",{className:`font-weight-bold text-${N}`,children:s.status==="danger"?"Overspent":s.status==="warning"?"Warning":"On Track"})]})]}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("div",{className:"bg-info p-2 rounded mr-2",style:{opacity:.5},children:e.jsx("i",{className:"fas fa-calendar text-info"})}),e.jsxs("div",{children:[e.jsx("div",{className:"small text-gray-500",children:"Budget Period"}),e.jsxs("div",{className:"font-weight-bold",children:[p(s.start_date)," - ",p(s.end_date)]})]})]}),e.jsxs(j,{to:`/budgets/${l}/edit`,className:"btn btn-primary btn-block",children:[e.jsx("i",{className:"fas fa-edit mr-1"})," Edit Budget"]})]})]})]})]}),x&&O&&e.jsxs("div",{className:"tip-box light",style:{top:`${O.top}px`,left:`${O.left}px`,position:"absolute",zIndex:1e3,maxWidth:"300px",padding:"15px",background:"white",borderRadius:"5px",boxShadow:"0 0.25rem 0.75rem rgba(0, 0, 0, 0.1)",transform:"translateX(-50%)"},children:[x==="budgetAmount"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Budget Amount"}),e.jsx("p",{className:"tip-description mb-0",children:"The total amount of money allocated for this category during the selected time period. This is your spending limit for this category."})]}),x==="budgetCategory"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Budget Category"}),e.jsx("p",{className:"tip-description mb-0",children:"The spending category this budget applies to. Categories help you organize your expenses and track spending patterns in specific areas."})]}),x==="budgetPeriod"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Budget Period"}),e.jsx("p",{className:"tip-description mb-0",children:"The time period this budget covers. Budget tracking is done over specific periods to help you manage your finances more effectively."})]}),x==="budgetDetails"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Budget Details"}),e.jsx("p",{className:"tip-description mb-0",children:"Comprehensive information about this budget, including its utilization rate, related transactions, and progress tracking. This section helps you understand how your money is being spent within this category."})]}),x==="categoryDistribution"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Budget Category Distribution"}),e.jsx("p",{className:"tip-description mb-0",children:"This chart shows how budget allocations are distributed across all categories. It helps visualize spending priorities and identify which categories receive the largest portions of your total budget."})]}),x==="budgetExpenses"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Budget Expenses"}),e.jsx("p",{className:"tip-description mb-0",children:"All transactions related to this budget category during the specified period. This section shows exactly where your money went and how each expense contributes to your overall category spending."})]}),x==="relatedBudgets"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Related Budgets"}),e.jsx("p",{className:"tip-description mb-0",children:"Other budgets for the same category from different time periods. This helps you track how your budget and spending patterns in this category change over time."})]}),x==="budgetAllocation"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Budget Allocation"}),e.jsx("p",{className:"tip-description mb-0",children:"This chart shows how this budget compares to other category budgets in the same period. It helps you visualize your financial priorities based on how you allocate your money."})]}),x==="budgetInfo"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"tip-title font-weight-bold mb-2",children:"Budget Information"}),e.jsx("p",{className:"tip-description mb-0",children:"Technical details about this budget including its unique ID, status, and date range. This information is useful for reference and identification purposes."})]})]}),he&&e.jsx("div",{className:"modal-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1050,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",style:{maxWidth:"450px",margin:"1.75rem",position:"relative",width:"auto",pointerEvents:"none",zIndex:1060},children:e.jsxs("div",{className:"modal-content",style:{position:"relative",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"0.5rem",pointerEvents:"auto",boxShadow:"0 0.5rem 1rem rgba(0, 0, 0, 0.15)"},children:[e.jsxs("div",{className:"modal-header border-0 pt-4 px-4 pb-0",children:[e.jsx("h3",{className:"modal-title w-100 text-center",style:{color:"#4e73df",fontWeight:600},children:"Confirm Deletion"}),e.jsx("button",{type:"button",className:"close",onClick:ie,style:{position:"absolute",top:"1rem",right:"1rem",fontSize:"1.5rem",fontWeight:700,color:"#999",background:"none",border:"none",cursor:"pointer"},"aria-label":"Close",children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]}),e.jsxs("div",{className:"modal-body text-center p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"warning-icon",style:{backgroundColor:"#FFEFD5",width:"80px",height:"80px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto"},children:e.jsx("i",{className:"fas fa-exclamation-triangle fa-3x",style:{color:"#FFA500"}})})}),e.jsx("p",{style:{fontSize:"1rem",color:"#555"},children:"Are you sure you want to delete this budget? This action cannot be undone."})]}),e.jsxs("div",{className:"modal-footer border-0 pb-4 pt-0 justify-content-center",children:[e.jsx("button",{type:"button",className:"btn",onClick:ie,disabled:M,style:{padding:"0.5rem 1.5rem",backgroundColor:"transparent",color:"#4e73df",border:"1px solid #4e73df",borderRadius:"30px",fontWeight:500,transition:"all 0.2s ease",marginRight:"1rem"},onMouseOver:t=>t.currentTarget.style.backgroundColor="rgba(78, 115, 223, 0.1)",onMouseOut:t=>t.currentTarget.style.backgroundColor="transparent",children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:be,disabled:M,style:{padding:"0.5rem 1.5rem",backgroundColor:"#e74a3b",borderColor:"#e74a3b",borderRadius:"30px",fontWeight:500,transition:"all 0.2s ease"},onMouseOver:t=>{t.currentTarget.style.backgroundColor="#d52a1a",t.currentTarget.style.borderColor="#d52a1a"},onMouseOut:t=>{t.currentTarget.style.backgroundColor="#e74a3b",t.currentTarget.style.borderColor="#e74a3b"},children:M?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"Deleting..."]}):"Delete"})]})]})})})]})})};export{Ae as default};
