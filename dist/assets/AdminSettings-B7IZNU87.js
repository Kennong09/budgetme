import{j as e}from"./ui-vendor-Cn1Vfl4w.js";import{r as u}from"./react-vendor-D4A9EtXC.js";import{b as q,s as b}from"./index-BbApZ7g3.js";import"./chart-vendor-B0c7K_uV.js";const O=()=>{const[C,k]=u.useState(!0),[c,p]=u.useState(!1),[F,M]=u.useTransition(),{showSuccessToast:h,showErrorToast:f}=q(),L=C||F||c,[s,y]=u.useState({autoBackupEnabled:!0,backupFrequency:"daily",backupRetention:30,lastBackupDate:null,storageLocation:"supabase_storage",compressionEnabled:!0,encryptionEnabled:!0,notificationEnabled:!0,maxSizeMB:1e3,cleanupEnabled:!0}),[t,w]=u.useState(null),[g,_]=u.useState([]);u.useEffect(()=>{let a=!0;return(async()=>{try{k(!0);const{data:n,error:d}=await b.from("admin_settings").select("setting_key, setting_value").like("setting_key","backup_%");if(d)throw d;if(n&&a){const r={};n.forEach(x=>{const R=x.setting_key.replace("backup_",""),i=x.setting_value;switch(R){case"auto_enabled":r.autoBackupEnabled=i===!0||i==="true";break;case"frequency":r.backupFrequency=i;break;case"retention_days":r.backupRetention=parseInt(i)||30;break;case"last_run":r.lastBackupDate=i;break;case"storage_location":r.storageLocation=i;break;case"compression_enabled":r.compressionEnabled=i===!0||i==="true";break;case"encryption_enabled":r.encryptionEnabled=i===!0||i==="true";break;case"notification_enabled":r.notificationEnabled=i===!0||i==="true";break;case"max_size_mb":r.maxSizeMB=parseInt(i)||1e3;break;case"cleanup_enabled":r.cleanupEnabled=i===!0||i==="true";break}}),y(x=>({...x,...r}))}const{data:o}=await b.rpc("get_backup_statistics");o&&a&&(w(o),_(o.recent_backups||[]))}catch(n){console.error("Error fetching settings:",n),a&&f("Failed to load backup settings")}finally{a&&k(!1)}})(),()=>{a=!1}},[f]);const m=a=>{const{name:l,value:n,type:d}=a.target,o=a.target.checked;M(()=>{y(r=>({...r,[l]:d==="checkbox"?o:l==="backupRetention"?parseInt(n):n}))})},B=async a=>{if(a&&a.preventDefault(),!c){p(!0);try{const l=[{key:"backup_auto_enabled",value:s.autoBackupEnabled},{key:"backup_frequency",value:s.backupFrequency},{key:"backup_retention_days",value:s.backupRetention},{key:"backup_storage_location",value:s.storageLocation},{key:"backup_compression_enabled",value:s.compressionEnabled},{key:"backup_encryption_enabled",value:s.encryptionEnabled},{key:"backup_notification_enabled",value:s.notificationEnabled},{key:"backup_max_size_mb",value:s.maxSizeMB},{key:"backup_cleanup_enabled",value:s.cleanupEnabled}];for(const n of l){const{error:d}=await b.from("admin_settings").upsert({setting_key:n.key,setting_value:n.value,setting_type:typeof n.value=="boolean"?"boolean":typeof n.value=="number"?"number":"string",description:`Backup setting: ${n.key}`,category:"general",is_public:!1,requires_admin:!0,updated_at:new Date().toISOString()});if(d)throw d}h("Backup settings saved successfully!")}catch(l){console.error("Error saving settings:",l),f("Failed to save backup settings")}finally{p(!1)}}},j=async()=>{if(!c){p(!0);try{h("Starting backup process...");const{data:a,error:l}=await b.rpc("perform_database_backup",{p_backup_type:"manual",p_created_by:(await b.auth.getUser()).data.user?.id});if(l)throw l;h(`Backup completed! ID: ${a}`);const{data:n}=await b.rpc("get_backup_statistics");n&&(w(n),_(n.recent_backups||[])),y(d=>({...d,lastBackupDate:new Date().toISOString()}))}catch(a){console.error("Backup error:",a),f("Failed to complete backup")}finally{p(!1)}}},N=async()=>{if(!c){p(!0);try{h("Preparing export...");const a=["accounts","transactions","budgets","goals","profiles"];let l=`-- BudgetMe Export - ${new Date().toISOString()}
`;for(const r of a){const{data:x}=await b.from(r).select("*").limit(100);x?.length&&(l+=`-- ${r}: ${x.length} rows
`)}const n=new Blob([l],{type:"text/sql"}),d=window.URL.createObjectURL(n),o=document.createElement("a");o.href=d,o.download=`budgetme_dump_${new Date().toISOString().split("T")[0]}.sql`,document.body.appendChild(o),o.click(),document.body.removeChild(o),h("Export downloaded!")}catch{f("Export failed")}finally{p(!1)}}},v=t?.total_backups?(t.successful_backups/t.total_backups*100).toFixed(1):"0",S=t?.total_backups?(t.failed_backups/t.total_backups*100).toFixed(1):"0",E=t?.average_duration_ms?Math.round(t.average_duration_ms/1e3):0,D=t?.total_size_bytes?Math.round(t.total_size_bytes/1024/1024):0,$=a=>{if(!a)return"Never";const l=Math.floor((Date.now()-new Date(a).getTime())/36e5);return l<1?"Just now":l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`};return L?e.jsxs("div",{className:"modern-user-management",children:[e.jsx("div",{className:"block md:hidden py-12",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"mt-3 text-xs text-gray-500 font-medium",children:"Loading backup settings..."})]})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"user-management-header mb-5",children:e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"skeleton-icon mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"skeleton-line skeleton-header-title mb-2"}),e.jsx("div",{className:"skeleton-line skeleton-header-subtitle"})]})]})}),e.jsx("div",{className:"row mb-4",children:[1,2,3,4].map(a=>e.jsx("div",{className:"col-xl-3 col-md-6 mb-4",children:e.jsx("div",{className:"card shadow h-100 py-3 admin-card-loading",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"skeleton-line skeleton-title mb-2"}),e.jsx("div",{className:"skeleton-line skeleton-value"})]})})},a))})]})]}):e.jsxs("div",{className:"modern-user-management",children:[e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-bold text-gray-800",children:"Backup & Maintenance"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:N,disabled:c,className:"w-9 h-9 rounded-full bg-emerald-500 hover:bg-emerald-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95 disabled:opacity-50",children:e.jsx("i",{className:"fas fa-download text-xs"})}),e.jsx("button",{onClick:j,disabled:c,className:"w-9 h-9 rounded-full bg-red-500 hover:bg-red-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95 disabled:opacity-50",children:e.jsx("i",{className:`fas fa-database text-xs ${c?"fa-spin":""}`})})]})]})}),e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:`bg-gradient-to-br ${t?.failed_backups===0?"from-emerald-500 via-teal-500 to-cyan-500":"from-amber-500 via-orange-500 to-yellow-500"} rounded-2xl p-4 shadow-lg`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-white/80 text-xs font-medium",children:"Backup Status"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:`fas fa-${t?.failed_backups===0?"check-circle":"exclamation-triangle"} text-white text-sm`})})]}),e.jsx("div",{className:"text-white text-lg font-bold mb-1",children:t?.failed_backups===0?"All Backups Healthy":"Issues Detected"}),e.jsxs("div",{className:"text-white/70 text-xs",children:[e.jsx("i",{className:"fas fa-clock text-[10px] mr-1"}),"Last: ",$(s.lastBackupDate)]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-white/20",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-[9px] uppercase",children:"Total"}),e.jsx("p",{className:"text-white text-sm font-bold",children:t?.total_backups||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-[9px] uppercase",children:"Success"}),e.jsxs("p",{className:"text-white text-sm font-bold",children:[v,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/60 text-[9px] uppercase",children:"Size"}),e.jsxs("p",{className:"text-white text-sm font-bold",children:[D,"MB"]})]})]})]})}),e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-red-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-database text-red-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase",children:"Total Backups"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:t?.total_backups||0}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-gray-400",children:[e.jsx("i",{className:"fas fa-history text-[8px]"}),e.jsx("span",{className:"text-[9px]",children:s.backupFrequency})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-emerald-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-check-circle text-emerald-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase",children:"Successful"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:t?.successful_backups||0}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-emerald-500",children:[e.jsx("i",{className:"fas fa-arrow-up text-[8px]"}),e.jsxs("span",{className:"text-[9px]",children:[v,"%"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-rose-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-exclamation-triangle text-rose-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase",children:"Failed"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:t?.failed_backups||0}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-rose-500",children:[e.jsx("i",{className:"fas fa-times text-[8px]"}),e.jsxs("span",{className:"text-[9px]",children:[S,"%"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-blue-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-clock text-blue-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase",children:"Avg Duration"}),e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:[E,"s"]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-blue-500",children:[e.jsx("i",{className:"fas fa-bolt text-[8px]"}),e.jsx("span",{className:"text-[9px]",children:"per backup"})]})]})]})}),e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2.5 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("h6",{className:"text-[11px] font-bold text-gray-800 flex items-center gap-1.5",children:[e.jsx("i",{className:"fas fa-cog text-red-500 text-[10px]"}),"Settings"]}),e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[9px] font-medium ${s.autoBackupEnabled?"bg-emerald-100 text-emerald-600":"bg-gray-100 text-gray-600"}`,children:s.autoBackupEnabled?"Auto ON":"Auto OFF"})]}),e.jsxs("div",{className:"px-3 py-3 space-y-3",children:[[{name:"autoBackupEnabled",label:"Auto Backup",icon:"sync",color:"red",type:"toggle"},{name:"compressionEnabled",label:"Compression",icon:"compress",color:"cyan",type:"toggle"},{name:"encryptionEnabled",label:"Encryption",icon:"lock",color:"green",type:"toggle"},{name:"notificationEnabled",label:"Notifications",icon:"bell",color:"pink",type:"toggle"},{name:"cleanupEnabled",label:"Auto Cleanup",icon:"broom",color:"orange",type:"toggle"}].map(a=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-6 h-6 rounded-lg bg-${a.color}-100 flex items-center justify-center`,children:e.jsx("i",{className:`fas fa-${a.icon} text-${a.color}-500 text-[10px]`})}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:a.label})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",name:a.name,checked:s[a.name],onChange:m}),e.jsx("div",{className:`w-9 h-5 bg-gray-200 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-${a.color}-500`})]})]},a.name)),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-calendar text-blue-500 text-[10px]"})}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Frequency"})]}),e.jsxs("select",{name:"backupFrequency",value:s.backupFrequency,onChange:m,className:"px-2 py-1.5 text-[10px] bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-archive text-amber-500 text-[10px]"})}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Retention"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("input",{type:"number",name:"backupRetention",value:s.backupRetention,onChange:m,min:"1",max:"365",className:"w-14 px-2 py-1.5 text-[10px] bg-gray-50 border border-gray-200 rounded-lg text-center"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:"days"})]})]})]}),e.jsx("div",{className:"px-3 py-2.5 border-t border-gray-100 bg-gray-50",children:e.jsx("button",{onClick:()=>B(),disabled:c,className:"w-full py-2.5 bg-red-500 hover:bg-red-600 text-white text-xs font-medium rounded-lg shadow-sm flex items-center justify-center gap-2 disabled:opacity-50",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save text-[10px]"}),"Save Settings"]})})})]})}),e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:e.jsxs("h6",{className:"text-[11px] font-bold text-gray-800 flex items-center gap-1.5",children:[e.jsx("i",{className:"fas fa-history text-red-500 text-[10px]"}),"Recent Backups",g.length>0&&e.jsx("span",{className:"bg-red-100 text-red-600 px-1.5 py-0.5 rounded-full text-[9px]",children:g.length})]})}),e.jsx("div",{className:"divide-y divide-gray-100 max-h-[40vh] overflow-y-auto",children:g.length>0?g.map((a,l)=>e.jsxs("div",{className:"px-3 py-3 flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${a.status==="completed"?"bg-emerald-100":"bg-red-100"}`,children:e.jsx("i",{className:`fas fa-${a.status==="completed"?"check":"times"} ${a.status==="completed"?"text-emerald-500":"text-red-500"} text-xs`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-xs font-semibold text-gray-800 capitalize",children:[a.backup_type," Backup"]}),e.jsx("p",{className:"text-[10px] text-gray-500",children:new Date(a.started_at).toLocaleString()})]})]},a.id||l)):e.jsxs("div",{className:"px-3 py-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-full bg-gray-100 flex items-center justify-center mb-3",children:e.jsx("i",{className:"fas fa-database text-gray-400 text-lg"})}),e.jsx("p",{className:"text-xs text-gray-600",children:"No backups yet"})]})})]})}),e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:j,disabled:c,className:"flex flex-col items-center gap-1 p-3 bg-white rounded-xl shadow-sm border border-gray-100 active:scale-95 disabled:opacity-50",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-amber-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-database text-amber-500 text-sm"})}),e.jsx("span",{className:"text-[9px] font-medium text-gray-700",children:"Backup"})]}),e.jsxs("button",{onClick:N,disabled:c,className:"flex flex-col items-center gap-1 p-3 bg-white rounded-xl shadow-sm border border-gray-100 active:scale-95 disabled:opacity-50",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-download text-emerald-500 text-sm"})}),e.jsx("span",{className:"text-[9px] font-medium text-gray-700",children:"Export"})]}),e.jsxs("button",{disabled:c,className:"flex flex-col items-center gap-1 p-3 bg-white rounded-xl shadow-sm border border-gray-100 active:scale-95 disabled:opacity-50",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-broom text-red-500 text-sm"})}),e.jsx("span",{className:"text-[9px] font-medium text-gray-700",children:"Clear"})]})]})}),e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3 flex items-start gap-2",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-amber-500 text-xs mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-semibold text-amber-800",children:"Storage Warning"}),e.jsx("p",{className:"text-[9px] text-amber-700",children:"~250 MB per backup"})]})]})}),e.jsx("div",{className:"block md:hidden mt-4 mb-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-shield-alt text-red-500 text-[10px]"})}),e.jsx("span",{className:"text-[10px] text-gray-500",children:"Admin Settings v2.0"})]}),e.jsxs("span",{className:"text-[9px] text-gray-400",children:["Last: ",$(s.lastBackupDate)]})]})}),e.jsxs("div",{className:"user-management-header mb-5 d-none d-md-block",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start flex-wrap",children:[e.jsx("div",{className:"header-content",children:e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"header-icon-container mr-3",children:e.jsx("i",{className:"fas fa-database"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"header-title mb-1",children:"Backup & Maintenance"}),e.jsx("p",{className:"header-subtitle mb-0",children:"Configure backup settings and manage database maintenance"})]})]})}),e.jsxs("div",{className:"header-actions d-flex align-items-center",children:[e.jsx("div",{className:"last-updated-info mr-3",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"far fa-clock mr-1"}),"Last: ",s.lastBackupDate?new Date(s.lastBackupDate).toLocaleString():"Never"]})}),e.jsxs("button",{className:"btn btn-outline-success btn-sm shadow-sm mr-2",onClick:N,disabled:c,children:[e.jsx("i",{className:"fas fa-download mr-1"}),"Export"]}),e.jsxs("button",{className:"btn btn-danger btn-sm shadow-sm",onClick:j,disabled:c,children:[e.jsx("i",{className:`fas fa-database mr-1 ${c?"fa-spin":""}`}),c?"Running...":"Backup"]})]})]}),e.jsx("div",{className:"dashboard-status-bar mt-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:`status-indicator ${t?.failed_backups===0?"status-online":"status-warning"} mr-2`}),e.jsx("span",{className:`small font-weight-medium ${t?.failed_backups===0?"text-success":"text-warning"}`,children:t?.failed_backups===0?"Backup system operational":`${t?.failed_backups} backup(s) failed`}),e.jsx("div",{className:"ml-auto",children:e.jsxs("span",{className:"badge badge-success badge-pill",children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),v,"% Success"]})})]})})]}),e.jsx("div",{className:"stats-section mb-5 d-none d-md-block",children:e.jsx("div",{className:"row",children:[{title:"Total Backups",value:t?.total_backups||0,sub:`${s.backupFrequency} schedule`,icon:"database",color:"danger"},{title:"Successful",value:t?.successful_backups||0,sub:`${v}% success`,icon:"check-circle",color:"success"},{title:"Failed",value:t?.failed_backups||0,sub:`${S}% failure`,icon:"exclamation-triangle",color:"warning"},{title:"Avg Duration",value:`${E}s`,sub:`${D}MB total`,icon:"clock",color:"info"}].map((a,l)=>e.jsx("div",{className:"col-xl-3 col-md-6 mb-4",children:e.jsxs("div",{className:`admin-stat-card admin-stat-card-${a.color} h-100 position-relative`,children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:`stat-title text-${a.color} text-uppercase mb-2`,children:a.title}),e.jsx("div",{className:"stat-value font-weight-bold text-gray-800",children:a.value}),e.jsxs("div",{className:"stat-change mt-2 text-muted",children:[e.jsx("i",{className:`fas fa-${a.icon} mr-1`}),a.sub]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:`stat-icon-container stat-icon-${a.color}`,children:e.jsx("i",{className:`fas fa-${a.icon} stat-icon`})})})]})})]})},l))})}),e.jsxs("div",{className:"row d-none d-md-flex",children:[e.jsx("div",{className:"col-xl-3 col-md-4 mb-4",children:e.jsx("div",{className:"card shadow border-0 h-100",children:e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"list-group list-group-flush",children:e.jsxs("button",{className:"list-group-item list-group-item-action active",children:[e.jsx("i",{className:"fas fa-database mr-2"}),"Backup & Maintenance"]})})})})}),e.jsx("div",{className:"col-xl-9 col-md-8",children:e.jsxs("div",{className:"card shadow mb-4",children:[e.jsx("div",{className:"card-header py-3 admin-card-header",children:e.jsx("h6",{className:"m-0 font-weight-bold text-danger",children:"Backup & Maintenance"})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:B,children:[e.jsxs("div",{className:"settings-section",children:[[{id:"autoBackupEnabled",label:"Enable Automatic Backups"},{id:"compressionEnabled",label:"Enable Compression"},{id:"encryptionEnabled",label:"Enable Encryption"},{id:"notificationEnabled",label:"Enable Notifications"},{id:"cleanupEnabled",label:"Enable Automatic Cleanup"}].map(a=>e.jsx("div",{className:"form-group row",children:e.jsx("div",{className:"col-sm-9 offset-sm-3",children:e.jsxs("div",{className:"custom-control custom-switch",children:[e.jsx("input",{type:"checkbox",className:"custom-control-input",id:a.id,name:a.id,checked:s[a.id],onChange:m}),e.jsx("label",{className:"custom-control-label",htmlFor:a.id,children:a.label})]})})},a.id)),e.jsxs("div",{className:"form-group row",children:[e.jsx("label",{className:"col-sm-3 col-form-label",children:"Frequency"}),e.jsx("div",{className:"col-sm-9",children:e.jsxs("select",{className:"form-control",name:"backupFrequency",value:s.backupFrequency,onChange:m,children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})})]}),e.jsxs("div",{className:"form-group row",children:[e.jsx("label",{className:"col-sm-3 col-form-label",children:"Retention (days)"}),e.jsx("div",{className:"col-sm-9",children:e.jsx("input",{type:"number",className:"form-control",name:"backupRetention",value:s.backupRetention,onChange:m,min:"1",max:"365"})})]}),e.jsxs("div",{className:"form-group row",children:[e.jsx("label",{className:"col-sm-3 col-form-label",children:"Storage"}),e.jsx("div",{className:"col-sm-9",children:e.jsxs("select",{className:"form-control",name:"storageLocation",value:s.storageLocation,onChange:m,children:[e.jsx("option",{value:"supabase_storage",children:"Supabase"}),e.jsx("option",{value:"local_storage",children:"Local"}),e.jsx("option",{value:"cloud_storage",children:"Cloud"})]})})]}),e.jsxs("div",{className:"form-group row",children:[e.jsx("label",{className:"col-sm-3 col-form-label",children:"Max Size (MB)"}),e.jsx("div",{className:"col-sm-9",children:e.jsx("input",{type:"number",className:"form-control",name:"maxSizeMB",value:s.maxSizeMB,onChange:m,min:"100",max:"10000"})})]}),e.jsxs("div",{className:"form-group row",children:[e.jsx("label",{className:"col-sm-3 col-form-label",children:"Last Backup"}),e.jsx("div",{className:"col-sm-9",children:e.jsx("div",{className:"form-control-static",children:s.lastBackupDate?new Date(s.lastBackupDate).toLocaleString():"Never"})})]}),e.jsx("div",{className:"form-group row",children:e.jsxs("div",{className:"col-sm-9 offset-sm-3",children:[e.jsxs("button",{type:"button",className:"btn btn-warning mr-2",onClick:j,disabled:c,children:[e.jsx("i",{className:"fas fa-database mr-1"}),"Run Manual Backup"]}),e.jsxs("button",{type:"button",className:"btn btn-success mr-2",onClick:N,disabled:c,children:[e.jsx("i",{className:"fas fa-download mr-1"}),"Export Database"]}),e.jsxs("button",{type:"button",className:"btn btn-danger",disabled:c,children:[e.jsx("i",{className:"fas fa-broom mr-1"}),"Clear Cache"]})]})}),e.jsxs("div",{className:"alert alert-warning mt-4",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-1"}),e.jsx("strong",{children:"Warning:"})," Estimated size: 250 MB per backup."]})]}),e.jsx("div",{className:"border-top pt-3 mt-4",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save mr-1"}),"Save Changes"]})}),e.jsxs("small",{className:"text-muted",children:["Last updated: ",new Date().toLocaleString()]})]})})]})})]})})]})]})};export{O as default};
