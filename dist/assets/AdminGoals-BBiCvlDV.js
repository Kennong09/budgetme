import{j as e}from"./ui-vendor-Cn1Vfl4w.js";import{r as y}from"./react-vendor-D4A9EtXC.js";import{t as K,z as Q,f as _,g as ae,d as q,b as Z,p as V}from"./index-BbApZ7g3.js";import"./chart-vendor-B0c7K_uV.js";const fe=({show:l,onClose:c,title:s,icon:S,color:w,data:i})=>l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:c}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:c,children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:a=>a.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"modal-header bg-gradient-danger text-white border-0",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center",children:[e.jsx("div",{className:"modal-icon-container mr-3",style:{width:"45px",height:"45px",borderRadius:"12px",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("i",{className:`fas ${S}`,style:{fontSize:"1.25rem"}})}),e.jsxs("div",{children:[e.jsx("div",{className:"modal-title-main font-weight-bold",children:s}),e.jsx("div",{className:"modal-subtitle",style:{opacity:.85,fontSize:"0.85rem"},children:"Detailed breakdown"})]})]}),e.jsx("button",{type:"button",className:"close text-white",onClick:c,style:{textShadow:"none",opacity:.9},children:e.jsx("span",{children:"×"})})]}),e.jsx("div",{className:"modal-body bg-white p-0",children:e.jsx("div",{className:"stats-breakdown-list",children:i.map((a,o)=>e.jsxs("div",{className:"stats-breakdown-item d-flex justify-content-between align-items-center py-3 px-4",style:{borderBottom:o<i.length-1?"1px solid #f0f0f0":"none",transition:"background-color 0.2s ease"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-weight-medium text-gray-800",children:a.label}),a.subLabel&&e.jsx("small",{className:"text-muted",children:a.subLabel})]}),e.jsx("span",{className:`badge badge-${w} badge-pill px-3 py-2`,style:{fontSize:"0.9rem",fontWeight:600,minWidth:"60px",textAlign:"center"},children:a.value})]},o))})}),e.jsx("div",{className:"modal-footer bg-light border-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsx("div",{className:"modal-footer-info",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-info-circle mr-1 text-danger"}),"Data reflects current statistics"]})}),e.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:c,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Close"]})]})})]})})})]}):null,ne=({summary:l,loading:c=!1})=>{const[s,S]=y.useState({show:!1,title:"",icon:"",color:"",data:[]});if(c)return e.jsx("div",{className:"stats-section mb-5",children:e.jsx("div",{className:"row",children:Array.from({length:4}).map((u,g)=>e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsx("div",{className:"card shadow h-100 py-3 admin-card admin-card-loading",children:e.jsxs("div",{className:"card-body text-center",children:[e.jsx("div",{className:"skeleton-line skeleton-stat-value mb-2"}),e.jsx("div",{className:"skeleton-line skeleton-stat-title"})]})})},g))})});const w=l.activeGoals,i=l.totalGoals>0?(w/l.totalGoals*100).toFixed(1):"0",a=l.totalGoals>0?(l.completedGoals/l.totalGoals*100).toFixed(1):"0",o=l.overallProgress.toFixed(1),h=()=>{S({show:!0,title:"Total Goals Breakdown",icon:"fa-bullseye",color:"danger",data:[{label:"Total Goals",value:l.totalGoals},{label:"Active Goals",value:w,subLabel:`${i}% of total`},{label:"Completed Goals",value:l.completedGoals,subLabel:`${a}% of total`},{label:"Overdue Goals",value:l.overdueGoals}]})},x=()=>{S({show:!0,title:"Active Goals Breakdown",icon:"fa-play-circle",color:"success",data:[{label:"Active Goals",value:w},{label:"Percentage of Total",value:`${i}%`},{label:"High Priority",value:l.goalsByPriority.high},{label:"Medium Priority",value:l.goalsByPriority.medium},{label:"Low Priority",value:l.goalsByPriority.low},{label:"Overdue Goals",value:l.overdueGoals}]})},t=()=>{S({show:!0,title:"Target Amount Breakdown",icon:"fa-chart-line",color:"warning",data:[{label:"Total Target",value:_(l.totalTargetAmount)},{label:"Total Saved",value:_(l.totalCurrentAmount)},{label:"Remaining Amount",value:_(l.totalRemainingAmount)},{label:"Overall Progress",value:`${o}%`},{label:"Average Progress",value:`${l.averageProgress.toFixed(1)}%`}]})},k=()=>{S({show:!0,title:"Progress Overview",icon:"fa-percentage",color:"info",data:[{label:"Overall Progress",value:`${o}%`},{label:"Average Progress",value:`${l.averageProgress.toFixed(1)}%`},{label:"Completed This Month",value:l.goalsCompletedThisMonth},{label:"Total Saved",value:_(l.totalCurrentAmount)},{label:"Remaining to Save",value:_(l.totalRemainingAmount)}]})};return e.jsxs("div",{className:"stats-section mb-5",children:[e.jsx(fe,{show:s.show,onClose:()=>S({...s,show:!1}),title:s.title,icon:s.icon,color:s.color,data:s.data}),e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:h,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-red-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-bullseye text-red-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Total Goals"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:K(l.totalGoals)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-gray-400",children:[e.jsx("i",{className:"fas fa-flag text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium truncate",children:[l.overdueGoals," overdue"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:x,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-emerald-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-play-circle text-emerald-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Active Goals"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:K(w)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-emerald-500",children:[e.jsx("i",{className:"fas fa-arrow-up text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium truncate",children:[i,"% of total"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:t,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-amber-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-chart-line text-amber-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Total Target"}),e.jsx("p",{className:"text-sm font-bold text-gray-800 truncate",children:Q(l.totalTargetAmount)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-amber-500",children:[e.jsx("i",{className:"fas fa-piggy-bank text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium truncate",children:[Q(l.totalCurrentAmount)," saved"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:k,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-blue-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-percentage text-blue-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Overall Progress"}),e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:[o,"%"]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-blue-500",children:[e.jsx("i",{className:"fas fa-check-circle text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium truncate",children:[l.completedGoals," completed"]})]})]})]})}),e.jsxs("div",{className:"row d-none d-md-flex",children:[e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-danger h-100 position-relative",onClick:h,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-danger text-uppercase mb-2",children:"Total Goals"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:K(l.totalGoals)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-muted",children:[e.jsx("i",{className:"fas fa-flag mr-1"}),e.jsxs("span",{className:"font-weight-medium text-truncate",children:[l.overdueGoals," overdue"]})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-danger",children:e.jsx("i",{className:"fas fa-bullseye stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-danger",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-success h-100 position-relative",onClick:x,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-success text-uppercase mb-2",children:"Active Goals"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:K(w)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-success",children:[e.jsx("i",{className:"fas fa-arrow-up mr-1"}),e.jsxs("span",{className:"font-weight-medium",children:[i,"%"]}),e.jsx("span",{className:"ml-1 small text-truncate",children:"of total"})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-success",children:e.jsx("i",{className:"fas fa-play-circle stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-success",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-warning h-100 position-relative",onClick:t,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-warning text-uppercase mb-2",children:"Total Target"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800 text-truncate",children:Q(l.totalTargetAmount)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-warning",children:[e.jsx("i",{className:"fas fa-piggy-bank mr-1"}),e.jsx("span",{className:"font-weight-medium text-truncate",children:Q(l.totalCurrentAmount)}),e.jsx("span",{className:"ml-1 small text-truncate",children:"saved"})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-warning",children:e.jsx("i",{className:"fas fa-chart-line stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-warning",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-info h-100 position-relative",onClick:k,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-info text-uppercase mb-2",children:"Overall Progress"}),e.jsxs("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:[o,"%"]}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-info",children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),e.jsx("span",{className:"font-weight-medium",children:l.completedGoals}),e.jsx("span",{className:"ml-1 small text-truncate",children:"completed"})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-info",children:e.jsx("i",{className:"fas fa-percentage stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-info",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})})]})]})},ie=({filters:l,users:c,categories:s,onFiltersChange:S,onClearFilters:w,loading:i=!1})=>{const[a,o]=y.useState(!1),h=(t,k)=>{S({[t]:k})},x=()=>l.search!==""||l.priority!==""||l.status!==""||l.user!==""||l.category!==""||l.startDate!==""||l.endDate!==""||l.minAmount!==""||l.maxAmount!==""||l.minProgress!==""||l.maxProgress!==""||l.isOverdue;return i?e.jsxs("div",{className:"controls-section mb-4",children:[e.jsx("div",{className:"block md:hidden",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden p-3",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded-lg mb-2"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded-lg flex-1"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded-lg flex-1"})]})]})})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"skeleton-line skeleton-search-bar"})}),e.jsx("div",{className:"col-md-3",children:e.jsx("div",{className:"skeleton-line skeleton-filter"})}),e.jsx("div",{className:"col-md-3",children:e.jsx("div",{className:"skeleton-line skeleton-filter"})})]})})})})]}):e.jsxs("div",{className:"controls-section mb-4",children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2 border-b border-gray-100 bg-gray-50",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-[10px]"}),e.jsx("input",{type:"text",className:"w-full pl-8 pr-3 py-2 text-xs bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",placeholder:"Search goals...",value:l.search,onChange:t=>h("search",t.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{className:"flex-1 px-2 py-1.5 text-[10px] bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",value:l.priority,onChange:t=>h("priority",t.target.value),children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{className:"flex-1 px-2 py-1.5 text-[10px] bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",value:l.status,onChange:t=>h("status",t.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"})]}),x()&&e.jsx("button",{className:"px-2 py-1.5 text-[10px] bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",onClick:w,children:e.jsx("i",{className:"fas fa-times"})})]})]}),e.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[e.jsxs("button",{className:"text-[10px] text-red-600 flex items-center gap-1",onClick:()=>o(!a),children:[e.jsx("i",{className:`fas ${a?"fa-chevron-up":"fa-filter"} text-[8px]`}),a?"Hide Filters":"More Filters"]}),e.jsxs("span",{className:"text-[9px] text-gray-400",children:["Show: ",l.pageSize," per page"]})]}),a&&e.jsxs("div",{className:"px-3 py-2 border-t border-gray-100 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsxs("select",{className:"px-2 py-1.5 text-[10px] bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",value:l.user,onChange:t=>h("user",t.target.value),children:[e.jsx("option",{value:"",children:"All Users"}),c.slice(0,20).map(t=>e.jsx("option",{value:t.id,children:t.user_metadata?.full_name||t.email.split("@")[0]},t.id))]}),e.jsx("input",{type:"text",className:"px-2 py-1.5 text-[10px] bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",placeholder:"Category",value:l.category,onChange:t=>h("category",t.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsx("input",{type:"date",className:"px-2 py-1.5 text-[10px] bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",placeholder:"Start Date",value:l.startDate,onChange:t=>h("startDate",t.target.value)}),e.jsx("input",{type:"date",className:"px-2 py-1.5 text-[10px] bg-white border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",placeholder:"End Date",value:l.endDate,onChange:t=>h("endDate",t.target.value)})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("label",{className:"flex items-center gap-1 text-[10px] text-gray-600",children:[e.jsx("input",{type:"checkbox",className:"w-3 h-3 rounded border-gray-300 text-red-500 focus:ring-red-200",checked:l.isOverdue,onChange:t=>h("isOverdue",t.target.checked)}),e.jsx("span",{children:"Overdue Only"})]})})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"card shadow-sm",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-6 col-lg-4 mb-3 mb-md-0",children:e.jsx("div",{className:"search-container",children:e.jsxs("div",{className:"input-group",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("span",{className:"input-group-text bg-white border-right-0",children:e.jsx("i",{className:"fas fa-search text-muted"})})}),e.jsx("input",{type:"text",className:"form-control border-left-0 modern-input",placeholder:"Search goals by name or category...",value:l.search,onChange:t=>h("search",t.target.value)})]})})}),e.jsx("div",{className:"col-md-3 col-lg-2 mb-3 mb-md-0",children:e.jsxs("select",{className:"form-control modern-select",value:l.priority,onChange:t=>h("priority",t.target.value),children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"high",children:"High Priority"}),e.jsx("option",{value:"medium",children:"Medium Priority"}),e.jsx("option",{value:"low",children:"Low Priority"})]})}),e.jsx("div",{className:"col-md-3 col-lg-2 mb-3 mb-md-0",children:e.jsxs("select",{className:"form-control modern-select",value:l.status,onChange:t=>h("status",t.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"})]})}),e.jsx("div",{className:"col-md-12 col-lg-4",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"page-size-selector",children:[e.jsx("small",{className:"text-muted mr-2",children:"Show:"}),e.jsxs("select",{className:"form-control form-control-sm d-inline-block w-auto",value:l.pageSize,onChange:t=>h("pageSize",Number(t.target.value)),children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"})]}),e.jsx("small",{className:"text-muted ml-2",children:"per page"})]}),x()&&e.jsxs("button",{className:"btn btn-outline-secondary btn-sm",onClick:w,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Clear Filters"]})]})})]}),a&&e.jsxs("div",{className:"row mt-3",children:[e.jsx("div",{className:"col-md-3 mb-3",children:e.jsxs("select",{className:"form-control modern-select",value:l.user,onChange:t=>h("user",t.target.value),children:[e.jsx("option",{value:"",children:"All Users"}),c.map(t=>e.jsx("option",{value:t.id,children:t.user_metadata?.full_name||t.email},t.id))]})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx("input",{type:"text",className:"form-control modern-input",placeholder:"Category",value:l.category,onChange:t=>h("category",t.target.value)})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx("input",{type:"date",className:"form-control modern-input",placeholder:"Start Date",value:l.startDate,onChange:t=>h("startDate",t.target.value)})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx("input",{type:"date",className:"form-control modern-input",placeholder:"End Date",value:l.endDate,onChange:t=>h("endDate",t.target.value)})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx("input",{type:"number",className:"form-control modern-input",placeholder:"Min Amount",step:"0.01",value:l.minAmount,onChange:t=>h("minAmount",t.target.value)})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx("input",{type:"number",className:"form-control modern-input",placeholder:"Max Amount",step:"0.01",value:l.maxAmount,onChange:t=>h("maxAmount",t.target.value)})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx("input",{type:"number",className:"form-control modern-input",placeholder:"Min Progress %",min:"0",max:"100",value:l.minProgress,onChange:t=>h("minProgress",t.target.value)})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsxs("div",{className:"custom-control custom-checkbox",children:[e.jsx("input",{type:"checkbox",className:"custom-control-input",id:"overdueOnly",checked:l.isOverdue,onChange:t=>h("isOverdue",t.target.checked)}),e.jsxs("label",{className:"custom-control-label",htmlFor:"overdueOnly",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-warning mr-1"}),"Overdue Goals Only"]})]})})]}),e.jsx("div",{className:"row mt-2",children:e.jsxs("div",{className:"col-12",children:[e.jsxs("button",{className:"btn btn-outline-primary btn-sm",onClick:()=>o(!a),children:[e.jsx("i",{className:`fas ${a?"fa-chevron-up":"fa-filter"} mr-1`}),a?"Hide Advanced Filters":"Advanced Filters"]}),e.jsx("div",{className:"float-right",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("small",{className:"text-muted mr-2",children:"Sort by:"}),e.jsxs("select",{className:"form-control form-control-sm mr-2",style:{width:"auto"},value:l.sortBy,onChange:t=>h("sortBy",t.target.value),children:[e.jsx("option",{value:"goal_name",children:"Name"}),e.jsx("option",{value:"target_date",children:"Target Date"}),e.jsx("option",{value:"created_at",children:"Created Date"}),e.jsx("option",{value:"target_amount",children:"Target Amount"}),e.jsx("option",{value:"current_amount",children:"Current Amount"}),e.jsx("option",{value:"priority",children:"Priority"}),e.jsx("option",{value:"status",children:"Status"})]}),e.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>h("sortOrder",l.sortOrder==="asc"?"desc":"asc"),title:`Sort ${l.sortOrder==="asc"?"Descending":"Ascending"}`,children:e.jsx("i",{className:`fas fa-sort-${l.sortOrder==="asc"?"up":"down"}`})})]})})]})})]})})})]})},de=({goals:l,filters:c,totalPages:s,totalItems:S,loading:w=!1,onSort:i,onPageChange:a,onGoalSelect:o,onGoalEdit:h,onGoalDelete:x})=>{const[t,k]=y.useState(null),u=r=>{k(t===r?null:r)},g=()=>{k(null)};y.useEffect(()=>{const r=n=>{t&&!n.target.closest(".dropdown-menu")&&!n.target.closest(".dropdown-toggle")&&g()};if(t)return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[t]);const E=r=>{switch(r){case"high":return"badge-danger";case"medium":return"badge-warning";case"low":return"badge-info";default:return"badge-secondary"}},T=r=>r>=100?"success":r>=75?"info":r>=50?"primary":r>=25?"warning":"danger",b=r=>c.sortBy!==r?e.jsx("i",{className:"fas fa-sort text-muted ml-1"}):e.jsx("i",{className:`fas fa-sort-${c.sortOrder==="asc"?"up":"down"} text-primary ml-1`});return w?e.jsxs("div",{className:"table-section",children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 animate-pulse"})}),e.jsx("div",{className:"divide-y divide-gray-100",children:Array.from({length:5}).map((r,n)=>e.jsx("div",{className:"px-3 py-3 animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-1/2"})]}),e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded-full"})]})},n))})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header py-3",children:e.jsx("div",{className:"skeleton-line skeleton-table-header"})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table modern-table",children:[e.jsx("thead",{className:"table-header",children:e.jsx("tr",{children:Array.from({length:7}).map((r,n)=>e.jsx("th",{children:e.jsx("div",{className:"skeleton-line skeleton-th"})},n))})}),e.jsx("tbody",{children:Array.from({length:5}).map((r,n)=>e.jsx("tr",{className:"table-row",children:Array.from({length:7}).map((D,F)=>e.jsx("td",{children:e.jsx("div",{className:"skeleton-line skeleton-td"})},F))},n))})]})})})]})})]}):e.jsxs("div",{className:"table-section",children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2.5 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-bullseye text-red-500 text-[10px]"})}),e.jsxs("span",{className:"text-xs font-semibold text-gray-700",children:["Goals (",S,")"]})]}),e.jsxs("span",{className:"text-[9px] text-gray-400",children:[Math.min((c.currentPage-1)*c.pageSize+1,S),"-",Math.min(c.currentPage*c.pageSize,S)]})]}),l.length===0?e.jsxs("div",{className:"px-4 py-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-3",children:e.jsx("i",{className:"fas fa-bullseye text-gray-400 text-lg"})}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"No goals found"}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Try adjusting your filters"})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:l.map(r=>{const n=r.target_amount>0?Math.min(r.current_amount/r.target_amount*100,100):0,D=ae(r.target_date),F=D<0&&r.status!=="completed",v=n>=100?"completed":"active";return e.jsx("div",{className:"px-3 py-3 hover:bg-gray-50 transition-colors active:bg-gray-100",onClick:()=>o(r),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${v==="completed"?"bg-green-100":"bg-red-100"}`,children:e.jsx("i",{className:`fas ${v==="completed"?"fa-check-circle text-green-500":"fa-bullseye text-red-500"} text-sm`})}),e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-4 h-4 rounded-full bg-white border border-gray-200 flex items-center justify-center",title:`${n.toFixed(0)}%`,children:e.jsx("span",{className:"text-[7px] font-bold text-gray-600",children:Math.round(n)})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-800 truncate",children:r.goal_name}),r.is_family_goal&&e.jsxs("span",{className:"flex-shrink-0 px-1 py-0.5 text-[7px] font-medium bg-blue-100 text-blue-600 rounded",children:[e.jsx("i",{className:"fas fa-users text-[6px] mr-0.5"}),"Family"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("span",{className:"text-[10px] text-gray-500",children:r.user_name||r.user_email}),r.category&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-300",children:"•"}),e.jsx("span",{className:"text-[10px] text-gray-400 truncate",children:r.category})]})]}),e.jsx("div",{className:"mb-1.5",children:e.jsx("div",{className:"h-1.5 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${n>=100?"bg-green-500":n>=75?"bg-blue-500":n>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(n,100)}%`}})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-[10px] font-medium text-gray-700",children:[_(r.current_amount)," / ",_(r.target_amount)]})}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:`px-1.5 py-0.5 text-[8px] font-semibold rounded-full ${r.priority==="high"?"bg-red-100 text-red-600":r.priority==="medium"?"bg-amber-100 text-amber-600":"bg-blue-100 text-blue-600"}`,children:r.priority.toUpperCase()}),e.jsx("span",{className:`text-[9px] ${F?"text-red-500 font-medium":"text-gray-400"}`,children:F?`${Math.abs(D)}d late`:`${D}d`})]})]})]}),e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("button",{className:"w-7 h-7 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 transition-colors",onClick:j=>{j.stopPropagation(),u(r.id)},onTouchEnd:j=>{j.stopPropagation(),u(r.id)},"aria-label":"More actions",children:e.jsx("i",{className:"fas fa-ellipsis-v text-[10px]"})}),t===r.id&&e.jsxs("div",{className:"dropdown-menu fixed w-28 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",style:{display:"block",zIndex:99999,transform:"translateX(-84px) translateY(4px)"},children:[e.jsxs("button",{className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50 active:bg-gray-100 flex items-center gap-2 transition-colors",onClick:j=>{j.stopPropagation(),g(),o(r)},onTouchEnd:j=>{j.stopPropagation(),g(),o(r)},children:[e.jsx("i",{className:"fas fa-eye text-blue-500 text-[10px]"}),e.jsx("span",{className:"text-gray-700",children:"View"})]}),e.jsxs("button",{className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50 active:bg-gray-100 flex items-center gap-2 transition-colors",onClick:j=>{j.stopPropagation(),g(),h(r)},onTouchEnd:j=>{j.stopPropagation(),g(),h(r)},children:[e.jsx("i",{className:"fas fa-edit text-amber-500 text-[10px]"}),e.jsx("span",{className:"text-gray-700",children:"Edit"})]}),e.jsxs("button",{className:"w-full px-3 py-2 text-left text-xs hover:bg-red-50 active:bg-red-100 flex items-center gap-2 transition-colors",onClick:j=>{j.stopPropagation(),g(),x(r)},onTouchEnd:j=>{j.stopPropagation(),g(),x(r)},children:[e.jsx("i",{className:"fas fa-trash text-red-500 text-[10px]"}),e.jsx("span",{className:"text-red-600",children:"Delete"})]})]})]})]})},r.id)})}),s>1&&e.jsxs("div",{className:"px-3 py-2.5 border-t border-gray-100 flex items-center justify-between bg-gray-50",children:[e.jsxs("button",{className:"px-2.5 py-1.5 text-[10px] bg-white border border-gray-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition-colors",onClick:()=>a(Math.max(c.currentPage-1,1)),disabled:c.currentPage===1,children:[e.jsx("i",{className:"fas fa-chevron-left mr-1"}),"Prev"]}),e.jsxs("span",{className:"text-[10px] text-gray-500 font-medium",children:[c.currentPage," / ",s]}),e.jsxs("button",{className:"px-2.5 py-1.5 text-[10px] bg-white border border-gray-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition-colors",onClick:()=>a(Math.min(c.currentPage+1,s)),disabled:c.currentPage===s,children:["Next",e.jsx("i",{className:"fas fa-chevron-right ml-1"})]})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header bg-white border-0 py-3",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"m-0 font-weight-bold text-danger",children:[e.jsx("i",{className:"fas fa-table mr-2"}),"Goals (",S,")"]}),e.jsx("div",{className:"table-actions",children:e.jsxs("small",{className:"text-muted",children:["Showing ",Math.min((c.currentPage-1)*c.pageSize+1,S)," to ",Math.min(c.currentPage*c.pageSize,S)," of ",S," entries"]})})]})}),e.jsx("div",{className:"card-body p-0",children:l.length===0?e.jsx("div",{className:"text-center py-5",children:e.jsxs("div",{className:"empty-state-container",children:[e.jsx("i",{className:"fas fa-bullseye fa-4x text-gray-300 mb-4"}),e.jsx("h4",{className:"text-gray-700 mb-3",children:Object.values(c).some(r=>r!==""&&r!=="goal_name"&&r!=="desc"&&r!==1&&r!==10&&r!==!1)?"No Matching Goals":"No Goals Yet"}),e.jsx("p",{className:"text-muted mb-4 max-width-sm mx-auto",children:Object.values(c).some(r=>r!==""&&r!=="goal_name"&&r!=="desc"&&r!==1&&r!==10&&r!==!1)?"Try adjusting your filters or search criteria to find the goals you're looking for.":"Users haven't created any goals yet. Once they start adding goals, they will appear here."})]})}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover modern-table mb-0",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>i("goal_name"),children:["Goal ",b("goal_name")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>i("user_id"),children:["User ",b("user_id")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>i("target_amount"),children:["Target Amount ",b("target_amount")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>i("current_amount"),children:["Progress ",b("current_amount")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>i("target_date"),children:["Target Date ",b("target_date")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>i("priority"),children:["Priority ",b("priority")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>i("status"),children:["Status ",b("status")]}),e.jsx("th",{className:"border-0 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:l.map(r=>{const n=r.target_amount>0?Math.min(r.current_amount/r.target_amount*100,100):0,D=ae(r.target_date),F=D<0&&r.status!=="completed";return e.jsxs("tr",{className:"table-row",children:[e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"goal-info cursor-pointer",onClick:()=>o(r),children:[e.jsx("div",{className:"goal-name font-weight-bold text-primary",children:r.goal_name}),r.category&&e.jsxs("div",{className:"goal-category text-muted small",children:[e.jsx("i",{className:"fas fa-tag mr-1"}),r.category]})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{className:"user-avatar-container mr-3",children:[e.jsx("img",{src:r.user_avatar||"../images/placeholder.png",alt:r.user_name||"User",className:"user-table-avatar",onError:v=>{v.currentTarget.src="../images/placeholder.png"}}),e.jsx("div",{className:`user-status-dot status-${r.status||"inactive"}`})]}),e.jsxs("div",{className:"user-info",children:[e.jsx("div",{className:"user-name font-weight-medium",children:r.user_name||r.user_email||"Unknown User"}),r.is_family_goal&&e.jsxs("span",{className:"badge badge-info badge-sm",children:[e.jsx("i",{className:"fas fa-users mr-1"}),"Family Goal"]})]})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"target-amount",children:[e.jsx("div",{className:"font-weight-bold",children:_(r.target_amount)}),e.jsxs("div",{className:"text-muted small",children:[_(r.current_amount)," saved"]})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"goal-progress",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsxs("span",{className:"small font-weight-bold",children:[n.toFixed(1),"%"]}),e.jsxs("span",{className:"small text-muted",children:[_(r.target_amount-r.current_amount)," left"]})]}),e.jsx("div",{className:"progress",style:{height:"8px"},children:e.jsx("div",{className:`progress-bar bg-${T(n)}`,role:"progressbar",style:{width:`${Math.min(n,100)}%`}})})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"target-date",children:[e.jsxs("div",{className:`font-weight-medium ${F?"text-danger":""}`,children:[q(r.target_date),F&&e.jsx("i",{className:"fas fa-exclamation-triangle text-danger ml-1",title:"Overdue"})]}),e.jsx("div",{className:`text-muted small ${F?"text-danger":D<30?"text-warning":""}`,children:F?`${Math.abs(D)} days overdue`:`${D} days left`})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("span",{className:`badge ${E(r.priority)} p-2`,children:[e.jsx("i",{className:`fas ${r.priority==="high"?"fa-exclamation":r.priority==="medium"?"fa-minus":"fa-arrow-down"} mr-1`}),r.priority.charAt(0).toUpperCase()+r.priority.slice(1)]})}),e.jsx("td",{className:"py-3",children:(()=>{const j=(r.target_amount>0?r.current_amount/r.target_amount*100:0)>=100?"completed":"active";return e.jsxs("span",{className:`badge ${j==="completed"?"badge-success":"badge-primary"} p-2`,children:[e.jsx("i",{className:`fas ${j==="active"?"fa-play":"fa-check-circle"} mr-1`}),j==="active"?"Active":"Completed"]})})()}),e.jsx("td",{className:"py-3 text-center",children:e.jsxs("div",{className:"position-relative d-inline-block",children:[e.jsx("button",{className:"dropdown-toggle btn btn-sm btn-outline-secondary",onClick:v=>{v.stopPropagation(),u(r.id)},title:"Actions",children:e.jsx("i",{className:"fas fa-ellipsis-v"})}),t===r.id&&e.jsxs("div",{className:"dropdown-menu show position-absolute",style:{right:0,top:"100%",zIndex:1050,minWidth:"140px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsxs("button",{className:"dropdown-item d-flex align-items-center py-2",onClick:v=>{v.stopPropagation(),g(),o(r)},children:[e.jsx("i",{className:"fas fa-eye text-primary mr-2",style:{width:"16px"}}),"View Details"]}),e.jsxs("button",{className:"dropdown-item d-flex align-items-center py-2",onClick:v=>{v.stopPropagation(),g(),h(r)},children:[e.jsx("i",{className:"fas fa-edit text-warning mr-2",style:{width:"16px"}}),"Edit Goal"]}),e.jsx("div",{className:"dropdown-divider"}),e.jsxs("button",{className:"dropdown-item d-flex align-items-center py-2 text-danger",onClick:v=>{v.stopPropagation(),g(),x(r)},children:[e.jsx("i",{className:"fas fa-trash mr-2",style:{width:"16px"}}),"Delete Goal"]})]})]})})]},r.id)})})]})})}),s>1&&e.jsx("div",{className:"card-footer bg-white border-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("div",{className:"pagination-info",children:e.jsxs("small",{className:"text-muted",children:["Page ",c.currentPage," of ",s]})}),e.jsx("nav",{"aria-label":"Goal pagination",children:e.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[e.jsx("li",{className:`page-item ${c.currentPage===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>a(1),disabled:c.currentPage===1,children:e.jsx("i",{className:"fas fa-angle-double-left"})})}),e.jsx("li",{className:`page-item ${c.currentPage===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>a(Math.max(c.currentPage-1,1)),disabled:c.currentPage===1,children:e.jsx("i",{className:"fas fa-angle-left"})})}),Array.from({length:Math.min(5,s)},(r,n)=>{let D;return s<=5||c.currentPage<=3?D=n+1:c.currentPage>=s-2?D=s-4+n:D=c.currentPage-2+n,e.jsx("li",{className:`page-item ${c.currentPage===D?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>a(D),children:D})},D)}),e.jsx("li",{className:`page-item ${c.currentPage===s?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>a(Math.min(c.currentPage+1,s)),disabled:c.currentPage===s,children:e.jsx("i",{className:"fas fa-angle-right"})})}),e.jsx("li",{className:`page-item ${c.currentPage===s?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>a(s),disabled:c.currentPage===s,children:e.jsx("i",{className:"fas fa-angle-double-right"})})})]})})]})})]})}),e.jsx("style",{children:`
        .cursor-pointer {
          cursor: pointer;
        }
        
        .goal-info:hover .goal-name {
          text-decoration: underline;
        }
        
        .user-table-avatar {
          width: 40px;
          height: 40px;
          border-radius: 50%;
          object-fit: cover;
        }
        
        .user-avatar-container {
          position: relative;
        }
        
        .user-status-dot {
          position: absolute;
          bottom: 2px;
          right: 2px;
          width: 12px;
          height: 12px;
          border-radius: 50%;
          border: 2px solid white;
        }
        
        .status-active { background-color: #28a745; }
        .status-completed { background-color: #17a2b8; }
        .status-paused { background-color: #28a745; } /* Treat paused as active */
        .status-cancelled { background-color: #28a745; } /* Treat cancelled as active */
        .status-inactive { background-color: #6c757d; }
        
        .goal-progress .progress {
          background-color: #e9ecef;
        }
        
        .action-buttons .btn {
          transition: all 0.15s ease-in-out;
        }
        
        .action-buttons .btn:hover {
          transform: translateY(-1px);
        }
        
        .table-row:hover {
          background-color: #f8f9fa;
        }
        
        .badge-sm {
          font-size: 0.75rem;
          padding: 0.25rem 0.5rem;
        }
        
        .empty-state-container {
          max-width: 400px;
          margin: 0 auto;
        }
        
        .max-width-sm {
          max-width: 300px;
        }
      `})]})},je=({show:l,onClose:c,onGoalAdded:s,users:S,categories:w})=>{const[i,a]=y.useState({goal_name:"",target_amount:0,current_amount:0,target_date:"",priority:"medium",status:"active",category:"",notes:"",user_id:"",family_id:""}),[o,h]=y.useState(!1),[x,t]=y.useState({}),[k,u]=y.useState(""),[g,E]=y.useState(!1),{showSuccessToast:T,showErrorToast:b}=Z(),r=()=>{const m={};if(i.goal_name.trim()?i.goal_name.trim().length<3&&(m.goal_name="Goal name must be at least 3 characters"):m.goal_name="Goal name is required",i.user_id||(m.user_id="Please select a user"),i.target_amount<=0?m.target_amount="Target amount must be greater than 0":i.target_amount>999999999&&(m.target_amount="Target amount is too large"),i.current_amount<0?m.current_amount="Current amount cannot be negative":i.current_amount>i.target_amount&&(m.current_amount="Current amount cannot exceed target amount"),!i.target_date)m.target_date="Target date is required";else{const N=new Date(i.target_date),M=new Date;M.setHours(0,0,0,0),N<=M&&(m.target_date="Target date must be in the future")}return t(m),Object.keys(m).length===0},n=m=>{const{name:N,value:M,type:A}=m.target;a(L=>({...L,[N]:A==="number"?parseFloat(M)||0:M})),x[N]&&t(L=>({...L,[N]:""}))},D=m=>{a(N=>({...N,user_id:m.id})),u(""),E(!1),x.user_id&&t(N=>({...N,user_id:""}))},F=m=>{u(m.target.value),E(!0),i.user_id&&m.target.value!==""&&a(N=>({...N,user_id:""}))},v=S.filter(m=>{if(!k)return!0;const N=k.toLowerCase(),M=m.user_metadata?.full_name?.toLowerCase()||"",A=m.email.toLowerCase();return M.includes(N)||A.includes(N)}),j=S.find(m=>m.id===i.user_id),z=i.target_amount>0?Math.min(i.current_amount/i.target_amount*100,100):0,I=async m=>{if(m.preventDefault(),!!r()){h(!0);try{const N={user_id:i.user_id,goal_name:i.goal_name.trim(),target_amount:i.target_amount,current_amount:i.current_amount,target_date:i.target_date,priority:i.priority,status:i.status,category:i.category||void 0,notes:i.notes.trim()||void 0,family_id:i.family_id||void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:M,error:A}=await V.from("goals").insert([N]).select().single();if(A)throw A;T(`Goal "${i.goal_name}" created successfully!`),a({goal_name:"",target_amount:0,current_amount:0,target_date:"",priority:"medium",status:"active",category:"",notes:"",user_id:"",family_id:""}),s(),c()}catch(N){console.error("Error creating goal:",N),b(N.message||"Failed to create goal")}finally{h(!1)}}},G=()=>{o||(a({goal_name:"",target_amount:0,current_amount:0,target_date:"",priority:"medium",status:"active",category:"",notes:"",user_id:"",family_id:""}),t({}),c())};return l?e.jsxs("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,overflowY:"auto"},"aria-modal":"true",role:"dialog",children:[e.jsx("div",{className:"block md:hidden fixed inset-0 z-50 flex items-end justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsxs("div",{className:"bg-white w-full rounded-t-2xl shadow-xl max-h-[90vh] flex flex-col animate__animated animate__slideInUp animate__faster",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100 bg-gradient-to-r from-red-500 to-red-600 rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-bullseye text-white text-sm"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-white",children:"Add New Goal"}),e.jsx("p",{className:"text-[10px] text-white/80",children:"Create a financial goal"})]})]}),e.jsx("button",{onClick:G,disabled:o,className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center hover:bg-white/30 transition-colors",children:e.jsx("i",{className:"fas fa-times text-white text-sm"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3",children:e.jsxs("form",{onSubmit:I,children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:["Goal Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:`w-full px-3 py-2.5 text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${x.goal_name?"border-red-500":"border-gray-200"}`,placeholder:"Emergency Fund, New Car...",value:i.goal_name,onChange:n,name:"goal_name",disabled:o}),x.goal_name&&e.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:x.goal_name})]}),e.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsxs("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 flex items-center gap-1",children:[e.jsx("i",{className:"fas fa-user text-red-500 text-[8px]"}),"Assign to User ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:`w-full px-3 py-2.5 text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${x.user_id?"border-red-500":"border-gray-200"}`,placeholder:"Search users...",value:j?j.user_metadata?.full_name||j.email:k,onChange:F,onFocus:()=>!j&&E(!0),disabled:o}),g&&!j&&k!==""&&v.length>0&&e.jsx("div",{className:"mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-32 overflow-y-auto",children:v.slice(0,5).map(m=>e.jsxs("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center gap-2 border-b border-gray-100 last:border-0",onClick:()=>D(m),children:[e.jsx("img",{src:m.user_metadata?.avatar_url||"../images/placeholder.png",alt:"Avatar",className:"w-6 h-6 rounded-full object-cover",onError:N=>{N.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-gray-800 truncate",children:m.user_metadata?.full_name||m.email.split("@")[0]}),e.jsx("p",{className:"text-[10px] text-gray-500 truncate",children:m.email})]})]},m.id))}),j&&e.jsxs("div",{className:"mt-2 flex items-center justify-between bg-blue-50 px-2 py-1.5 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:j.user_metadata?.avatar_url||"../images/placeholder.png",alt:"Avatar",className:"w-5 h-5 rounded-full object-cover",onError:m=>{m.currentTarget.src="../images/placeholder.png"}}),e.jsx("span",{className:"text-[10px] text-gray-700 font-medium",children:j.user_metadata?.full_name||j.email})]}),e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600",onClick:()=>{a(m=>({...m,user_id:""})),u("")},children:e.jsx("i",{className:"fas fa-times text-[10px]"})})]}),x.user_id&&e.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:x.user_id})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:["Target Amount ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"₱"}),e.jsx("input",{type:"number",className:`w-full pl-7 pr-3 py-2.5 text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${x.target_amount?"border-red-500":"border-gray-200"}`,placeholder:"50000",value:i.target_amount||"",onChange:n,name:"target_amount",min:"1",step:"0.01",disabled:o})]}),x.target_amount&&e.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:x.target_amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:"Current Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"₱"}),e.jsx("input",{type:"number",className:`w-full pl-7 pr-3 py-2.5 text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${x.current_amount?"border-red-500":"border-gray-200"}`,placeholder:"0",value:i.current_amount||"",onChange:n,name:"current_amount",min:"0",step:"0.01",disabled:o})]}),x.current_amount&&e.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:x.current_amount})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:["Target Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",className:`w-full px-3 py-2.5 text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${x.target_date?"border-red-500":"border-gray-200"}`,value:i.target_date,onChange:n,name:"target_date",min:new Date().toISOString().split("T")[0],disabled:o}),x.target_date&&e.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:x.target_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:"Priority"}),e.jsxs("select",{className:"w-full px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",value:i.priority,onChange:n,name:"priority",disabled:o,children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:"Category"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",placeholder:"Emergency, Travel...",value:i.category,onChange:n,name:"category",disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:"Status"}),e.jsxs("select",{className:"w-full px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",value:i.status,onChange:n,name:"status",disabled:o,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"paused",children:"Paused"})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:"Notes"}),e.jsx("textarea",{className:"w-full px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none resize-none",placeholder:"Additional details...",rows:2,value:i.notes,onChange:n,name:"notes",disabled:o})]}),i.target_amount>0&&e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-100 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-[10px] font-semibold text-gray-600",children:"Progress Preview"}),e.jsxs("span",{className:"text-xs font-bold text-gray-800",children:[z.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${z>=100?"bg-green-500":z>=75?"bg-blue-500":z>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(z,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-[10px] text-gray-500",children:_(i.current_amount)}),e.jsx("span",{className:"text-[10px] text-gray-500",children:_(i.target_amount)})]})]})]})}),e.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50 flex gap-2",children:[e.jsx("button",{type:"button",onClick:G,disabled:o,className:"flex-1 px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:I,disabled:o,className:"flex-1 px-4 py-2.5 text-sm font-medium text-white bg-red-500 rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-plus text-xs"}),"Create Goal"]})})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered",children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"85vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"40px",height:"40px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-bullseye fa-lg"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold",children:"Add New Goal"}),e.jsx("small",{style:{opacity:.9},children:"Create a financial goal for a user"})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:G,disabled:o,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsxs("div",{className:"modal-body py-3",style:{maxHeight:"60vh",overflowY:"auto"},children:[e.jsx("div",{className:"p-3 mb-3",style:{background:"#e7f3ff",borderRadius:"8px",borderLeft:"3px solid #007bff"},children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{className:"fas fa-info-circle text-primary mr-2 mt-1"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-primary",style:{fontSize:"0.9rem"},children:"Create New Financial Goal"}),e.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.8rem"},children:"Set up a savings target for a user. Track progress and help them achieve their financial objectives."})]})]})}),e.jsxs("form",{onSubmit:I,children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("label",{htmlFor:"goal_name",className:"form-label",children:["Goal Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${x.goal_name?"is-invalid":""}`,id:"goal_name",name:"goal_name",value:i.goal_name,onChange:n,placeholder:"Emergency Fund, New Car, Vacation...",disabled:o}),x.goal_name&&e.jsx("div",{className:"invalid-feedback",children:x.goal_name})]}),e.jsx("div",{className:"col-12 mb-3",children:e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsxs("h6",{className:"mb-3",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-user text-danger mr-2"}),"User Selection"]}),e.jsxs("div",{className:"form-group mb-0",children:[e.jsxs("label",{className:"form-label",style:{fontSize:"0.85rem"},children:["Assign to User ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"position-relative",children:[e.jsx("input",{type:"text",className:`form-control ${x.user_id?"is-invalid":""}`,placeholder:"Search users by name or email...",value:j?j.user_metadata?.full_name||j.email:k,onChange:F,onFocus:()=>!j&&E(!0),disabled:o}),g&&!j&&k!==""&&v.length>0&&e.jsx("div",{className:"dropdown-menu show w-100",style:{maxHeight:"200px",overflowY:"auto"},children:v.map(m=>e.jsxs("button",{type:"button",className:"dropdown-item d-flex align-items-center",onClick:()=>D(m),children:[e.jsx("img",{src:m.user_metadata?.avatar_url||"../images/placeholder.png",alt:"Avatar",className:"rounded-circle mr-2",style:{width:"30px",height:"30px",objectFit:"cover"},onError:N=>{N.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{children:[e.jsx("div",{className:"font-weight-bold",children:m.user_metadata?.full_name||m.email.split("@")[0]}),e.jsx("small",{className:"text-muted",children:m.email})]})]},m.id))})]}),j&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"alert alert-info py-2 d-flex align-items-center",children:[e.jsx("img",{src:j.user_metadata?.avatar_url||"../images/placeholder.png",alt:"Avatar",className:"rounded-circle mr-2",style:{width:"30px",height:"30px",objectFit:"cover"},onError:m=>{m.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{children:[e.jsx("strong",{children:"Selected:"})," ",j.user_metadata?.full_name||j.email.split("@")[0]," ",e.jsxs("small",{className:"text-muted",children:["(",j.email,")"]})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-secondary ml-auto",onClick:()=>{a(m=>({...m,user_id:""})),u("")},children:e.jsx("i",{className:"fas fa-times"})})]})}),x.user_id&&e.jsx("div",{className:"text-danger small mt-1",children:x.user_id})]})]})}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("label",{htmlFor:"target_amount",className:"form-label",children:["Target Amount ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("span",{className:"input-group-text",children:"₱"})}),e.jsx("input",{type:"number",className:`form-control ${x.target_amount?"is-invalid":""}`,id:"target_amount",name:"target_amount",value:i.target_amount,onChange:n,placeholder:"50000",min:"1",step:"0.01",disabled:o}),x.target_amount&&e.jsx("div",{className:"invalid-feedback",children:x.target_amount})]})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{htmlFor:"current_amount",className:"form-label",children:"Current Amount"}),e.jsxs("div",{className:"input-group",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("span",{className:"input-group-text",children:"₱"})}),e.jsx("input",{type:"number",className:`form-control ${x.current_amount?"is-invalid":""}`,id:"current_amount",name:"current_amount",value:i.current_amount,onChange:n,placeholder:"0",min:"0",step:"0.01",disabled:o}),x.current_amount&&e.jsx("div",{className:"invalid-feedback",children:x.current_amount})]}),i.target_amount>0&&e.jsxs("small",{className:"text-muted",children:["Progress: ",z.toFixed(1),"% (",_(i.target_amount-i.current_amount)," remaining)"]})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("label",{htmlFor:"target_date",className:"form-label",children:["Target Date ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"date",className:`form-control ${x.target_date?"is-invalid":""}`,id:"target_date",name:"target_date",value:i.target_date,onChange:n,min:new Date().toISOString().split("T")[0],disabled:o}),x.target_date&&e.jsx("div",{className:"invalid-feedback",children:x.target_date})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{htmlFor:"priority",className:"form-label",children:"Priority"}),e.jsxs("select",{className:"form-control",id:"priority",name:"priority",value:i.priority,onChange:n,disabled:o,children:[e.jsx("option",{value:"low",children:"Low Priority"}),e.jsx("option",{value:"medium",children:"Medium Priority"}),e.jsx("option",{value:"high",children:"High Priority"})]})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{htmlFor:"category",className:"form-label",children:"Category (Optional)"}),e.jsx("input",{type:"text",className:"form-control",id:"category",name:"category",value:i.category,onChange:n,placeholder:"Emergency, Travel, Education...",disabled:o})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{htmlFor:"status",className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-control",id:"status",name:"status",value:i.status,onChange:n,disabled:o,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"paused",children:"Paused"})]})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsx("label",{htmlFor:"notes",className:"form-label",children:"Notes (Optional)"}),e.jsx("textarea",{className:"form-control",id:"notes",name:"notes",value:i.notes,onChange:n,rows:3,placeholder:"Add any additional details about this goal...",disabled:o})]}),i.target_amount>0&&e.jsx("div",{className:"col-12 mb-3",children:e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsxs("h6",{className:"mb-3",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-chart-line text-danger mr-2"}),"Goal Preview"]}),e.jsxs("div",{className:"row align-items-center",children:[e.jsxs("div",{className:"col-md-7",children:[e.jsx("div",{className:"progress mb-2",style:{height:"12px",borderRadius:"6px"},children:e.jsx("div",{className:`progress-bar ${z>=100?"bg-success":z>=75?"bg-info":z>=50?"bg-primary":z>=25?"bg-warning":"bg-danger"}`,role:"progressbar",style:{width:`${Math.min(z,100)}%`,borderRadius:"6px"}})}),e.jsxs("small",{className:"text-muted",children:[z.toFixed(1),"% complete"]})]}),e.jsxs("div",{className:"col-md-5 text-md-right mt-2 mt-md-0",children:[e.jsxs("div",{className:"font-weight-bold",style:{fontSize:"0.95rem"},children:[_(i.current_amount)," / ",_(i.target_amount)]}),e.jsxs("small",{className:"text-muted",children:[_(i.target_amount-i.current_amount)," remaining"]})]})]})]})})]}),e.jsx("div",{className:"modal-footer bg-light border-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsx("div",{className:"modal-footer-info",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-bullseye mr-1"}),"Goal will be created and assigned to selected user"]})}),e.jsxs("div",{className:"modal-actions",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary mr-2",onClick:G,disabled:o,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Cancel"]}),e.jsx("button",{type:"submit",className:"btn btn-danger",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner-border spinner-border-sm mr-1",role:"status",children:e.jsx("span",{className:"sr-only",children:"Creating..."})}),"Creating Goal..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-plus mr-1"}),"Create Goal"]})})]})]})})]})]})]})})})]}):null},Ne=({show:l,onClose:c,goal:s,onEdit:S,onDelete:w})=>{const[i,a]=y.useState([]),[o,h]=y.useState(!1);y.useEffect(()=>{l&&s&&x()},[l,s]);const x=async()=>{if(s){h(!0);try{const{data:b,error:r}=await V.from("transactions").select("*").eq("goal_id",s.id).order("date",{ascending:!1}).limit(10);r?console.error("Error fetching goal transactions:",r):a(b||[])}catch(b){console.error("Error fetching goal transactions:",b)}finally{h(!1)}}};if(!l||!s)return null;const t=s.target_amount>0?Math.min(s.current_amount/s.target_amount*100,100):0,k=s.target_amount-s.current_amount,u=new Date(s.target_date)<new Date&&s.status!=="completed",g=ae(s.target_date),E=b=>b>=100?"success":b>=75?"info":b>=50?"primary":b>=25?"warning":"danger",T=t>=100?"completed":"active";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden fixed inset-0 z-50 flex items-end justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsxs("div",{className:"bg-white w-full rounded-t-2xl shadow-xl max-h-[90vh] flex flex-col animate__animated animate__slideInUp animate__faster",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100 bg-gradient-to-r from-red-500 to-red-600 rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-bullseye text-white text-sm"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-white truncate max-w-[200px]",children:s.goal_name}),e.jsx("p",{className:"text-[10px] text-white/80",children:"Goal Details"})]})]}),e.jsx("button",{onClick:c,className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center hover:bg-white/30 transition-colors",children:e.jsx("i",{className:"fas fa-times text-white text-sm"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-3",children:[e.jsxs("div",{className:"flex items-stretch gap-2 mb-4",children:[e.jsxs("div",{className:"flex-1 text-center p-2 bg-gray-50 rounded-lg",children:[e.jsx("i",{className:`fas ${T==="completed"?"fa-check-circle text-green-500":"fa-play text-blue-500"} text-[10px]`}),e.jsx("p",{className:"text-[7px] text-gray-500 uppercase mt-0.5",children:"Status"}),e.jsx("p",{className:`text-[9px] font-bold ${T==="completed"?"text-green-600":"text-blue-600"}`,children:T==="completed"?"Done":"Active"})]}),e.jsxs("div",{className:"flex-1 text-center p-2 bg-gray-50 rounded-lg",children:[e.jsx("i",{className:"fas fa-percentage text-red-500 text-[10px]"}),e.jsx("p",{className:"text-[7px] text-gray-500 uppercase mt-0.5",children:"Progress"}),e.jsxs("p",{className:"text-[9px] font-bold text-red-600",children:[t.toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex-1 text-center p-2 bg-gray-50 rounded-lg",children:[e.jsx("i",{className:`fas ${s.priority==="high"?"fa-exclamation text-red-500":s.priority==="medium"?"fa-minus text-amber-500":"fa-arrow-down text-blue-500"} text-[10px]`}),e.jsx("p",{className:"text-[7px] text-gray-500 uppercase mt-0.5",children:"Priority"}),e.jsx("p",{className:`text-[9px] font-bold ${s.priority==="high"?"text-red-600":s.priority==="medium"?"text-amber-600":"text-blue-600"}`,children:s.priority.charAt(0).toUpperCase()+s.priority.slice(1)})]}),e.jsxs("div",{className:"flex-1 text-center p-2 bg-gray-50 rounded-lg",children:[e.jsx("i",{className:`fas fa-calendar ${u?"text-red-500":"text-blue-500"} text-[10px]`}),e.jsx("p",{className:"text-[7px] text-gray-500 uppercase mt-0.5",children:"Days"}),e.jsx("p",{className:`text-[9px] font-bold ${u?"text-red-600":"text-blue-600"}`,children:g<0?`${Math.abs(g)} late`:g})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-xl border border-gray-100 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("i",{className:"fas fa-chart-pie text-red-500 text-xs"}),e.jsx("span",{className:"text-[10px] font-semibold text-gray-600 uppercase",children:"Financial Summary"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-bold text-green-600",children:_(s.current_amount)}),e.jsx("p",{className:"text-[9px] text-gray-500",children:"Current"})]}),e.jsxs("div",{className:"text-center border-x border-gray-200",children:[e.jsx("p",{className:"text-sm font-bold text-blue-600",children:_(s.target_amount)}),e.jsx("p",{className:"text-[9px] text-gray-500",children:"Target"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:`text-sm font-bold ${k>0?"text-amber-600":"text-green-600"}`,children:_(Math.abs(k))}),e.jsx("p",{className:"text-[9px] text-gray-500",children:k>0?"Remaining":"Excess"})]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${t>=100?"bg-green-500":t>=75?"bg-blue-500":t>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(t,100)}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("i",{className:"fas fa-calendar-alt text-red-500 text-xs"}),e.jsx("span",{className:"text-[10px] font-semibold text-gray-600 uppercase",children:"Timeline"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[10px] text-gray-500",children:"Target"}),e.jsx("span",{className:`text-[10px] font-medium ${u?"text-red-600":"text-gray-700"}`,children:q(s.target_date)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[10px] text-gray-500",children:"Created"}),e.jsx("span",{className:"text-[10px] font-medium text-gray-700",children:q(s.created_at)})]})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("i",{className:"fas fa-user text-red-500 text-xs"}),e.jsx("span",{className:"text-[10px] font-semibold text-gray-600 uppercase",children:"User"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:s.user_avatar||"../images/placeholder.png",alt:s.user_name||"User",className:"w-6 h-6 rounded-full object-cover",onError:b=>{b.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-[10px] font-medium text-gray-700 truncate",children:s.user_name||"Unknown"}),e.jsx("p",{className:"text-[9px] text-gray-400 truncate",children:s.category||"No category"})]})]})]})]}),s.notes&&e.jsxs("div",{className:"p-3 bg-red-50 rounded-xl border-l-2 border-red-400 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:"fas fa-sticky-note text-red-500 text-xs"}),e.jsx("span",{className:"text-[10px] font-semibold text-gray-600 uppercase",children:"Notes"})]}),e.jsx("p",{className:"text-[11px] text-gray-600",children:s.notes})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("i",{className:"fas fa-history text-red-500 text-xs"}),e.jsx("span",{className:"text-[10px] font-semibold text-gray-600 uppercase",children:"Recent Transactions"})]}),o?e.jsx("div",{className:"flex justify-center py-2",children:e.jsx("div",{className:"w-4 h-4 border-2 border-red-200 border-t-red-500 rounded-full animate-spin"})}):i.length>0?e.jsx("div",{className:"space-y-1.5 max-h-24 overflow-y-auto",children:i.slice(0,5).map(b=>e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-gray-100 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-4 h-4 rounded text-[8px] flex items-center justify-center font-bold ${b.type==="contribution"?"bg-green-100 text-green-600":"bg-amber-100 text-amber-600"}`,children:b.type==="contribution"?"+":"-"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:q(b.date)})]}),e.jsxs("span",{className:`text-[10px] font-medium ${b.type==="contribution"?"text-green-600":"text-amber-600"}`,children:[b.type==="contribution"?"+":"-",_(b.amount)]})]},b.id))}):e.jsx("p",{className:"text-[10px] text-gray-400 text-center py-2",children:"No transactions found"})]})]}),e.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50 flex gap-2",children:[e.jsxs("button",{onClick:()=>S(s),className:"flex-1 px-4 py-2.5 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-edit text-xs"}),"Edit"]}),e.jsxs("button",{onClick:()=>w(s),className:"flex-1 px-4 py-2.5 text-sm font-medium text-red-600 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-trash text-xs"}),"Delete"]}),e.jsx("button",{onClick:c,className:"px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Close"})]})]})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:c}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:c,children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",onClick:b=>b.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"85vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"40px",height:"40px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-bullseye fa-lg"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold",children:s.goal_name}),e.jsx("small",{style:{opacity:.9},children:"Goal Details & Progress"})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:c,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsx("div",{className:"px-3 py-2",style:{background:"#f8f9fa",borderBottom:"1px solid #e9ecef"},children:e.jsxs("div",{className:"row text-center g-2",children:[e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:`fas fa-${s.status==="completed"?"check-circle text-success":s.status==="active"?"play text-primary":"pause text-warning"} mr-2`}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Status"}),e.jsx("strong",{style:{fontSize:"0.8rem"},className:s.status==="completed"?"text-success":s.status==="active"?"text-primary":"text-warning",children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-percentage text-danger mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Progress"}),e.jsxs("strong",{className:"text-danger",style:{fontSize:"0.8rem"},children:[t.toFixed(1),"%"]})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:`fas fa-${s.priority==="high"?"exclamation text-danger":s.priority==="medium"?"minus text-warning":"arrow-down text-info"} mr-2`}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Priority"}),e.jsx("strong",{style:{fontSize:"0.8rem"},className:s.priority==="high"?"text-danger":s.priority==="medium"?"text-warning":"text-info",children:s.priority.charAt(0).toUpperCase()+s.priority.slice(1)})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:`fas fa-calendar ${u?"text-danger":"text-primary"} mr-2`}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Days"}),e.jsx("strong",{style:{fontSize:"0.8rem"},className:u?"text-danger":g<30?"text-warning":"text-primary",children:g<0?`${Math.abs(g)} late`:g})]})]})})]})}),e.jsxs("div",{className:"modal-body py-3",style:{maxHeight:"55vh",overflowY:"auto"},children:[e.jsxs("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsxs("h6",{className:"mb-3",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-chart-pie text-danger mr-2"}),"Financial Summary"]}),e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-4 text-center",children:[e.jsx("div",{className:"font-weight-bold text-success",style:{fontSize:"1.1rem"},children:_(s.current_amount)}),e.jsx("small",{className:"text-muted",children:"Current"})]}),e.jsxs("div",{className:"col-4 text-center",style:{borderLeft:"1px solid #dee2e6",borderRight:"1px solid #dee2e6"},children:[e.jsx("div",{className:"font-weight-bold text-primary",style:{fontSize:"1.1rem"},children:_(s.target_amount)}),e.jsx("small",{className:"text-muted",children:"Target"})]}),e.jsxs("div",{className:"col-4 text-center",children:[e.jsx("div",{className:`font-weight-bold ${k>0?"text-warning":"text-success"}`,style:{fontSize:"1.1rem"},children:_(Math.abs(k))}),e.jsx("small",{className:"text-muted",children:k>0?"Remaining":"Excess"})]})]}),e.jsx("div",{className:"progress",style:{height:"10px",borderRadius:"5px"},children:e.jsx("div",{className:`progress-bar bg-${E(t)}`,role:"progressbar",style:{width:`${Math.min(t,100)}%`,borderRadius:"5px"}})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-md-6 mb-3 mb-md-0",children:e.jsxs("div",{className:"p-3 h-100",style:{background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsxs("h6",{className:"mb-3",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-calendar-alt text-danger mr-2"}),"Timeline"]}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",style:{fontSize:"0.85rem"},children:"Target Date"}),e.jsxs("span",{className:`font-weight-bold ${u?"text-danger":""}`,style:{fontSize:"0.85rem"},children:[q(s.target_date),u&&e.jsx("i",{className:"fas fa-exclamation-triangle text-danger ml-1"})]})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-muted",style:{fontSize:"0.85rem"},children:"Days Remaining"}),e.jsx("span",{className:`font-weight-bold ${g<0?"text-danger":g<30?"text-warning":"text-success"}`,style:{fontSize:"0.85rem"},children:g<0?`${Math.abs(g)} overdue`:`${g} days`})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",style:{fontSize:"0.85rem"},children:"Created"}),e.jsx("span",{className:"font-weight-bold",style:{fontSize:"0.85rem"},children:q(s.created_at)})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"p-3 h-100",style:{background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsxs("h6",{className:"mb-3",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-user text-danger mr-2"}),"Assignment"]}),e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("img",{src:s.user_avatar||"../images/placeholder.png",alt:s.user_name||"User",className:"rounded-circle mr-2",style:{width:"32px",height:"32px",objectFit:"cover"},onError:b=>{b.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{children:[e.jsx("div",{className:"font-weight-bold",style:{fontSize:"0.85rem"},children:s.user_name||"Unknown"}),e.jsx("small",{className:"text-muted",children:s.user_email})]})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("span",{className:"text-muted",style:{fontSize:"0.85rem"},children:"Category"}),e.jsx("span",{className:"font-weight-bold",style:{fontSize:"0.85rem"},children:s.category||"None"})]})]})})]}),s.notes&&e.jsxs("div",{className:"p-3 mb-3",style:{background:"#fff5f5",borderRadius:"8px",borderLeft:"3px solid #dc3545"},children:[e.jsxs("h6",{className:"mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-sticky-note text-danger mr-2"}),"Notes"]}),e.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.85rem"},children:s.notes})]}),e.jsxs("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsxs("h6",{className:"mb-3",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-history text-danger mr-2"}),"Recent Transactions"]}),o?e.jsx("div",{className:"text-center py-2",children:e.jsx("div",{className:"spinner-border spinner-border-sm text-danger",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})})}):i.length>0?e.jsx("div",{style:{maxHeight:"150px",overflowY:"auto"},children:i.map(b=>e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsxs("div",{children:[e.jsx("span",{className:`badge badge-${b.type==="contribution"?"success":"warning"} mr-2`,style:{fontSize:"0.7rem"},children:b.type==="contribution"?"+":"-"}),e.jsx("span",{style:{fontSize:"0.8rem"},children:q(b.date)})]}),e.jsxs("span",{className:`font-weight-bold ${b.type==="contribution"?"text-success":"text-warning"}`,style:{fontSize:"0.85rem"},children:[b.type==="contribution"?"+":"-",_(b.amount)]})]},b.id))}):e.jsxs("div",{className:"text-center py-2 text-muted",children:[e.jsx("i",{className:"fas fa-inbox mr-1"}),e.jsx("span",{style:{fontSize:"0.85rem"},children:"No transactions found"})]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-6",children:e.jsxs("button",{className:"btn btn-outline-primary btn-block py-2",onClick:()=>S(s),style:{fontSize:"0.85rem"},children:[e.jsx("i",{className:"fas fa-edit mr-1"}),"Edit Goal"]})}),e.jsx("div",{className:"col-6",children:e.jsxs("button",{className:"btn btn-outline-danger btn-block py-2",onClick:()=>w(s),style:{fontSize:"0.85rem"},children:[e.jsx("i",{className:"fas fa-trash-alt mr-1"}),"Delete Goal"]})})]})]}),e.jsx("div",{className:"modal-footer border-0 py-2",style:{background:"#f8f9fa"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-fingerprint mr-1"}),"ID: ",s.id.substring(0,8),"..."]}),e.jsxs("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:c,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Close"]})]})})]})})})]})]})},ve=({show:l,onClose:c,goal:s,onGoalUpdated:S,users:w,categories:i})=>{const[a,o]=y.useState({goal_name:"",target_amount:0,current_amount:0,target_date:"",priority:"medium",status:"active",category:"",notes:"",user_id:"",family_id:""}),[h,x]=y.useState(null),[t,k]=y.useState(!1),[u,g]=y.useState({}),[E,T]=y.useState(""),[b,r]=y.useState(!1),{showSuccessToast:n,showErrorToast:D}=Z();y.useEffect(()=>{if(s&&l){const p={goal_name:s.goal_name,target_amount:s.target_amount,current_amount:s.current_amount,target_date:s.target_date.split("T")[0],priority:s.priority,status:s.status,category:s.category||"",notes:s.notes||"",user_id:s.user_id,family_id:s.family_id||""};o(p),x(p),g({})}},[s,l]);const F=()=>{const p={};return a.goal_name.trim()?a.goal_name.trim().length<3&&(p.goal_name="Goal name must be at least 3 characters"):p.goal_name="Goal name is required",a.user_id||(p.user_id="Please select a user"),a.target_amount<=0?p.target_amount="Target amount must be greater than 0":a.target_amount>999999999&&(p.target_amount="Target amount is too large"),a.current_amount<0?p.current_amount="Current amount cannot be negative":a.current_amount>a.target_amount&&a.status!=="completed"&&(p.current_amount="Current amount cannot exceed target amount unless goal is completed"),a.target_date||(p.target_date="Target date is required"),g(p),Object.keys(p).length===0},v=p=>{const{name:P,value:B,type:H}=p.target;if(o(R=>({...R,[P]:H==="number"?parseFloat(B)||0:B})),P==="current_amount"&&a.target_amount>0){const R=parseFloat(B)||0;R>=a.target_amount&&a.status==="active"&&(o(ee=>({...ee,[P]:R,status:"completed"})),n("Goal automatically marked as completed!"))}u[P]&&g(R=>({...R,[P]:""}))},j=p=>{o(P=>({...P,user_id:p.id})),T(""),r(!1),u.user_id&&g(P=>({...P,user_id:""}))},z=p=>{T(p.target.value),r(!0),a.user_id&&p.target.value!==""&&o(P=>({...P,user_id:""}))},I=w.filter(p=>{if(!E)return!0;const P=E.toLowerCase(),B=p.user_metadata?.full_name?.toLowerCase()||"",H=p.email.toLowerCase();return B.includes(P)||H.includes(P)}),G=w.find(p=>p.id===a.user_id),m=()=>h?JSON.stringify(a)!==JSON.stringify(h):!1,N=a.target_amount>0?Math.min(a.current_amount/a.target_amount*100,100):0,M=async p=>{if(p.preventDefault(),!!F()){if(!m()){D("No changes to save");return}k(!0);try{const P={goal_name:a.goal_name.trim(),target_amount:a.target_amount,current_amount:a.current_amount,target_date:a.target_date,priority:a.priority,status:a.status,category:a.category||void 0,notes:a.notes.trim()||void 0,user_id:a.user_id,family_id:a.family_id||void 0,updated_at:new Date().toISOString()},{data:B,error:H}=await V.from("goals").update(P).eq("id",s?.id).select().single();if(H)throw H;n(`Goal "${a.goal_name}" updated successfully!`);const R={...s,...P,category:P.category||void 0,notes:P.notes||void 0,family_id:P.family_id||void 0,percentage:N,remaining:a.target_amount-a.current_amount,is_overdue:new Date(a.target_date)<new Date&&a.status!=="completed"};S(R),c()}catch(P){console.error("Error updating goal:",P),D(P.message||"Failed to update goal")}finally{k(!1)}}},A=()=>{if(!t){if(m()&&!window.confirm("You have unsaved changes. Are you sure you want to close?"))return;g({}),c()}},L=()=>{h&&(o(h),g({}))};return!l||!s?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden fixed inset-0 z-50 flex items-end justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsxs("div",{className:"bg-white w-full rounded-t-2xl shadow-xl max-h-[90vh] flex flex-col animate__animated animate__slideInUp animate__faster",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100 bg-gradient-to-r from-red-500 to-red-600 rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-edit text-white text-sm"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-white",children:"Edit Goal"}),e.jsx("p",{className:"text-[10px] text-white/80 truncate max-w-[180px]",children:s.goal_name})]})]}),e.jsx("button",{onClick:A,disabled:t,className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center hover:bg-white/30 transition-colors",children:e.jsx("i",{className:"fas fa-times text-white text-sm"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-3",children:[m()&&e.jsxs("div",{className:"mb-3 p-2.5 bg-blue-50 rounded-lg border border-blue-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-info-circle text-blue-500 text-xs"}),e.jsx("span",{className:"text-[10px] text-blue-700 font-medium",children:"Unsaved changes"})]}),e.jsx("button",{onClick:L,disabled:t,className:"text-[10px] text-blue-600 hover:text-blue-800 font-medium",children:"Reset"})]}),e.jsxs("form",{onSubmit:M,children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:["Goal Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:`w-full px-3 py-2.5 text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${u.goal_name?"border-red-500":"border-gray-200"}`,value:a.goal_name,onChange:v,name:"goal_name",disabled:t}),u.goal_name&&e.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:u.goal_name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:["Target Amount ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"₱"}),e.jsx("input",{type:"number",className:`w-full pl-7 pr-3 py-2.5 text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${u.target_amount?"border-red-500":"border-gray-200"}`,value:a.target_amount||"",onChange:v,name:"target_amount",min:"1",step:"0.01",disabled:t})]}),u.target_amount&&e.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:u.target_amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:"Current Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"₱"}),e.jsx("input",{type:"number",className:`w-full pl-7 pr-3 py-2.5 text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${u.current_amount?"border-red-500":"border-gray-200"}`,value:a.current_amount||"",onChange:v,name:"current_amount",min:"0",step:"0.01",disabled:t})]}),u.current_amount&&e.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:u.current_amount})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:["Target Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",className:`w-full px-3 py-2.5 text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${u.target_date?"border-red-500":"border-gray-200"}`,value:a.target_date,onChange:v,name:"target_date",disabled:t}),u.target_date&&e.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:u.target_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:"Status"}),e.jsxs("select",{className:"w-full px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",value:a.status==="cancelled"||a.status==="paused"?"active":a.status,onChange:v,name:"status",disabled:t,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:"Priority"}),e.jsxs("select",{className:"w-full px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",value:a.priority,onChange:v,name:"priority",disabled:t,children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:"Category"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",placeholder:"Emergency, Travel...",value:a.category,onChange:v,name:"category",disabled:t})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-1 block",children:"Notes"}),e.jsx("textarea",{className:"w-full px-3 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none resize-none",placeholder:"Additional details...",rows:2,value:a.notes,onChange:v,name:"notes",disabled:t})]}),a.target_amount>0&&e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-100 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-[10px] font-semibold text-gray-600",children:"Progress"}),e.jsxs("span",{className:"text-xs font-bold text-gray-800",children:[N.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${N>=100?"bg-green-500":N>=75?"bg-blue-500":N>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(N,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-[10px] text-gray-500",children:_(a.current_amount)}),e.jsx("span",{className:"text-[10px] text-gray-500",children:_(a.target_amount)})]})]})]})]}),e.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50 flex gap-2",children:[e.jsx("button",{type:"button",onClick:A,disabled:t,className:"flex-1 px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:M,disabled:t||!m(),className:"flex-1 px-4 py-2.5 text-sm font-medium text-white bg-red-500 rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save text-xs"}),"Save Changes"]})})]})]})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:A}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:A,children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",onClick:p=>p.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"85vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"40px",height:"40px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-edit fa-lg"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold",children:"Edit Goal"}),e.jsx("small",{style:{opacity:.9},children:s.goal_name})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:A,disabled:t,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsxs("div",{className:"modal-body py-3",style:{maxHeight:"60vh",overflowY:"auto"},children:[m()&&e.jsx("div",{className:"p-3 mb-3",style:{background:"#e7f3ff",borderRadius:"8px",borderLeft:"3px solid #007bff"},children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"fas fa-info-circle text-primary mr-2"}),e.jsx("span",{className:"text-primary",style:{fontSize:"0.85rem"},children:"You have unsaved changes"}),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-secondary ml-auto",onClick:L,disabled:t,style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"fas fa-undo mr-1"}),"Reset"]})]})}),e.jsx("form",{onSubmit:M,children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("label",{htmlFor:"goal_name",className:"form-label",children:["Goal Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${u.goal_name?"is-invalid":""}`,id:"goal_name",name:"goal_name",value:a.goal_name,onChange:v,placeholder:"Emergency Fund, New Car, Vacation...",disabled:t}),u.goal_name&&e.jsx("div",{className:"invalid-feedback",children:u.goal_name})]}),e.jsx("div",{className:"col-12 mb-3",children:e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsxs("h6",{className:"mb-3",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-user text-danger mr-2"}),"User Selection"]}),e.jsxs("div",{className:"form-group mb-0",children:[e.jsxs("label",{className:"form-label",style:{fontSize:"0.85rem"},children:["Assign to User ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"position-relative",children:[e.jsx("input",{type:"text",className:`form-control ${u.user_id?"is-invalid":""}`,placeholder:"Search users by name or email...",value:G?G.user_metadata?.full_name||G.email:E,onChange:z,onFocus:()=>!G&&r(!0),disabled:t}),b&&!G&&E!==""&&I.length>0&&e.jsx("div",{className:"dropdown-menu show w-100",style:{maxHeight:"200px",overflowY:"auto"},children:I.map(p=>e.jsxs("button",{type:"button",className:"dropdown-item d-flex align-items-center",onClick:()=>j(p),children:[e.jsx("img",{src:p.user_metadata?.avatar_url||"../images/placeholder.png",alt:"Avatar",className:"rounded-circle mr-2",style:{width:"30px",height:"30px",objectFit:"cover"},onError:P=>{P.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{children:[e.jsx("div",{className:"font-weight-bold",children:p.user_metadata?.full_name||p.email.split("@")[0]}),e.jsx("small",{className:"text-muted",children:p.email})]})]},p.id))})]}),G&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"alert alert-info py-2 d-flex align-items-center",children:[e.jsx("img",{src:G.user_metadata?.avatar_url||"../images/placeholder.png",alt:"Avatar",className:"rounded-circle mr-2",style:{width:"30px",height:"30px",objectFit:"cover"},onError:p=>{p.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{children:[e.jsx("strong",{children:"Selected:"})," ",G.user_metadata?.full_name||G.email.split("@")[0]," ",e.jsxs("small",{className:"text-muted",children:["(",G.email,")"]})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-secondary ml-auto",onClick:()=>{o(p=>({...p,user_id:""})),T("")},children:e.jsx("i",{className:"fas fa-times"})})]})}),u.user_id&&e.jsx("div",{className:"text-danger small mt-1",children:u.user_id})]})]})}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("label",{htmlFor:"target_amount",className:"form-label",children:["Target Amount ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("span",{className:"input-group-text",children:"₱"})}),e.jsx("input",{type:"number",className:`form-control ${u.target_amount?"is-invalid":""}`,id:"target_amount",name:"target_amount",value:a.target_amount,onChange:v,placeholder:"50000",min:"1",step:"0.01",disabled:t}),u.target_amount&&e.jsx("div",{className:"invalid-feedback",children:u.target_amount})]})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{htmlFor:"current_amount",className:"form-label",children:"Current Amount"}),e.jsxs("div",{className:"input-group",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("span",{className:"input-group-text",children:"₱"})}),e.jsx("input",{type:"number",className:`form-control ${u.current_amount?"is-invalid":""}`,id:"current_amount",name:"current_amount",value:a.current_amount,onChange:v,placeholder:"0",min:"0",step:"0.01",disabled:t}),u.current_amount&&e.jsx("div",{className:"invalid-feedback",children:u.current_amount})]}),a.target_amount>0&&e.jsxs("small",{className:"text-muted",children:["Progress: ",N.toFixed(1),"% (",_(Math.abs(a.target_amount-a.current_amount)),a.current_amount>=a.target_amount?" excess":" remaining",")"]})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("label",{htmlFor:"target_date",className:"form-label",children:["Target Date ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"date",className:`form-control ${u.target_date?"is-invalid":""}`,id:"target_date",name:"target_date",value:a.target_date,onChange:v,disabled:t}),u.target_date&&e.jsx("div",{className:"invalid-feedback",children:u.target_date})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{htmlFor:"status",className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-control",id:"status",name:"status",value:a.status==="cancelled"||a.status==="paused"?"active":a.status,onChange:v,disabled:t,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{htmlFor:"priority",className:"form-label",children:"Priority"}),e.jsxs("select",{className:"form-control",id:"priority",name:"priority",value:a.priority,onChange:v,disabled:t,children:[e.jsx("option",{value:"low",children:"Low Priority"}),e.jsx("option",{value:"medium",children:"Medium Priority"}),e.jsx("option",{value:"high",children:"High Priority"})]})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsx("label",{htmlFor:"category",className:"form-label",children:"Category (Optional)"}),e.jsx("input",{type:"text",className:"form-control",id:"category",name:"category",value:a.category,onChange:v,placeholder:"Emergency, Travel, Education...",disabled:t})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsx("label",{htmlFor:"notes",className:"form-label",children:"Notes (Optional)"}),e.jsx("textarea",{className:"form-control",id:"notes",name:"notes",value:a.notes,onChange:v,rows:3,placeholder:"Add any additional details about this goal...",disabled:t})]}),a.target_amount>0&&e.jsx("div",{className:"col-12 mb-3",children:e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h6",{className:"card-title",children:[e.jsx("i",{className:"fas fa-chart-line text-primary mr-2"}),"Updated Goal Preview"]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"progress mb-2",style:{height:"20px"},children:e.jsxs("div",{className:`progress-bar ${N>=100?"bg-success":N>=75?"bg-info":N>=50?"bg-primary":N>=25?"bg-warning":"bg-danger"}`,role:"progressbar",style:{width:`${Math.min(N,100)}%`},"aria-valuenow":N,"aria-valuemin":0,"aria-valuemax":100,children:[N.toFixed(1),"%"]})})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-weight-bold",children:[_(a.current_amount)," / ",_(a.target_amount)]}),e.jsxs("small",{className:"text-muted",children:[_(Math.abs(a.target_amount-a.current_amount)),a.current_amount>=a.target_amount?" excess":" remaining"]})]})})]})]})})})]})})]}),e.jsx("div",{className:"modal-footer border-0 py-2",style:{background:"#f8f9fa"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-save mr-1"}),"Changes saved immediately"]}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:"btn btn-secondary btn-sm mr-2",onClick:A,disabled:t,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Cancel"]}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:M,disabled:t||!m(),children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner-border spinner-border-sm mr-1",role:"status",children:e.jsx("span",{className:"sr-only",children:"Saving..."})}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save mr-1"}),"Save Changes"]})})]})]})})]})})})]})]})},ye=({show:l,onClose:c,goal:s,onGoalDeleted:S})=>{const[w,i]=y.useState(""),[a,o]=y.useState(!1),{showSuccessToast:h,showErrorToast:x}=Z(),t=async()=>{if(s){if(w!=="DELETE"){x("Please type 'DELETE' to confirm");return}o(!0);try{const{error:T}=await V.from("goals").delete().eq("id",s.id);if(T)throw T;h("Goal deleted successfully"),S(s.id),k()}catch(T){console.error("Error deleting goal:",T),x("Failed to delete goal")}finally{o(!1)}}},k=()=>{i(""),c()},u=w==="DELETE"&&!a;if(!l||!s)return null;const g=s.target_amount>0?Math.min(s.current_amount/s.target_amount*100,100):0,E=s.status==="active"&&s.current_amount>0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden fixed inset-0 z-50 flex items-end justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsxs("div",{className:"bg-white w-full rounded-t-2xl shadow-xl max-h-[85vh] flex flex-col animate__animated animate__slideInUp animate__faster",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100 bg-gradient-to-r from-red-500 to-red-600 rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-exclamation-triangle text-white text-sm"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-white",children:"Delete Goal"}),e.jsx("p",{className:"text-[10px] text-white/80",children:"This cannot be undone"})]})]}),e.jsx("button",{onClick:k,disabled:a,className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center hover:bg-white/30 transition-colors",children:e.jsx("i",{className:"fas fa-times text-white text-sm"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-3",children:[e.jsx("div",{className:"p-3 bg-red-50 rounded-xl border-l-2 border-red-500 mb-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"fas fa-exclamation-circle text-red-500 text-sm mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-red-800 mb-1",children:"Warning: Permanent Deletion"}),e.jsx("p",{className:"text-[10px] text-red-700",children:"This goal and all its associated data will be permanently deleted. This action cannot be undone."})]})]})}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-xl border border-gray-100 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("i",{className:"fas fa-bullseye text-red-500 text-xs"}),e.jsx("span",{className:"text-[10px] font-semibold text-gray-600 uppercase",children:"Goal to Delete"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-sm font-bold text-gray-800 mb-1",children:s.goal_name}),e.jsx("p",{className:"text-[10px] text-gray-500",children:s.category||"No category"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] text-gray-500 uppercase",children:"Target"}),e.jsx("p",{className:"text-xs font-semibold text-gray-700",children:_(s.target_amount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] text-gray-500 uppercase",children:"Saved"}),e.jsx("p",{className:"text-xs font-semibold text-green-600",children:_(s.current_amount)})]})]}),e.jsx("div",{className:"h-1.5 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${g>=100?"bg-green-500":g>=50?"bg-blue-500":"bg-red-500"}`,style:{width:`${Math.min(g,100)}%`}})}),e.jsxs("p",{className:"text-[9px] text-gray-500 mt-1",children:[g.toFixed(0),"% complete"]})]}),E&&e.jsx("div",{className:"p-3 bg-amber-50 rounded-xl border-l-2 border-amber-400 mb-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-amber-500 text-sm mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-amber-800 mb-1",children:"Active Goal with Savings"}),e.jsxs("p",{className:"text-[10px] text-amber-700",children:["This goal has ",_(s.current_amount)," in savings. Deleting it will remove all tracking for these savings."]})]})]})}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-xl border border-gray-200 mb-3",children:[e.jsxs("label",{className:"text-[10px] font-semibold text-gray-600 uppercase tracking-wide mb-2 block",children:["Type ",e.jsx("span",{className:"text-red-500 font-bold",children:"DELETE"})," to confirm"]}),e.jsx("input",{type:"text",className:`w-full px-3 py-2.5 text-sm border rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none ${w==="DELETE"?"border-green-400 bg-green-50":"border-gray-200"}`,value:w,onChange:T=>i(T.target.value.toUpperCase()),placeholder:"Type DELETE",disabled:a}),w&&w!=="DELETE"&&e.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:"Please type DELETE exactly to confirm"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("i",{className:"fas fa-list text-red-500 text-xs"}),e.jsx("span",{className:"text-[10px] font-semibold text-gray-600 uppercase",children:"What will be deleted"})]}),e.jsxs("ul",{className:"space-y-1",children:[e.jsxs("li",{className:"flex items-center gap-2 text-[10px] text-gray-600",children:[e.jsx("i",{className:"fas fa-check text-red-400 text-[8px]"}),"Goal and all its settings"]}),e.jsxs("li",{className:"flex items-center gap-2 text-[10px] text-gray-600",children:[e.jsx("i",{className:"fas fa-check text-red-400 text-[8px]"}),"Progress tracking history"]}),e.jsxs("li",{className:"flex items-center gap-2 text-[10px] text-gray-600",children:[e.jsx("i",{className:"fas fa-check text-red-400 text-[8px]"}),"Associated contribution records"]})]})]})]}),e.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50 flex gap-2",children:[e.jsx("button",{type:"button",onClick:k,disabled:a,className:"flex-1 px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:t,disabled:a||w!=="DELETE",className:"flex-1 px-4 py-2.5 text-sm font-medium text-white bg-red-500 rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-trash text-xs"}),"Delete"]})})]})]})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:k}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:k,children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:T=>T.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"40px",height:"40px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-exclamation-triangle fa-lg"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold",children:"Delete Goal"}),e.jsx("small",{style:{opacity:.9},children:"This action cannot be undone"})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:k,disabled:a,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsxs("div",{className:"modal-body py-3",style:{maxHeight:"60vh",overflowY:"auto"},children:[e.jsx("div",{className:"p-3 mb-3",style:{background:"#fff5f5",borderRadius:"8px",borderLeft:"3px solid #dc3545"},children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-danger mr-2 mt-1"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-danger",style:{fontSize:"0.9rem"},children:"Permanent Deletion Warning"}),e.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.8rem"},children:"You are about to permanently delete this financial goal. This action cannot be reversed."})]})]})}),e.jsxs("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsxs("h6",{className:"mb-3",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-bullseye text-danger mr-2"}),"Goal Information"]}),e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("div",{className:"font-weight-bold",style:{fontSize:"1rem"},children:s.goal_name}),e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-user mr-1"}),s.user_name||s.user_email]})]}),e.jsx("span",{className:`badge badge-${s.status==="completed"?"success":"primary"}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsx("small",{className:"text-muted",children:"Progress"}),e.jsxs("small",{className:"font-weight-bold",children:[g.toFixed(1),"%"]})]}),e.jsx("div",{className:"progress",style:{height:"8px",borderRadius:"4px"},children:e.jsx("div",{className:`progress-bar ${g>=100?"bg-success":g>=50?"bg-primary":"bg-warning"}`,style:{width:`${Math.min(g,100)}%`,borderRadius:"4px"}})})]}),e.jsxs("div",{className:"row text-center mt-3",children:[e.jsxs("div",{className:"col-4",children:[e.jsx("div",{className:"font-weight-bold text-success",style:{fontSize:"0.95rem"},children:_(s.current_amount)}),e.jsx("small",{className:"text-muted",children:"Current"})]}),e.jsxs("div",{className:"col-4",style:{borderLeft:"1px solid #dee2e6",borderRight:"1px solid #dee2e6"},children:[e.jsx("div",{className:"font-weight-bold text-primary",style:{fontSize:"0.95rem"},children:_(s.target_amount)}),e.jsx("small",{className:"text-muted",children:"Target"})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("div",{className:"font-weight-bold text-muted",style:{fontSize:"0.95rem"},children:q(s.target_date)}),e.jsx("small",{className:"text-muted",children:"Due Date"})]})]})]}),e.jsxs("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[e.jsxs("h6",{className:"mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-trash-alt text-danger mr-2"}),"What will be deleted:"]}),e.jsxs("div",{style:{fontSize:"0.85rem"},children:[e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("i",{className:"fas fa-check text-danger mr-2",style:{fontSize:"0.7rem"}}),e.jsx("span",{className:"text-muted",children:"Goal record and all data"})]}),e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("i",{className:"fas fa-check text-danger mr-2",style:{fontSize:"0.7rem"}}),e.jsx("span",{className:"text-muted",children:"Progress history"})]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"fas fa-check text-danger mr-2",style:{fontSize:"0.7rem"}}),e.jsx("span",{className:"text-muted",children:"Related transactions"})]})]})]}),s.status==="active"&&s.current_amount>0&&e.jsx("div",{className:"p-3 mb-3",style:{background:"#fff8e1",borderRadius:"8px",borderLeft:"3px solid #ffc107"},children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"fas fa-exclamation-circle text-warning mr-2"}),e.jsxs("small",{className:"text-muted",children:[e.jsx("strong",{children:"Active Goal:"})," ",_(s.current_amount)," saved will be lost."]})]})}),e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px",borderLeft:"3px solid #dc3545"},children:[e.jsxs("h6",{className:"mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-keyboard text-danger mr-2"}),"Type Confirmation"]}),e.jsxs("p",{className:"text-muted mb-2",style:{fontSize:"0.8rem"},children:["Type ",e.jsx("code",{className:"bg-danger text-white px-2 py-1 rounded",children:"DELETE"})," to confirm:"]}),e.jsx("input",{type:"text",className:`form-control ${w&&w!=="DELETE"?"is-invalid":""}`,value:w,onChange:T=>i(T.target.value),placeholder:"Type DELETE to confirm",disabled:a,autoComplete:"off",style:{fontSize:"0.9rem"}}),w&&w!=="DELETE"&&e.jsx("div",{className:"invalid-feedback",children:'Type "DELETE" exactly.'})]})]}),e.jsx("div",{className:"modal-footer border-0 py-2",style:{background:"#f8f9fa"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-shield-alt mr-1"}),"Irreversible action"]}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:"btn btn-secondary btn-sm mr-2",onClick:k,disabled:a,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Cancel"]}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:t,disabled:!u,children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner-border spinner-border-sm mr-1",role:"status",children:e.jsx("span",{className:"sr-only",children:"Deleting..."})}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-trash-alt mr-1"}),"Delete Goal"]})})]})]})})]})})})]})]})},Se=()=>{const[l,c]=y.useState([]),[s,S]=y.useState([]),[w,i]=y.useState([]),[a,o]=y.useState(!0),[h,x]=y.useState(!1),[t,k]=y.useState(new Date),[u,g]=y.useState({totalGoals:0,activeGoals:0,completedGoals:0,pausedGoals:0,cancelledGoals:0,totalTargetAmount:0,totalCurrentAmount:0,totalRemainingAmount:0,overallProgress:0,goalsByPriority:{high:0,medium:0,low:0},goalsByStatus:{active:0,completed:0,paused:0,cancelled:0},goalsByUser:{},overdueGoals:0,goalsCompletedThisMonth:0,averageProgress:0}),[E,T]=y.useState(1),[b,r]=y.useState(0),[n,D]=y.useState({priority:"",status:"",user:"",category:"",search:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",minProgress:"",maxProgress:"",isOverdue:!1,sortBy:"goal_name",sortOrder:"asc",currentPage:1,pageSize:10}),[F,v]=y.useState(!1),[j,z]=y.useState(!1),[I,G]=y.useState(!1),[m,N]=y.useState(!1),[M,A]=y.useState(null),{showSuccessToast:L,showErrorToast:p}=Z();y.useEffect(()=>{P()},[]),y.useEffect(()=>{s.length>0&&R()},[n,s.length]);const P=async()=>{try{o(!0),await Promise.all([B(),H()])}catch(d){console.error("Error loading initial data:",d),p("Failed to load initial data")}finally{o(!1)}},B=async()=>{try{const{data:d,error:$}=await V.auth.admin.listUsers({page:1,perPage:1e3});if($)throw $;const U=(d?.users||[]).map(O=>({id:O.id,email:O.email||"",user_metadata:O.user_metadata||{},created_at:O.created_at,last_sign_in_at:O.last_sign_in_at}));S(U)}catch(d){throw console.error("Error fetching users:",d),d}},H=async()=>{try{i([])}catch(d){throw console.error("Error fetching categories:",d),d}},R=y.useCallback(async()=>{try{x(!0);let d=V.from("goals").select("*",{count:"exact"});n.priority&&(d=d.eq("priority",n.priority)),n.status&&(d=d.eq("status",n.status)),n.user&&(d=d.eq("user_id",n.user)),n.category&&(d=d.ilike("category",`%${n.category}%`)),n.search&&(d=d.or(`goal_name.ilike.%${n.search}%,notes.ilike.%${n.search}%`)),n.startDate&&(d=d.gte("target_date",n.startDate)),n.endDate&&(d=d.lte("target_date",n.endDate)),n.minAmount&&(d=d.gte("target_amount",parseFloat(n.minAmount))),n.maxAmount&&(d=d.lte("target_amount",parseFloat(n.maxAmount))),d=d.order(n.sortBy,{ascending:n.sortOrder==="asc"});const $=(n.currentPage-1)*n.pageSize,U=$+n.pageSize-1;d=d.range($,U);const{data:O,error:W,count:J}=await d;if(W)throw W;const X=(O||[]).map(C=>{const Y=s.find(be=>be.id===C.user_id),se=C.target_amount>0?Math.min(C.current_amount/C.target_amount*100,100):0;return{...C,user_name:Y?.user_metadata?.full_name||Y?.email?.split("@")[0]||"Unknown User",user_email:Y?.email||"",user_avatar:Y?.user_metadata?.avatar_url||"",percentage:se,remaining:C.target_amount-C.current_amount,is_overdue:new Date(C.target_date)<new Date&&C.status!=="completed",is_family_goal:!!C.family_id}});let f=X;if(n.minProgress){const C=parseFloat(n.minProgress);f=f.filter(Y=>(Y.percentage??0)>=C)}if(n.maxProgress){const C=parseFloat(n.maxProgress);f=f.filter(Y=>(Y.percentage??0)<=C)}n.isOverdue&&(f=f.filter(C=>C.is_overdue===!0)),c(f),r(J||0),T(Math.ceil((J||0)/n.pageSize)),ee(X),k(new Date)}catch(d){console.error("Error fetching goals:",d),p("Failed to load goals")}finally{x(!1)}},[n,s,p]),ee=d=>{const $=new Date,U=new Date($.getFullYear(),$.getMonth(),1),O=d.map(f=>{const C=f.target_amount>0?f.current_amount/f.target_amount*100:0;return{...f,calculatedStatus:C>=100?"completed":"active"}}),W=O.filter(f=>f.calculatedStatus==="active").length,J=O.filter(f=>f.calculatedStatus==="completed").length,X={totalGoals:d.length,activeGoals:W,completedGoals:J,pausedGoals:0,cancelledGoals:0,totalTargetAmount:d.reduce((f,C)=>f+C.target_amount,0),totalCurrentAmount:d.reduce((f,C)=>f+C.current_amount,0),totalRemainingAmount:d.reduce((f,C)=>f+Math.max(0,C.target_amount-C.current_amount),0),overallProgress:d.length>0?d.reduce((f,C)=>f+C.current_amount,0)/d.reduce((f,C)=>f+C.target_amount,0)*100:0,goalsByPriority:{high:d.filter(f=>f.priority==="high").length,medium:d.filter(f=>f.priority==="medium").length,low:d.filter(f=>f.priority==="low").length},goalsByStatus:{active:W,completed:J,paused:0,cancelled:0},goalsByUser:d.reduce((f,C)=>(f[C.user_id]=(f[C.user_id]||0)+1,f),{}),overdueGoals:d.filter(f=>f.is_overdue).length,goalsCompletedThisMonth:O.filter(f=>f.calculatedStatus==="completed"&&f.updated_at&&new Date(f.updated_at)>=U).length,averageProgress:d.length>0?d.reduce((f,C)=>f+(C.percentage||0),0)/d.length:0};g(X)},te=async()=>{await R(),L("Goals refreshed successfully")},ce=d=>{D($=>({...$,...d,currentPage:d.currentPage||1}))},oe=()=>{D({priority:"",status:"",user:"",category:"",search:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",minProgress:"",maxProgress:"",isOverdue:!1,sortBy:"goal_name",sortOrder:"asc",currentPage:1,pageSize:10})},me=d=>{const $=n.sortBy===d&&n.sortOrder==="asc"?"desc":"asc";D(U=>({...U,sortBy:d,sortOrder:$}))},xe=d=>{D($=>({...$,currentPage:d}))},ue=d=>{A(d),z(!0)},re=d=>{A(d),G(!0)},le=d=>{A(d),N(!0)},he=()=>{R(),v(!1),L("Goal added successfully")},ge=d=>{c($=>$.map(U=>U.id===d.id?d:U)),A(null),G(!1),R()},pe=d=>{c($=>$.filter(U=>U.id!==d)),A(null),N(!1),R()};return a?e.jsxs("div",{className:"modern-user-management",children:[e.jsx("div",{className:"block md:hidden py-12 animate__animated animate__fadeIn",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"mt-3 text-xs text-gray-500 font-medium",children:"Loading goals..."})]})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"user-management-header mb-5",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start flex-wrap",children:[e.jsx("div",{className:"header-content",children:e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"header-icon-container mr-3",children:e.jsx("div",{className:"skeleton-icon"})}),e.jsxs("div",{children:[e.jsx("div",{className:"skeleton-line skeleton-header-title mb-1"}),e.jsx("div",{className:"skeleton-line skeleton-header-subtitle"})]})]})}),e.jsxs("div",{className:"header-actions d-flex align-items-center",children:[e.jsx("div",{className:"last-updated-info mr-3",children:e.jsx("div",{className:"skeleton-line skeleton-date"})}),e.jsx("div",{className:"skeleton-button mr-2"}),e.jsx("div",{className:"skeleton-button"})]})]})}),e.jsx(ne,{summary:u,loading:!0}),e.jsx(ie,{filters:n,users:[],categories:[],onFiltersChange:()=>{},onClearFilters:()=>{},loading:!0}),e.jsx(de,{goals:[],filters:n,totalPages:1,totalItems:0,loading:!0,onSort:()=>{},onPageChange:()=>{},onGoalSelect:()=>{},onGoalEdit:()=>{},onGoalDelete:()=>{}})]})]}):e.jsxs("div",{className:"modern-user-management",children:[e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-bold text-gray-800",children:"Goals"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:te,className:"w-9 h-9 rounded-full bg-red-500 hover:bg-red-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95 disabled:opacity-50",disabled:h,"aria-label":"Refresh data",children:e.jsx("i",{className:`fas fa-sync text-xs ${h?"fa-spin":""}`})}),e.jsx("button",{onClick:()=>v(!0),className:"w-9 h-9 rounded-full bg-rose-600 hover:bg-rose-700 text-white flex items-center justify-center shadow-md transition-all active:scale-95","aria-label":"Add goal",children:e.jsx("i",{className:"fas fa-plus text-xs"})})]})]})}),e.jsx("div",{className:"user-management-header mb-5 hidden md:block",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start flex-wrap",children:[e.jsx("div",{className:"header-content",children:e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"header-icon-container mr-3",children:e.jsx("i",{className:"fas fa-bullseye"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"header-title mb-1",children:"Goal Management"}),e.jsx("p",{className:"header-subtitle mb-0",children:"Manage financial goals, track progress, and monitor achievement across all users"})]})]})}),e.jsxs("div",{className:"header-actions d-flex align-items-center",children:[e.jsx("div",{className:"last-updated-info mr-3",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"far fa-clock mr-1"}),"Last updated: ",t.toLocaleTimeString()]})}),e.jsxs("button",{className:"btn btn-outline-danger btn-sm shadow-sm refresh-btn mr-2",onClick:te,disabled:h,children:[e.jsx("i",{className:`fas fa-sync-alt mr-1 ${h?"fa-spin":""}`}),h?"Updating...":"Refresh"]}),e.jsxs("button",{className:"btn btn-danger btn-sm shadow-sm",onClick:()=>v(!0),children:[e.jsx("i",{className:"fas fa-plus mr-1"}),"Add Goal"]})]})]})}),e.jsx(ne,{summary:u,loading:h}),e.jsx(ie,{filters:n,users:s,categories:w,onFiltersChange:ce,onClearFilters:oe,loading:h}),e.jsx(de,{goals:l,filters:n,totalPages:E,totalItems:b,loading:h,onSort:me,onPageChange:xe,onGoalSelect:ue,onGoalEdit:re,onGoalDelete:le}),e.jsx(je,{show:F,onClose:()=>v(!1),onGoalAdded:he,users:s,categories:w}),e.jsx(Ne,{show:j,onClose:()=>{z(!1),A(null)},goal:M,onEdit:re,onDelete:le}),e.jsx(ve,{show:I,onClose:()=>{G(!1),A(null)},goal:M,onGoalUpdated:ge,users:s,categories:w}),e.jsx(ye,{show:m,onClose:()=>{N(!1),A(null)},goal:M,onGoalDeleted:pe})]})};export{Se as default};
