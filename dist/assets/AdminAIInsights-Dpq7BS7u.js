import{j as e,B as X,A as le}from"./ui-vendor-Cn1Vfl4w.js";import{r as n}from"./react-vendor-D4A9EtXC.js";import{t as W,A as xe,o as he,s as I,b as me}from"./index-BbApZ7g3.js";import{d as H,H as $}from"./chart-vendor-B0c7K_uV.js";const ue=({show:r,onClose:s,title:h,color:d,icon:y,data:j})=>r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:s}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:s,children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:p=>p.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"modal-header bg-gradient-danger text-white border-0",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center",children:[e.jsx("div",{className:"modal-icon-container mr-3",style:{width:"45px",height:"45px",borderRadius:"12px",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("i",{className:`fas ${y}`,style:{fontSize:"1.25rem"}})}),e.jsxs("div",{children:[e.jsx("div",{className:"modal-title-main font-weight-bold",children:h}),e.jsx("div",{className:"modal-subtitle",style:{opacity:.85,fontSize:"0.85rem"},children:"Detailed breakdown"})]})]}),e.jsx("button",{type:"button",className:"close text-white",onClick:s,style:{textShadow:"none",opacity:.9},children:e.jsx("span",{children:"×"})})]}),e.jsx("div",{className:"modal-body bg-white p-0",children:e.jsx("div",{className:"stats-breakdown-list",children:j.map((p,m)=>e.jsxs("div",{className:"stats-breakdown-item d-flex justify-content-between align-items-center py-3 px-4",style:{borderBottom:m<j.length-1?"1px solid #f0f0f0":"none",transition:"background-color 0.2s ease"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-weight-medium text-gray-800",children:p.label}),p.subLabel&&e.jsx("small",{className:"text-muted",children:p.subLabel})]}),e.jsx("span",{className:`badge badge-${d} badge-pill px-3 py-2`,style:{fontSize:"0.9rem",fontWeight:600,minWidth:"60px",textAlign:"center"},children:p.value})]},m))})}),e.jsx("div",{className:"modal-footer bg-light border-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsx("div",{className:"modal-footer-info",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-info-circle mr-1 text-danger"}),"Data reflects current AI insights statistics"]})}),e.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:s,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Close"]})]})})]})})})]}):null,ne=({stats:r,loading:s=!1})=>{const[h,d]=n.useState({show:!1,title:"",color:"",icon:"",data:[]});if(s)return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden mb-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Array.from({length:4}).map((x,N)=>e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"skeleton-icon w-7 h-7 rounded-lg mb-2"}),e.jsx("div",{className:"skeleton-line skeleton-stat-title mb-1"}),e.jsx("div",{className:"skeleton-line skeleton-stat-value mb-1"}),e.jsx("div",{className:"skeleton-line skeleton-stat-subtitle"})]},N))})}),e.jsx("div",{className:"row d-none d-md-flex",children:Array.from({length:4}).map((x,N)=>e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsx("div",{className:"card shadow h-100 py-3 admin-card admin-card-loading",children:e.jsxs("div",{className:"card-body text-center",children:[e.jsx("div",{className:"skeleton-line skeleton-stat-value mb-2"}),e.jsx("div",{className:"skeleton-line skeleton-stat-title"})]})})},N))})]});const y=r.totalUsers>0?(r.activeServices/r.totalUsers*100).toFixed(1):"0.0",j=r.processingMetrics.successRate.toFixed(1),p=r.riskDistribution.high+r.riskDistribution.medium+r.riskDistribution.low+r.riskDistribution.unknown,m=p>0?(r.riskDistribution.high/p*100).toFixed(1):"0.0",b=()=>{d({show:!0,title:"Total Insights Breakdown",color:"danger",icon:"fa-brain",data:[{label:"Total Insights Generated",value:r.totalInsights},{label:"OpenRouter Insights",value:r.serviceUsage.openrouter,subLabel:"AI-powered analysis"},{label:"ChatBot Insights",value:r.serviceUsage.chatbot,subLabel:"Conversational AI"},{label:"Prophet Insights",value:r.serviceUsage.prophet,subLabel:"Predictive modeling"},{label:"Fallback Insights",value:r.serviceUsage.fallback,subLabel:"Backup service"},{label:"Usage Today",value:r.usageToday},{label:"Rate Limited Today",value:r.rateLimitedToday}]})},u=()=>{d({show:!0,title:"Active Users Breakdown",color:"success",icon:"fa-user-check",data:[{label:"Active Users",value:r.activeServices},{label:"Total Users",value:r.totalUsers},{label:"Active Percentage",value:`${y}%`,subLabel:"Users with insights"},{label:"Insights per User",value:r.totalUsers>0?(r.totalInsights/r.totalUsers).toFixed(1):"0",subLabel:"Average"}]})},w=()=>{d({show:!0,title:"Accuracy & Performance",color:"warning",icon:"fa-bullseye",data:[{label:"Average Confidence",value:`${r.averageConfidence.toFixed(1)}%`},{label:"Success Rate",value:`${j}%`,subLabel:"Processing success"},{label:"Avg Processing Time",value:`${r.processingMetrics.averageTime.toFixed(0)}ms`},{label:"Total Tokens Used",value:W(r.processingMetrics.totalTokens),subLabel:"API consumption"}]})},l=()=>{d({show:!0,title:"Risk Distribution",color:"info",icon:"fa-shield-alt",data:[{label:"High Risk",value:r.riskDistribution.high,subLabel:`${m}% of total`},{label:"Medium Risk",value:r.riskDistribution.medium,subLabel:"Moderate attention needed"},{label:"Low Risk",value:r.riskDistribution.low,subLabel:"Healthy financial status"},{label:"Unknown Risk",value:r.riskDistribution.unknown,subLabel:"Pending assessment"},{label:"Total Assessed",value:p}]})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:b,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-red-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-brain text-red-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Total Insights"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:W(r.totalInsights)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-gray-400",children:[e.jsx("i",{className:"fas fa-chart-line text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium truncate",children:[r.usageToday," today"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:u,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-emerald-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-user-check text-emerald-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Active Users"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:W(r.activeServices)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-emerald-500",children:[e.jsx("i",{className:"fas fa-arrow-up text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium truncate",children:[y,"% of total"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:w,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-amber-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-bullseye text-amber-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Average Accuracy"}),e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:[r.averageConfidence.toFixed(1),"%"]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-amber-500",children:[e.jsx("i",{className:"fas fa-check-circle text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium truncate",children:[j,"% success"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:l,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-blue-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-shield-alt text-blue-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Total Users"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:W(r.totalUsers)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-blue-500",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium truncate",children:[r.riskDistribution.high," high risk"]})]})]})]})}),e.jsxs("div",{className:"row d-none d-md-flex",children:[e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-danger h-100 position-relative",onClick:b,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-danger text-uppercase mb-2",children:"Total Insights"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:W(r.totalInsights)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-muted",children:[e.jsx("i",{className:"fas fa-chart-line mr-1"}),e.jsxs("span",{className:"font-weight-medium text-truncate",style:{maxWidth:"120px"},children:[r.usageToday," generated today"]})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-danger",children:e.jsx("i",{className:"fas fa-brain stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-danger",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-success h-100 position-relative",onClick:u,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-success text-uppercase mb-2",children:"Active Users"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:W(r.activeServices)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-success",children:[e.jsx("i",{className:"fas fa-arrow-up mr-1"}),e.jsxs("span",{className:"font-weight-medium",children:[y,"%"]}),e.jsx("span",{className:"ml-1 small text-truncate",style:{maxWidth:"80px"},children:"of total"})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-success",children:e.jsx("i",{className:"fas fa-user-check stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-success",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-warning h-100 position-relative",onClick:w,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-warning text-uppercase mb-2",children:"Average Accuracy"}),e.jsxs("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:[r.averageConfidence.toFixed(1),"%"]}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-warning",children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),e.jsxs("span",{className:"font-weight-medium text-truncate",style:{maxWidth:"100px"},children:[j,"% success rate"]})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-warning",children:e.jsx("i",{className:"fas fa-bullseye stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-warning",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-info h-100 position-relative",onClick:l,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-info text-uppercase mb-2",children:"Total Users"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:W(r.totalUsers)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-info",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-1"}),e.jsxs("span",{className:"font-weight-medium text-truncate",style:{maxWidth:"100px"},children:[r.riskDistribution.high," high risk"]})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-info",children:e.jsx("i",{className:"fas fa-users stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-info",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})})]}),e.jsx(ue,{show:h.show,onClose:()=>d({...h,show:!1}),title:h.title,color:h.color,icon:h.icon,data:h.data})]})},ce=({filters:r,users:s,onFiltersChange:h,onResetFilters:d,hasActiveFilters:y,activeFilterCount:j,loading:p=!1})=>{const m=x=>{h({search:x.target.value})},b=x=>{h({aiService:x.target.value})},u=x=>{h({riskLevel:x.target.value})},w=x=>{h({pageSize:Number(x.target.value),currentPage:1})},l=()=>{d()};return p?e.jsxs("div",{className:"controls-section mb-4",children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"h-10 bg-gray-100 rounded-lg animate-pulse mb-2"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"h-9 bg-gray-100 rounded-lg animate-pulse"}),e.jsx("div",{className:"h-9 bg-gray-100 rounded-lg animate-pulse"})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-6 col-lg-4 mb-3 mb-md-0",children:e.jsx("div",{className:"skeleton-line skeleton-search-bar"})}),e.jsx("div",{className:"col-md-3 col-lg-2 mb-3 mb-md-0",children:e.jsx("div",{className:"skeleton-line skeleton-filter"})}),e.jsx("div",{className:"col-md-3 col-lg-2 mb-3 mb-md-0",children:e.jsx("div",{className:"skeleton-line skeleton-filter"})}),e.jsx("div",{className:"col-md-12 col-lg-4",children:e.jsx("div",{className:"skeleton-line skeleton-filter"})})]})})})})]}):e.jsxs("div",{className:"controls-section mb-4",children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs"}),e.jsx("input",{type:"text",className:"w-full h-10 pl-9 pr-3 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition-all",placeholder:"Search insights...",value:r.search,onChange:m})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[e.jsxs("select",{className:"h-9 px-3 text-xs border border-gray-200 rounded-lg bg-white focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none",value:r.aiService,onChange:b,children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"openrouter",children:"Active"}),e.jsx("option",{value:"chatbot",children:"Pending"}),e.jsx("option",{value:"prophet",children:"Error"})]}),e.jsxs("select",{className:"h-9 px-3 text-xs border border-gray-200 rounded-lg bg-white focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none",value:r.riskLevel,onChange:u,children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"high",children:"Income"}),e.jsx("option",{value:"medium",children:"Expense"}),e.jsx("option",{value:"low",children:"Savings"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-[10px] text-gray-500",children:"Show:"}),e.jsxs("select",{className:"h-7 px-2 text-xs border border-gray-200 rounded bg-white",value:r.pageSize,onChange:w,children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"})]})]}),y&&e.jsxs("button",{className:"h-7 px-3 text-xs text-red-500 border border-red-200 rounded-lg bg-red-50 hover:bg-red-100 transition-colors",onClick:l,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Clear"]})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-6 col-lg-4 mb-3 mb-md-0",children:e.jsx("div",{className:"search-container",children:e.jsxs("div",{className:"input-group",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("span",{className:"input-group-text bg-white border-right-0",children:e.jsx("i",{className:"fas fa-search text-muted"})})}),e.jsx("input",{type:"text",className:"form-control border-left-0 modern-input",placeholder:"Search by username...",value:r.search,onChange:m})]})})}),e.jsx("div",{className:"col-md-3 col-lg-2 mb-3 mb-md-0",children:e.jsxs("select",{className:"form-control modern-select",value:r.aiService,onChange:b,children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"openrouter",children:"Active"}),e.jsx("option",{value:"chatbot",children:"Pending"}),e.jsx("option",{value:"prophet",children:"Error"})]})}),e.jsx("div",{className:"col-md-3 col-lg-2 mb-3 mb-md-0",children:e.jsxs("select",{className:"form-control modern-select",value:r.riskLevel,onChange:u,children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"high",children:"Income"}),e.jsx("option",{value:"medium",children:"Expense"}),e.jsx("option",{value:"low",children:"Savings"})]})}),e.jsx("div",{className:"col-md-12 col-lg-4",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"page-size-selector",children:[e.jsx("small",{className:"text-muted mr-2",children:"Show:"}),e.jsxs("select",{className:"form-control form-control-sm d-inline-block w-auto",value:r.pageSize,onChange:w,children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"})]}),e.jsx("small",{className:"text-muted ml-2",children:"per page"})]}),e.jsxs("div",{className:"filter-actions",children:[e.jsxs("button",{className:"btn btn-outline-secondary btn-sm mr-2",onClick:()=>window.location.reload(),disabled:p,children:[e.jsx("i",{className:`fas fa-sync-alt ${p?"fa-spin":""} mr-1`}),"Refresh"]}),y&&e.jsxs("button",{className:"btn btn-outline-secondary btn-sm",onClick:l,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Clear"]})]})]})})]})})})})]})},de=({insights:r,filters:s,totalPages:h,totalItems:d,loading:y=!1,onSort:j,onPageChange:p,onView:m,onDelete:b})=>{const[u,w]=n.useState(null),l=()=>{w(null)},x=i=>{w(u===i?null:i)};n.useEffect(()=>{const i=t=>{u&&!t.target.closest(".dropdown-menu")&&l()};return u&&(document.addEventListener("mousedown",i),document.addEventListener("touchstart",i)),()=>{document.removeEventListener("mousedown",i),document.removeEventListener("touchstart",i)}},[u]);const N=i=>s.sortBy!==i?null:s.sortOrder==="asc"?e.jsx("i",{className:"fas fa-sort-amount-up ml-1"}):e.jsx("i",{className:"fas fa-sort-amount-down ml-1"}),A=i=>{const t={active:"status-badge status-active",pending:"status-badge status-pending",error:"status-badge status-error"},f={active:"fa-check-circle",pending:"fa-pause-circle",error:"fa-times-circle"};return e.jsxs("span",{className:t[i]||"status-badge status-pending",children:[e.jsx("i",{className:`fas ${f[i]||"fa-pause-circle"} mr-1`}),i.charAt(0).toUpperCase()+i.slice(1)]})},C=i=>i>0?"text-success":i<0?"text-danger":"text-muted",k=i=>i===0?"—":`${i>0?"+":""}${i.toFixed(1)}%`;return y?e.jsxs("div",{className:"table-section",children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2.5 border-b border-gray-100",children:e.jsx("div",{className:"h-4 w-32 bg-gray-100 rounded animate-pulse"})}),e.jsx("div",{className:"divide-y divide-gray-100",children:Array.from({length:3}).map((i,t)=>e.jsx("div",{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 animate-pulse"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-3 w-24 bg-gray-100 rounded animate-pulse mb-2"}),e.jsx("div",{className:"h-2 w-32 bg-gray-100 rounded animate-pulse"})]})]})},t))})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header bg-white border-0 py-3",children:e.jsx("div",{className:"skeleton-line skeleton-table-header"})}),e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover modern-table mb-0",children:[e.jsx("thead",{className:"table-header",children:e.jsx("tr",{children:Array.from({length:7}).map((i,t)=>e.jsx("th",{className:"border-0",children:e.jsx("div",{className:"skeleton-line skeleton-th"})},t))})}),e.jsx("tbody",{children:Array.from({length:5}).map((i,t)=>e.jsx("tr",{children:Array.from({length:7}).map((f,z)=>e.jsx("td",{className:"py-3",children:e.jsx("div",{className:"skeleton-line skeleton-td"})},z))},t))})]})})})]})})]}):e.jsxs("div",{className:"table-section",children:[e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2.5 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("h6",{className:"text-[11px] font-bold text-gray-800 flex items-center gap-1.5",children:[e.jsx("i",{className:"fas fa-brain text-red-500 text-[10px]"}),"User Insights",d>0&&e.jsx("span",{className:"bg-red-100 text-red-600 px-1.5 py-0.5 rounded-full text-[9px]",children:d})]}),e.jsxs("span",{className:"text-[9px] text-gray-400",children:[Math.min((s.currentPage-1)*s.pageSize+1,d),"-",Math.min(s.currentPage*s.pageSize,d)," of ",d]})]}),e.jsx("div",{className:"divide-y divide-gray-100 max-h-[60vh] overflow-y-auto",children:r.length>0?r.map(i=>e.jsx("div",{className:"px-3 py-3 hover:bg-gray-50 active:bg-gray-100 transition-colors",onClick:()=>m(i),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[i.avatarUrl?e.jsx("img",{src:i.avatarUrl,alt:i.username||"User",className:"w-10 h-10 rounded-full object-cover border-2 border-gray-200",onError:t=>{t.currentTarget.src="../images/placeholder.png"}}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-500 flex items-center justify-center text-white font-semibold text-sm",children:i.username?.charAt(0)?.toUpperCase()||"U"}),e.jsx("div",{className:`absolute -bottom-0.5 -right-0.5 w-3 h-3 rounded-full border-2 border-white ${i.status==="active"?"bg-emerald-500":i.status==="error"?"bg-red-500":"bg-amber-500"}`})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-800 truncate",children:i.username||"Unknown User"}),e.jsx("span",{className:`flex-shrink-0 px-1 py-0.5 rounded text-[8px] font-semibold ${i.status==="active"?"bg-emerald-100 text-emerald-700":i.status==="error"?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:i.status?.toUpperCase()||"PENDING"})]}),e.jsx("p",{className:"text-[10px] text-gray-500 truncate",children:i.generatedDate?new Date(i.generatedDate).toLocaleDateString():"—"}),e.jsx("div",{className:"flex items-center gap-3 mt-1",children:e.jsx("span",{className:"text-[9px] text-gray-600",children:i.confidenceLevel?`${(i.confidenceLevel*100).toFixed(0)}%`:"—"})})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"w-7 h-7 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 transition-colors",onClick:t=>{t.stopPropagation(),x(i.insightId)},onTouchEnd:t=>{t.stopPropagation(),x(i.insightId)},"aria-label":"More actions",children:e.jsx("i",{className:"fas fa-ellipsis-v text-[10px]"})}),u===i.insightId&&e.jsxs("div",{className:"dropdown-menu fixed w-28 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",style:{display:"block",zIndex:9999,transform:"translateX(-84px) translateY(4px)"},children:[e.jsxs("button",{className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50 active:bg-gray-100 flex items-center gap-2 transition-colors",onClick:t=>{t.stopPropagation(),l(),m(i)},onTouchEnd:t=>{t.stopPropagation(),l(),m(i)},children:[e.jsx("i",{className:"fas fa-eye text-gray-500 text-[10px]"}),e.jsx("span",{className:"text-gray-700",children:"View"})]}),e.jsx("div",{className:"border-t border-gray-200"}),e.jsxs("button",{className:"w-full px-3 py-2 text-left text-xs hover:bg-red-50 active:bg-red-100 flex items-center gap-2 transition-colors",onClick:t=>{t.stopPropagation(),l(),b(i)},onTouchEnd:t=>{t.stopPropagation(),l(),b(i)},children:[e.jsx("i",{className:"fas fa-trash text-red-500 text-[10px]"}),e.jsx("span",{className:"text-red-600",children:"Delete"})]})]})]}),e.jsx("i",{className:"fas fa-chevron-right text-gray-400 text-[8px]"})]})]})},i.insightId)):e.jsxs("div",{className:"px-3 py-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-full bg-gray-100 flex items-center justify-center mb-3",children:e.jsx("i",{className:"fas fa-brain text-gray-400 text-lg"})}),e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"No insights found"}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Try adjusting your filters"})]})}),h>1&&e.jsxs("div",{className:"px-3 py-2 border-t border-gray-100 bg-gray-50 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[9px] text-gray-500",children:["Page ",s.currentPage," of ",h]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{className:"w-7 h-7 rounded-lg bg-white border border-gray-200 flex items-center justify-center text-gray-600 disabled:opacity-50",onClick:()=>p(Math.max(s.currentPage-1,1)),disabled:s.currentPage===1,children:e.jsx("i",{className:"fas fa-chevron-left text-[10px]"})}),e.jsx("span",{className:"px-2 py-1 text-[10px] font-medium text-gray-700",children:s.currentPage}),e.jsx("button",{className:"w-7 h-7 rounded-lg bg-white border border-gray-200 flex items-center justify-center text-gray-600 disabled:opacity-50",onClick:()=>p(Math.min(s.currentPage+1,h)),disabled:s.currentPage===h,children:e.jsx("i",{className:"fas fa-chevron-right text-[10px]"})})]})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header bg-white border-0 py-3",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"m-0 font-weight-bold text-danger",children:[e.jsx("i",{className:"fas fa-brain mr-2"}),"User Insights (",d,")"]}),e.jsx("div",{className:"table-actions",children:e.jsxs("small",{className:"text-muted",children:["Showing ",Math.min((s.currentPage-1)*s.pageSize+1,d)," to ",Math.min(s.currentPage*s.pageSize,d)," of ",d," entries"]})})]})}),e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover modern-table mb-0",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>j("username","asc"),children:["Username ",N("username")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>j("generated_at","asc"),children:["Last Updated ",N("generated_at")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>j("confidence_level","asc"),children:["Accuracy ",N("confidence_level")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>j("riskLevel","asc"),children:["Income Trend ",N("riskLevel")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>j("aiService","asc"),children:["Savings Trend ",N("aiService")]}),e.jsxs("th",{className:"border-0 cursor-pointer",onClick:()=>j("status","asc"),children:["Status ",N("status")]}),e.jsx("th",{className:"border-0 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:r.length>0?r.map(i=>e.jsxs("tr",{className:"table-row",children:[e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"user-avatar-container mr-3",style:{position:"relative"},children:i.avatarUrl?e.jsx("img",{src:i.avatarUrl,alt:i.username||"User",className:"rounded-circle",style:{width:"40px",height:"40px",objectFit:"cover"}}):e.jsx("div",{className:"user-table-avatar bg-primary text-white d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px",borderRadius:"50%",fontWeight:600},children:i.username?.charAt(0)?.toUpperCase()||"U"})}),e.jsxs("div",{className:"user-info",children:[e.jsx("div",{className:"user-name font-weight-medium",children:i.username||"Unknown User"}),e.jsxs("div",{className:"user-id text-muted small",children:["Generated: ",i.generatedDate?new Date(i.generatedDate).toLocaleDateString():"—"]})]})]})}),e.jsx("td",{className:"py-3",children:i.generatedDate?new Date(i.generatedDate).toLocaleDateString():"—"}),e.jsx("td",{className:"py-3",children:i.confidenceLevel?e.jsxs("span",{className:`text-${i.confidenceLevel>.9?"success":i.confidenceLevel>.8?"primary":"warning"}`,children:[(i.confidenceLevel*100).toFixed(1),"%"]}):"—"}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:C(1.1),children:k(1.1)})}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:C(-4.2),children:k(-4.2)})}),e.jsx("td",{className:"py-3",children:A(i.status)}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn btn-sm btn-outline-primary mr-1",onClick:()=>m(i),title:"View Details",children:e.jsx("i",{className:"fas fa-eye"})}),e.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>b(i),title:"Delete Insight",children:e.jsx("i",{className:"fas fa-trash"})})]})})]},i.insightId)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-5",children:e.jsxs("div",{className:"no-users-container",children:[e.jsx("i",{className:"fas fa-brain fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No insights found"}),e.jsx("p",{className:"text-muted",children:"Try adjusting your search or filter criteria"})]})})})})]})})}),h>1&&e.jsx("div",{className:"card-footer bg-white border-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("small",{className:"text-muted",children:["Page ",s.currentPage," of ",h]}),e.jsx("nav",{children:e.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[e.jsx("li",{className:`page-item ${s.currentPage===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>p(1),disabled:s.currentPage===1,children:e.jsx("i",{className:"fas fa-angle-double-left"})})}),e.jsx("li",{className:`page-item ${s.currentPage===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>p(Math.max(s.currentPage-1,1)),disabled:s.currentPage===1,children:e.jsx("i",{className:"fas fa-angle-left"})})}),Array.from({length:Math.min(5,h)},(i,t)=>{let f=h<=5||s.currentPage<=3?t+1:s.currentPage>=h-2?h-4+t:s.currentPage-2+t;return e.jsx("li",{className:`page-item ${s.currentPage===f?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>p(f),children:f})},f)}),e.jsx("li",{className:`page-item ${s.currentPage===h?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>p(Math.min(s.currentPage+1,h)),disabled:s.currentPage===h,children:e.jsx("i",{className:"fas fa-angle-right"})})}),e.jsx("li",{className:`page-item ${s.currentPage===h?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>p(h),disabled:s.currentPage===h,children:e.jsx("i",{className:"fas fa-angle-double-right"})})})]})})]})})]})})]})};typeof window<"u"&&(xe($),he($));const oe=({stats:r,insights:s,loading:h=!1})=>{const[d,y]=n.useState("trends"),[j,p]=n.useState("performance"),m=()=>{const l=(s||[]).filter(x=>x&&x.status==="active").slice(0,10);return{chart:{type:"column",height:350},credits:{enabled:!1},title:{text:"User Financial Trends Analysis"},xAxis:{categories:l.map(x=>x?.username||"Unknown"),crosshair:!0,title:{text:"Users"}},yAxis:[{min:-10,title:{text:"Trend (%)"},labels:{format:"{value}%"}},{title:{text:"Confidence (%)"},labels:{format:"{value}%"},opposite:!0,min:0,max:100}],tooltip:{shared:!0,valueDecimals:1,valueSuffix:"%"},plotOptions:{column:{pointPadding:.2,borderWidth:0,dataLabels:{enabled:!1}}},series:[{name:"Income Trend",type:"column",data:l.map(x=>({y:Math.random()*10-5,color:Math.random()>.5?"#1cc88a":"#e74a3b"}))},{name:"Expense Trend",type:"column",data:l.map(x=>({y:Math.random()*10-5,color:Math.random()>.5?"#1cc88a":"#e74a3b"}))},{name:"Savings Trend",type:"column",data:l.map(x=>({y:Math.random()*10-5,color:Math.random()>.5?"#1cc88a":"#e74a3b"}))}]}},b=()=>({chart:{type:"pie",height:350},credits:{enabled:!1},title:{text:"Prediction Accuracy Distribution"},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %"}}},series:[{name:"Accuracy",colorByPoint:!0,data:[{name:"High Accuracy (>90%)",y:r.riskDistribution.high||0,color:"#1cc88a"},{name:"Medium Accuracy (70-90%)",y:r.riskDistribution.medium||0,color:"#f6c23e"},{name:"Low Accuracy (<70%)",y:r.riskDistribution.low||0,color:"#e74a3b"}]}]}),u=()=>{const l=[],x=[];for(let N=6;N>=0;N--){const A=new Date;A.setDate(A.getDate()-N),l.push(A.toLocaleDateString()),x.push(Math.random()*20+80)}return{chart:{type:"line",height:350},credits:{enabled:!1},title:{text:"Model Performance Over Time"},xAxis:{categories:l,title:{text:"Date"}},yAxis:{title:{text:"Performance (%)"},min:0,max:100},tooltip:{valueSuffix:"%"},series:[{name:"Model Accuracy",data:x,color:"#4e73df"}]}},w=()=>({chart:{type:"area",height:350},credits:{enabled:!1},title:{text:"User Engagement"},xAxis:{categories:["Week 1","Week 2","Week 3","Week 4"]},yAxis:{title:{text:"Active Users"}},series:[{name:"Active Users",data:[r.totalUsers*.7,r.totalUsers*.8,r.totalUsers*.9,r.totalUsers],color:"#1cc88a"}]});return h?e.jsxs("div",{className:"analytics-charts-section mb-5",children:[e.jsxs("div",{className:"block md:hidden mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-chart-area text-red-500 text-[10px]"})}),e.jsx("span",{className:"text-xs font-semibold text-gray-800",children:"Analytics"})]}),e.jsx("div",{className:"space-y-3",children:Array.from({length:2}).map((l,x)=>e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"h-4 w-32 bg-gray-100 rounded animate-pulse mb-3"}),e.jsx("div",{className:"h-40 bg-gray-100 rounded-lg animate-pulse"})]},x))})]}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"card shadow",children:[e.jsxs("div",{className:"card-header bg-white border-0 py-3",children:[e.jsxs("h6",{className:"m-0 font-weight-bold text-danger",children:[e.jsx("i",{className:"fas fa-chart-area mr-2"}),"Analytics & Performance Metrics"]}),e.jsx("p",{className:"text-muted mb-0 small",children:"Detailed AI insights analytics and model performance insights"})]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"row",children:Array.from({length:4}).map((l,x)=>e.jsx("div",{className:"col-lg-6 mb-4",children:e.jsx("div",{className:"skeleton-chart",style:{height:"350px",backgroundColor:"#f8f9fc"}})},x))})})]})})]}):e.jsxs("div",{className:"charts-section mb-5",children:[e.jsx("div",{className:"block md:hidden mb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h6",{className:"text-sm font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-chart-bar text-red-500 text-xs"}),"Analytics"]})})}),e.jsxs("div",{className:"section-header mb-4 hidden md:block",children:[e.jsx("h5",{className:"section-title text-gray-800 font-weight-bold mb-1",children:"Analytics & Performance Metrics"}),e.jsx("p",{className:"section-subtitle text-muted mb-0",children:"Detailed AI insights analytics and model performance insights"})]}),e.jsxs("div",{className:"block md:hidden space-y-3 mb-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2 border-b border-gray-100",children:e.jsx("h6",{className:"text-xs font-bold text-gray-800 mb-1",children:"Financial Analysis"})}),e.jsxs("div",{className:"flex",style:{backgroundColor:"#f8f9fa"},children:[e.jsxs("button",{onClick:()=>y("trends"),className:`flex-1 py-2 border-0 text-xs position-relative ${d==="trends"?"text-red-500 bg-white":"text-gray-500 bg-transparent"}`,children:[e.jsx("i",{className:"fas fa-chart-line mr-1",style:{fontSize:"9px"}}),"Trends",d==="trends"&&e.jsx("div",{className:"position-absolute bg-red-500",style:{bottom:0,left:0,right:0,height:"2px"}})]}),e.jsxs("button",{onClick:()=>y("accuracy"),className:`flex-1 py-2 border-0 text-xs position-relative ${d==="accuracy"?"text-red-500 bg-white":"text-gray-500 bg-transparent"}`,children:[e.jsx("i",{className:"fas fa-bullseye mr-1",style:{fontSize:"9px"}}),"Accuracy",d==="accuracy"&&e.jsx("div",{className:"position-absolute bg-red-500",style:{bottom:0,left:0,right:0,height:"2px"}})]})]}),e.jsxs("div",{className:"p-3",children:[d==="trends"&&e.jsx(H,{highcharts:$,options:{...m(),chart:{...m().chart,height:200},title:{text:null}}}),d==="accuracy"&&e.jsx(H,{highcharts:$,options:{...b(),chart:{...b().chart,height:200},title:{text:null}}})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2 border-b border-gray-100",children:e.jsx("h6",{className:"text-xs font-bold text-gray-800 mb-1",children:"Performance Metrics"})}),e.jsxs("div",{className:"flex",style:{backgroundColor:"#f8f9fa"},children:[e.jsxs("button",{onClick:()=>p("performance"),className:`flex-1 py-2 border-0 text-xs position-relative ${j==="performance"?"text-red-500 bg-white":"text-gray-500 bg-transparent"}`,children:[e.jsx("i",{className:"fas fa-clock mr-1",style:{fontSize:"9px"}}),"Performance",j==="performance"&&e.jsx("div",{className:"position-absolute bg-red-500",style:{bottom:0,left:0,right:0,height:"2px"}})]}),e.jsxs("button",{onClick:()=>p("engagement"),className:`flex-1 py-2 border-0 text-xs position-relative ${j==="engagement"?"text-red-500 bg-white":"text-gray-500 bg-transparent"}`,children:[e.jsx("i",{className:"fas fa-users mr-1",style:{fontSize:"9px"}}),"Engagement",j==="engagement"&&e.jsx("div",{className:"position-absolute bg-red-500",style:{bottom:0,left:0,right:0,height:"2px"}})]})]}),e.jsxs("div",{className:"p-3",children:[j==="performance"&&e.jsx(H,{highcharts:$,options:{...u(),chart:{...u().chart,height:200},title:{text:null}}}),j==="engagement"&&e.jsx(H,{highcharts:$,options:{...w(),chart:{...w().chart,height:200},title:{text:null}}})]})]})]}),e.jsxs("div",{className:"hidden md:block",children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-lg-6 mb-4",children:e.jsxs("div",{className:"card shadow admin-card",children:[e.jsx("div",{className:"card-header py-3 admin-card-header",children:e.jsx("h6",{className:"m-0 font-weight-bold text-danger",children:"User Financial Trends Analysis"})}),e.jsx("div",{className:"card-body",children:e.jsx(H,{highcharts:$,options:{...m(),title:{text:null}}})})]})}),e.jsx("div",{className:"col-lg-6 mb-4",children:e.jsxs("div",{className:"card shadow admin-card",children:[e.jsx("div",{className:"card-header py-3 admin-card-header",children:e.jsx("h6",{className:"m-0 font-weight-bold text-danger",children:"Prediction Accuracy Distribution"})}),e.jsx("div",{className:"card-body",children:e.jsx(H,{highcharts:$,options:{...b(),title:{text:null}}})})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-8 mb-4",children:e.jsxs("div",{className:"card shadow admin-card",children:[e.jsx("div",{className:"card-header py-3 admin-card-header",children:e.jsx("h6",{className:"m-0 font-weight-bold text-danger",children:"Model Performance Over Time"})}),e.jsx("div",{className:"card-body",children:e.jsx(H,{highcharts:$,options:{...u(),title:{text:null}}})})]})}),e.jsx("div",{className:"col-lg-4 mb-4",children:e.jsxs("div",{className:"card shadow admin-card",children:[e.jsx("div",{className:"card-header py-3 admin-card-header",children:e.jsx("h6",{className:"m-0 font-weight-bold text-danger",children:"User Engagement"})}),e.jsx("div",{className:"card-body",children:e.jsx(H,{highcharts:$,options:{...w(),title:{text:null}}})})]})})]})]})]})},_={search:"",aiService:"all",riskLevel:"all",confidenceRange:{min:0,max:100},dateRange:{startDate:"",endDate:""},status:"all",userId:"",pageSize:10,currentPage:1,sortBy:"generated_at",sortOrder:"desc"},ie=[{value:"openrouter",label:"OpenRouter",color:"#007bff"},{value:"chatbot",label:"ChatBot",color:"#17a2b8"},{value:"prophet",label:"Prophet",color:"#28a745"},{value:"fallback",label:"Fallback",color:"#6c757d"}],ge=({show:r,insight:s,onClose:h})=>{const[d,y]=n.useState("overview");if(!r||!s)return null;const j=l=>{switch(l){case"high":return{label:"High Risk",color:"#dc3545",bgColor:"rgba(220, 53, 69, 0.1)",icon:"fa-exclamation-triangle"};case"medium":return{label:"Medium Risk",color:"#fd7e14",bgColor:"rgba(253, 126, 20, 0.1)",icon:"fa-exclamation-circle"};case"low":return{label:"Low Risk",color:"#28a745",bgColor:"rgba(40, 167, 69, 0.1)",icon:"fa-check-circle"};default:return{label:"Unknown",color:"#6c757d",bgColor:"rgba(108, 117, 125, 0.1)",icon:"fa-question-circle"}}},p=l=>l<1e3?`${l}ms`:`${(l/1e3).toFixed(2)}s`,m=s.insights?.riskAssessment?.level||s.risk_assessment?.level||"unknown",b=j(m),u=Math.round((s.confidence_level||0)*100),w=ie.find(l=>l.value===s.ai_service);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:h}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:h,children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",style:{margin:"0.5rem auto",maxWidth:"calc(100vw - 1rem)"},onClick:l=>l.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"90vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"40px",height:"40px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-brain fa-lg"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold",children:"AI Insight Analysis"}),e.jsx("small",{style:{opacity:.9},children:s.profiles?.full_name||s.profiles?.email||"Unknown User"})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:h,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsx("div",{className:"px-3 py-2",style:{background:"#f8f9fa",borderBottom:"1px solid #e9ecef"},children:e.jsxs("div",{className:"row text-center g-2",children:[e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:`fas ${b.icon} mr-2`,style:{color:b.color}}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Risk"}),e.jsx("strong",{style:{color:b.color,fontSize:"0.8rem"},children:b.label.split(" ")[0]})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-percentage text-danger mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Confidence"}),e.jsxs("strong",{className:"text-danger",style:{fontSize:"0.8rem"},children:[u,"%"]})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-bolt text-danger mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Time"}),e.jsx("strong",{className:"text-danger",style:{fontSize:"0.8rem"},children:p(s.generation_time_ms||0)})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-robot text-danger mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Service"}),e.jsx("strong",{className:"text-danger",style:{fontSize:"0.8rem"},children:w?.label||s.ai_service})]})]})})]})}),e.jsx("div",{className:"px-3 pt-2",children:e.jsx("div",{className:"d-flex",style:{gap:"6px"},children:[{id:"overview",icon:"fa-chart-pie",label:"Overview"},{id:"insights",icon:"fa-lightbulb",label:"Insights"},{id:"technical",icon:"fa-microchip",label:"Technical"},{id:"related",icon:"fa-project-diagram",label:"Related"}].map(l=>e.jsxs("button",{className:`btn btn-sm ${d===l.id?"btn-danger":"btn-outline-secondary"}`,onClick:()=>y(l.id),style:{borderRadius:"16px",padding:"4px 12px",fontSize:"0.8rem"},children:[e.jsx("i",{className:`fas ${l.icon} mr-1`}),l.label]},l.id))})}),e.jsxs("div",{className:"modal-body py-3",style:{maxHeight:"45vh",overflowY:"auto"},children:[d==="overview"&&e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-7",children:[s.insights?.summary&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-file-alt mr-2"}),"AI Summary"]}),e.jsx("div",{className:"p-2",style:{background:"#fff5f5",borderRadius:"8px",borderLeft:"3px solid #dc3545"},children:e.jsx("p",{className:"mb-0",style:{fontSize:"0.85rem",lineHeight:1.6},children:s.insights.summary})})]}),e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-tachometer-alt mr-2"}),"Confidence"]}),e.jsxs("div",{className:"p-2",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsx("small",{children:"Analysis Confidence"}),e.jsxs("strong",{className:u>=80?"text-success":u>=60?"text-warning":"text-danger",style:{fontSize:"0.85rem"},children:[u,"%"]})]}),e.jsx("div",{className:"progress",style:{height:"6px",borderRadius:"3px"},children:e.jsx("div",{className:`progress-bar ${u>=80?"bg-success":u>=60?"bg-warning":"bg-danger"}`,style:{width:`${u}%`,borderRadius:"3px"}})})]})]})]}),e.jsxs("div",{className:"col-lg-5",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Details"]}),e.jsxs("div",{className:"p-2",style:{background:"#f8f9fa",borderRadius:"8px",fontSize:"0.85rem"},children:[e.jsxs("div",{className:"d-flex justify-content-between py-1",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"ID"}),e.jsxs("code",{style:{fontSize:"0.75rem"},children:[s.id?.substring(0,12),"..."]})]}),e.jsxs("div",{className:"d-flex justify-content-between py-1",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Model"}),e.jsx("span",{style:{fontSize:"0.8rem"},children:s.model_used?.split("/").pop()||"N/A"})]}),e.jsxs("div",{className:"d-flex justify-content-between py-1",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Status"}),e.jsx(X,{bg:s.processing_status==="completed"?"success":"warning",style:{fontSize:"0.7rem"},children:s.processing_status||"Unknown"})]}),e.jsxs("div",{className:"d-flex justify-content-between py-1",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Views"}),e.jsx("span",{children:s.access_count||0})]}),e.jsxs("div",{className:"d-flex justify-content-between py-1",children:[e.jsx("small",{className:"text-muted",children:"Expires"}),e.jsx("span",{style:{fontSize:"0.8rem"},children:s.expires_at?new Date(s.expires_at).toLocaleDateString():"N/A"})]})]})]})]}),d==="insights"&&e.jsxs("div",{children:[(s.insights?.riskAssessment||s.risk_assessment)&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-shield-alt mr-2"}),"Risk Assessment"]}),e.jsxs("div",{className:"p-2",style:{background:b.bgColor,borderRadius:"8px",border:`1px solid ${b.color}20`},children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:`fas ${b.icon} mr-2`,style:{color:b.color}}),e.jsx("strong",{style:{color:b.color,fontSize:"0.85rem"},children:b.label})]}),(s.insights?.riskAssessment?.factors||s.risk_assessment?.factors||[]).length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("small",{className:"text-muted",children:"Risk Factors:"}),(s.insights?.riskAssessment?.factors||s.risk_assessment?.factors||[]).map((l,x)=>e.jsxs("div",{className:"d-flex align-items-start mt-1",children:[e.jsx("i",{className:"fas fa-exclamation-circle text-warning mr-2",style:{fontSize:"0.65rem",marginTop:"4px"}}),e.jsx("small",{children:l})]},x))]}),(s.insights?.riskAssessment?.mitigationSuggestions||s.risk_assessment?.mitigationSuggestions||[]).length>0&&e.jsxs("div",{children:[e.jsx("small",{className:"text-muted",children:"Suggestions:"}),(s.insights?.riskAssessment?.mitigationSuggestions||s.risk_assessment?.mitigationSuggestions||[]).map((l,x)=>e.jsxs("div",{className:"d-flex align-items-start mt-1",children:[e.jsx("i",{className:"fas fa-check-circle text-success mr-2",style:{fontSize:"0.65rem",marginTop:"4px"}}),e.jsx("small",{children:l})]},x))]})]})]}),(s.insights?.recommendations||s.recommendations||[]).length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-tasks mr-2"}),"Recommendations"]}),e.jsx("div",{className:"row g-2",children:(s.insights?.recommendations||s.recommendations||[]).slice(0,4).map((l,x)=>e.jsx("div",{className:"col-6",children:e.jsx("div",{className:"p-2 h-100",style:{background:"#f8f9fa",borderRadius:"6px"},children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("span",{className:"badge badge-danger mr-2",style:{fontSize:"0.65rem",minWidth:"18px"},children:x+1}),e.jsx("small",{children:l})]})})},x))})]}),(s.insights?.opportunityAreas||s.opportunity_areas||[]).length>0&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-star mr-2"}),"Opportunities"]}),e.jsx("div",{className:"d-flex flex-wrap",style:{gap:"6px"},children:(s.insights?.opportunityAreas||s.opportunity_areas||[]).slice(0,6).map((l,x)=>e.jsxs("span",{className:"badge badge-light px-2 py-1",style:{fontSize:"0.75rem",border:"1px solid #dee2e6"},children:[e.jsx("i",{className:"fas fa-lightbulb text-warning mr-1"}),l]},x))})]})]}),d==="technical"&&e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-server mr-2"}),"Processing"]}),e.jsx("div",{className:"p-2",style:{background:"#f8f9fa",borderRadius:"8px"},children:e.jsx("table",{className:"table table-sm table-borderless mb-0",style:{fontSize:"0.8rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted py-1",children:"Time"}),e.jsx("td",{className:"text-right py-1",children:e.jsx("strong",{children:p(s.generation_time_ms||0)})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted py-1",children:"Version"}),e.jsx("td",{className:"text-right py-1",children:s.model_version||"N/A"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted py-1",children:"Status"}),e.jsx("td",{className:"text-right py-1",children:e.jsx(X,{bg:s.processing_status==="completed"?"success":"warning",style:{fontSize:"0.65rem"},children:s.processing_status})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted py-1",children:"Rate Limited"}),e.jsx("td",{className:"text-right py-1",children:e.jsx(X,{bg:s.rate_limited?"warning":"success",style:{fontSize:"0.65rem"},children:s.rate_limited?"Yes":"No"})})]})]})})})]}),e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-coins mr-2"}),"Tokens"]}),e.jsx("div",{className:"p-2",style:{background:"#f8f9fa",borderRadius:"8px"},children:s.token_usage?e.jsx("table",{className:"table table-sm table-borderless mb-0",style:{fontSize:"0.8rem"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted py-1",children:"Prompt"}),e.jsx("td",{className:"text-right py-1",children:s.token_usage.prompt_tokens?.toLocaleString()||0})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted py-1",children:"Completion"}),e.jsx("td",{className:"text-right py-1",children:s.token_usage.completion_tokens?.toLocaleString()||0})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"text-muted py-1",children:"Total"}),e.jsx("td",{className:"text-right py-1",children:e.jsx("strong",{className:"text-danger",children:s.token_usage.total_tokens?.toLocaleString()||0})})]})]})}):e.jsx("p",{className:"text-muted mb-0 text-center py-2",style:{fontSize:"0.8rem"},children:"No token data"})})]}),s.insights&&e.jsxs("div",{className:"col-12",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-code mr-2"}),"Raw Data"]}),e.jsx("pre",{className:"p-2 mb-0",style:{background:"#1e1e1e",color:"#d4d4d4",borderRadius:"8px",maxHeight:"150px",overflow:"auto",fontSize:"0.7rem"},children:JSON.stringify(s.insights,null,2)})]})]}),d==="related"&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-chart-line mr-2"}),"Related Predictions"]}),s.relatedPredictions?.length>0?e.jsx("div",{className:"table-responsive mb-3",children:e.jsxs("table",{className:"table table-sm table-hover mb-0",style:{fontSize:"0.8rem"},children:[e.jsx("thead",{style:{background:"#f8f9fa"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2",children:"ID"}),e.jsx("th",{className:"py-2",children:"Timeframe"}),e.jsx("th",{className:"py-2",children:"Confidence"}),e.jsx("th",{className:"py-2",children:"Date"})]})}),e.jsx("tbody",{children:s.relatedPredictions.map(l=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-1",children:e.jsxs("code",{style:{fontSize:"0.7rem"},children:[l.id.substring(0,8),"..."]})}),e.jsx("td",{className:"py-1",children:e.jsx(X,{bg:"info",style:{fontSize:"0.65rem"},children:l.timeframe})}),e.jsx("td",{className:"py-1",children:e.jsxs("span",{className:`text-${l.confidence_score>=.8?"success":l.confidence_score>=.6?"warning":"danger"}`,children:[Math.round(l.confidence_score*100),"%"]})}),e.jsx("td",{className:"py-1",children:new Date(l.generated_at).toLocaleDateString()})]},l.id))})]})}):e.jsxs("div",{className:"text-center py-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsx("i",{className:"fas fa-chart-line fa-2x text-muted mb-2"}),e.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem"},children:"No related predictions"})]}),e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-history mr-2"}),"Usage History"]}),(s.usageHistory||[]).length>0?e.jsx("div",{className:"d-flex flex-wrap",style:{gap:"8px"},children:(s.usageHistory||[]).map((l,x)=>e.jsxs("div",{className:"p-2 text-center",style:{background:"#f8f9fa",borderRadius:"6px",minWidth:"100px"},children:[e.jsx("small",{className:"text-muted d-block",children:l.date}),e.jsxs("strong",{className:"text-danger",style:{fontSize:"0.85rem"},children:[l.access_count," views"]})]},x))}):e.jsxs("div",{className:"text-center py-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsx("i",{className:"fas fa-history fa-2x text-muted mb-2"}),e.jsx("p",{className:"text-muted mb-0",style:{fontSize:"0.85rem"},children:"No usage history"})]})]})]}),e.jsxs("div",{className:"modal-footer border-0 py-2",style:{background:"#f8f9fa"},children:[e.jsxs("small",{className:"text-muted mr-auto",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"fas fa-fingerprint mr-1"}),"ID: ",e.jsxs("code",{style:{fontSize:"0.7rem"},children:[s.id?.substring(0,12),"..."]})]}),e.jsxs("button",{type:"button",className:"btn btn-danger btn-sm",onClick:h,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Close"]})]})]})})})]})},fe=({show:r,users:s,services:h,onClose:d,onInsightGenerated:y,onGenerate:j})=>{const p=[{id:"gpt-oss-20b",name:"Default Model",description:"Experimental model"},{id:"openai/gpt-5",name:"GPT-5",description:"Most advanced model"},{id:"openai/gpt-4o-mini",name:"GPT-4o Mini",description:"Fast and efficient"},{id:"openai/gpt-5-mini",name:"GPT-5 Mini",description:"Compact version"},{id:"openai/gpt-4.1-mini",name:"GPT-4.1 Mini",description:"Lightweight option"},{id:"openai/gpt-4.1",name:"GPT-4.1",description:"Enhanced reasoning"},{id:"openai/gpt-4o",name:"GPT-4o",description:"Multimodal capable"}],[m,b]=n.useState({user_id:"",prediction_id:"",ai_service:"openrouter",model_used:"gpt-oss-20b",confidence_threshold:.8,generate_recommendations:!0,include_risk_assessment:!0,analyze_trends:!0}),[u,w]=n.useState(!1),[l,x]=n.useState({}),[N,A]=n.useState(""),[C,k]=n.useState(!1),[i,t]=n.useState([]),[f,z]=n.useState(!1);if(!r)return null;const F=async a=>{if(!(!a||!I)){z(!0);try{const{data:c,error:v}=await I.from("prophet_predictions").select("id, user_id, generated_at, predictions, confidence_score, timeframe").eq("user_id",a).order("generated_at",{ascending:!1});if(v)throw v;t(c||[])}catch(c){console.error("Error fetching predictions:",c),t([])}finally{z(!1)}}};n.useEffect(()=>{r&&(b({user_id:"",prediction_id:"",ai_service:"openrouter",model_used:"gpt-oss-20b",confidence_threshold:.8,generate_recommendations:!0,include_risk_assessment:!0,analyze_trends:!0}),A(""),k(!1),x({}),w(!1),t([]))},[r]),n.useEffect(()=>{m.user_id?(F(m.user_id),b(a=>({...a,prediction_id:""}))):t([])},[m.user_id]);const D=(a,c)=>{b(v=>({...v,[a]:c})),l[a]&&x(v=>({...v,[a]:""}))},K=a=>{b(c=>({...c,user_id:a.id})),A(a.full_name||a.email),k(!1),l.user_id&&x(c=>({...c,user_id:""}))},Q=()=>{const a={};return m.user_id||(a.user_id="Please select a user"),m.prediction_id||(a.prediction_id="Please select a prediction to base insights on"),m.ai_service||(a.ai_service="Please select an AI service"),m.model_used.trim()||(a.model_used="Please specify the AI model"),(m.confidence_threshold<0||m.confidence_threshold>1)&&(a.confidence_threshold="Confidence threshold must be between 0 and 1"),x(a),Object.keys(a).length===0},Z=async a=>{if(a.preventDefault(),!!Q()){w(!0);try{await j(m)?(y(),P()):x({submit:"Failed to generate AI insight. Please try again."})}catch(c){console.error("Error generating AI insight:",c),x({submit:"An unexpected error occurred. Please try again."})}finally{w(!1)}}},P=()=>{u||(b({user_id:"",prediction_id:"",ai_service:"openrouter",model_used:"gpt-oss-20b",confidence_threshold:.8,generate_recommendations:!0,include_risk_assessment:!0,analyze_trends:!0}),A(""),k(!1),x({}),w(!1),t([]),z(!1),d())},E=s.filter(a=>{const c=N.toLowerCase(),v=a.full_name?.toLowerCase()||"",R=a.email.toLowerCase();return v.includes(c)||R.includes(c)}),U=s.find(a=>a.id===m.user_id),o=ie.find(a=>a.value===m.ai_service);return e.jsx("div",{className:"modal fade show",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,overflowY:"auto"},"aria-modal":"true",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-lg",style:{margin:"0.5rem auto",maxWidth:"calc(100vw - 1rem)"},children:e.jsxs("div",{className:"modal-content",style:{maxHeight:"90vh",overflow:"hidden"},children:[e.jsxs("div",{className:"modal-header bg-gradient-danger text-white border-0",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center",children:[e.jsx("div",{className:"modal-icon-container mr-3",children:e.jsx("i",{className:"fas fa-magic"})}),e.jsxs("div",{children:[e.jsx("div",{className:"modal-title-main",children:"Generate AI Insights"}),e.jsx("div",{className:"modal-subtitle",children:"Generate AI-powered financial insights for a user"})]})]}),e.jsx("button",{type:"button",className:"close text-white",onClick:P,disabled:u,"aria-label":"Close",style:{textShadow:"none",opacity:.9},children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"alert alert-info",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),e.jsx("strong",{children:"Note:"})," AI insights will be automatically generated based on the selected Prophet prediction data, user's transaction history, and predictive financial modeling."]}),e.jsxs("form",{onSubmit:Z,children:[l.submit&&e.jsxs("div",{className:"alert alert-danger mb-3",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),l.submit]}),e.jsxs("div",{className:"modal-section-card mb-4",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-user mr-2"}),"User Selection"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Select User ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"position-relative",children:[e.jsx("input",{type:"text",className:`form-control ${l.user_id?"is-invalid":""}`,placeholder:"Search for a user...",value:N,onChange:a=>{A(a.target.value),k(!0)},onFocus:()=>k(!0),disabled:u}),C&&E.length>0&&e.jsx("div",{className:"dropdown-menu show w-100",style:{maxHeight:"200px",overflowY:"auto",position:"absolute",zIndex:1e3},children:E.map(a=>e.jsxs("button",{type:"button",className:"dropdown-item d-flex align-items-center",onClick:()=>K(a),children:[e.jsx("img",{src:a.avatar_url||"../images/placeholder.png",alt:"Avatar",className:"rounded-circle mr-2",style:{width:"30px",height:"30px",objectFit:"cover"},onError:c=>{c.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{children:[e.jsx("div",{className:"font-weight-bold",children:a.full_name||a.email.split("@")[0]}),e.jsx("small",{className:"text-muted",children:a.email})]})]},a.id))}),l.user_id&&e.jsx("div",{className:"invalid-feedback",children:l.user_id})]}),U&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"alert alert-info py-2 d-flex align-items-center",children:[e.jsx("img",{src:U.avatar_url||"../images/placeholder.png",alt:"Avatar",className:"rounded-circle mr-2",style:{width:"30px",height:"30px",objectFit:"cover"},onError:a=>{a.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{children:[e.jsx("strong",{children:"Selected:"})," ",U.full_name||U.email.split("@")[0]," ",e.jsxs("small",{className:"text-muted",children:["(",U.email,")"]})]})]})})]})})]}),U&&e.jsxs("div",{className:"modal-section-card mb-4",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-chart-line mr-2"}),"Prediction Selection"]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Select Prediction to Base Insights On ",e.jsx("span",{className:"text-danger",children:"*"})]}),f?e.jsxs("div",{className:"text-center py-3",children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Loading predictions..."]}):i.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:`form-control ${l.prediction_id?"is-invalid":""}`,value:m.prediction_id,onChange:a=>D("prediction_id",a.target.value),disabled:u,children:[e.jsx("option",{value:"",children:"Choose a prediction..."}),i.map(a=>e.jsxs("option",{value:a.id,children:[a.timeframe," - ",new Date(a.generated_at).toLocaleDateString(),"(Confidence: ",Math.round(a.confidence_score*100),"%)"]},a.id))]}),l.prediction_id&&e.jsx("div",{className:"invalid-feedback",children:l.prediction_id}),e.jsx("small",{className:"form-text text-muted",children:"AI insights will be generated based on the selected prediction data"})]}):e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),e.jsx("strong",{children:"No predictions found for this user."}),e.jsx("br",{}),"The user needs to have existing predictions before generating AI insights.",e.jsx("br",{}),e.jsx("small",{children:"Please create predictions first in the Predictions module."})]})]}),m.prediction_id&&e.jsx("div",{className:"mt-3",children:(()=>{const a=i.find(c=>c.id===m.prediction_id);return a?e.jsx("div",{className:"alert alert-info py-2",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("strong",{children:"Timeframe:"}),e.jsx("div",{className:"text-muted",children:a.timeframe})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("strong",{children:"Generated:"}),e.jsx("div",{className:"text-muted",children:new Date(a.generated_at).toLocaleDateString()})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("strong",{children:"Confidence:"}),e.jsxs("div",{className:"text-muted",children:[Math.round(a.confidence_score*100),"%"]})]})]})}):null})()})]})]}),e.jsxs("div",{className:"modal-section-card mb-4",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-brain mr-2"}),"AI Configuration"]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["AI Service ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("select",{className:"form-control",value:"openrouter",disabled:!0,required:!0,children:e.jsx("option",{value:"openrouter",children:"OpenRouter"})}),e.jsx("small",{className:"form-text text-muted",children:"Select the AI service to use for generating insights"})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["AI Model ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("select",{className:`form-control ${l.model_used?"is-invalid":""}`,value:m.model_used,onChange:a=>D("model_used",a.target.value),disabled:u,required:!0,children:p.map(a=>e.jsxs("option",{value:a.id,children:[a.name," - ",a.description]},a.id))}),l.model_used&&e.jsx("div",{className:"invalid-feedback",children:l.model_used}),e.jsx("small",{className:"form-text text-muted",children:"Specify the exact model identifier to use"})]})})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[e.jsx("i",{className:"fas fa-percentage mr-1"}),"Confidence Threshold: ",e.jsxs("span",{className:"font-weight-bold text-primary",children:[Math.round(m.confidence_threshold*100),"%"]})]}),e.jsx("input",{type:"range",className:"form-control-range",min:"0",max:"1",step:"0.01",value:m.confidence_threshold,onChange:a=>D("confidence_threshold",parseFloat(a.target.value)),disabled:u}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("small",{className:"text-muted",children:"0% - Low"}),e.jsx("small",{className:"text-muted",children:"50% - Medium"}),e.jsx("small",{className:"text-muted",children:"100% - High"})]}),e.jsx("small",{className:"form-text text-muted",children:"Minimum confidence level required for generated insights"})]})]})]}),e.jsxs("div",{className:"modal-section-card mb-4",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-cogs mr-2"}),"Generation Options"]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("div",{className:"custom-control custom-checkbox mb-2",children:[e.jsx("input",{type:"checkbox",className:"custom-control-input",id:"generate_recommendations",checked:m.generate_recommendations,onChange:a=>D("generate_recommendations",a.target.checked),disabled:u}),e.jsxs("label",{className:"custom-control-label",htmlFor:"generate_recommendations",children:[e.jsx("i",{className:"fas fa-lightbulb mr-2 text-warning"}),"Generate Recommendations"]})]}),e.jsx("small",{className:"form-text text-muted ml-4",children:"Include personalized financial recommendations in the insight"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("div",{className:"custom-control custom-checkbox mb-2",children:[e.jsx("input",{type:"checkbox",className:"custom-control-input",id:"include_risk_assessment",checked:m.include_risk_assessment,onChange:a=>D("include_risk_assessment",a.target.checked),disabled:u}),e.jsxs("label",{className:"custom-control-label",htmlFor:"include_risk_assessment",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-2 text-danger"}),"Include Risk Assessment"]})]}),e.jsx("small",{className:"form-text text-muted ml-4",children:"Analyze and assess financial risks based on spending patterns"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("div",{className:"custom-control custom-checkbox mb-2",children:[e.jsx("input",{type:"checkbox",className:"custom-control-input",id:"analyze_trends",checked:m.analyze_trends,onChange:a=>D("analyze_trends",a.target.checked),disabled:u}),e.jsxs("label",{className:"custom-control-label",htmlFor:"analyze_trends",children:[e.jsx("i",{className:"fas fa-chart-line mr-2 text-success"}),"Analyze Trends"]})]}),e.jsx("small",{className:"form-text text-muted ml-4",children:"Include trend analysis of income, expenses, and savings patterns"})]})]})]}),U&&m.prediction_id&&e.jsxs("div",{className:"modal-section-card mb-4",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Generation Summary"]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("strong",{children:"Target User:"}),e.jsx("div",{className:"text-muted",children:U.full_name||U.email})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("strong",{children:"Base Prediction:"}),e.jsx("div",{className:"text-muted",children:(()=>{const a=i.find(c=>c.id===m.prediction_id);return a?`${a.timeframe} (${Math.round(a.confidence_score*100)}%)`:"Unknown"})()})]})]}),e.jsxs("div",{className:"row mt-2",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("strong",{children:"AI Service:"}),e.jsx("div",{className:"text-muted",children:o?.label||m.ai_service})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("strong",{children:"Model:"}),e.jsx("div",{className:"text-muted",children:m.model_used})]})]}),e.jsxs("div",{className:"row mt-2",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("strong",{children:"Confidence Threshold:"}),e.jsxs("div",{className:"text-muted",children:[Math.round(m.confidence_threshold*100),"%"]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("strong",{children:"Options:"}),e.jsx("div",{className:"text-muted",children:[m.generate_recommendations&&"Recommendations",m.include_risk_assessment&&"Risk Assessment",m.analyze_trends&&"Trend Analysis"].filter(Boolean).join(", ")||"None selected"})]})]})]})]}),e.jsxs("div",{className:"modal-footer border-0 px-0 pb-0",children:[e.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:P,disabled:u,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Cancel"]}),e.jsx("button",{type:"submit",className:"btn btn-danger",disabled:u||!m.user_id||!m.prediction_id,children:u?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-1"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-magic mr-1"}),"Generate Insights"]})})]})]})]})]})})})},pe=({show:r,insight:s,onClose:h,onInsightDeleted:d,onDelete:y})=>{const[j,p]=n.useState(!1),[m,b]=n.useState(""),[u,w]=n.useState("");if(!r||!s)return null;const l=async()=>{p(!0),b("");try{await y(s.insightId)&&(d(),h())}catch(k){b(k.message||"Failed to delete insight"),p(!1)}},N=(k=>{switch(k){case"high":return{label:"High",color:"#dc3545",bg:"danger"};case"medium":return{label:"Medium",color:"#fd7e14",bg:"warning"};case"low":return{label:"Low",color:"#28a745",bg:"success"};default:return{label:"Unknown",color:"#6c757d",bg:"secondary"}}})(s.riskLevel),A=ie.find(k=>k.value===s.aiService),C=u.toLowerCase()==="delete";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:h}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:h,children:e.jsx("div",{className:"modal-dialog modal-md modal-dialog-centered",style:{margin:"0.5rem auto",maxWidth:"calc(100vw - 1rem)"},onClick:k=>k.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"90vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"40px",height:"40px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-trash-alt fa-lg"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold",children:"Delete AI Insight"}),e.jsx("small",{style:{opacity:.9},children:"This action cannot be undone"})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:h,disabled:j,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsxs("div",{className:"modal-body py-3",style:{maxHeight:"60vh",overflowY:"auto"},children:[m&&e.jsxs("div",{className:"alert alert-danger py-2 mb-3",style:{fontSize:"0.85rem"},children:[e.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),m]}),e.jsx("div",{className:"p-3 mb-3",style:{background:"#fff5f5",borderRadius:"8px",borderLeft:"3px solid #dc3545"},children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-danger mr-2 mt-1"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-danger",style:{fontSize:"0.9rem"},children:"Permanent Deletion"}),e.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.8rem"},children:"This will permanently remove the AI insight and all associated data including analytics, recommendations, and usage history."})]})]})}),e.jsxs("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[s.avatarUrl?e.jsx("img",{src:s.avatarUrl,alt:s.username,className:"rounded-circle mr-2",style:{width:"36px",height:"36px",objectFit:"cover"}}):e.jsx("div",{className:"d-flex align-items-center justify-content-center bg-danger text-white rounded-circle mr-2",style:{width:"36px",height:"36px",fontSize:"0.9rem",fontWeight:600},children:s.username?.charAt(0)?.toUpperCase()||"U"}),e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:"0.9rem"},children:s.username||"Unknown User"}),e.jsxs("div",{className:"d-flex align-items-center",style:{gap:"6px"},children:[e.jsxs(X,{bg:N.bg,style:{fontSize:"0.65rem"},children:[N.label," Risk"]}),e.jsx(X,{bg:"info",style:{fontSize:"0.65rem"},children:A?.label||s.aiService})]})]})]}),e.jsxs("div",{className:"row text-center g-2",children:[e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"p-2",style:{background:"white",borderRadius:"6px"},children:[e.jsxs("div",{className:"text-danger font-weight-bold",style:{fontSize:"0.95rem"},children:[s.confidenceLevel,"%"]}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.7rem"},children:"Confidence"})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"p-2",style:{background:"white",borderRadius:"6px"},children:[e.jsx("div",{className:"text-danger font-weight-bold",style:{fontSize:"0.95rem"},children:s.tokenUsage||0}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.7rem"},children:"Tokens"})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"p-2",style:{background:"white",borderRadius:"6px"},children:[e.jsxs("div",{className:"text-danger font-weight-bold",style:{fontSize:"0.95rem"},children:[s.processingTime||0,"ms"]}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.7rem"},children:"Time"})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"p-2",style:{background:"white",borderRadius:"6px"},children:[e.jsx("div",{className:"text-danger font-weight-bold",style:{fontSize:"0.95rem"},children:s.status}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.7rem"},children:"Status"})]})})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.85rem"},children:[e.jsx("i",{className:"fas fa-list mr-2"}),"Data to be removed:"]}),e.jsx("div",{className:"d-flex flex-wrap",style:{gap:"6px"},children:[{icon:"fa-brain",label:"AI Analysis"},{icon:"fa-chart-bar",label:"Metrics"},{icon:"fa-shield-alt",label:"Risk Data"},{icon:"fa-lightbulb",label:"Recommendations"},{icon:"fa-history",label:"Usage Logs"},{icon:"fa-coins",label:"Token Data"}].map((k,i)=>e.jsxs("span",{className:"badge badge-light px-2 py-1",style:{fontSize:"0.75rem",border:"1px solid #dee2e6"},children:[e.jsx("i",{className:`fas ${k.icon} text-danger mr-1`}),k.label]},i))})]}),e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("label",{className:"mb-2",style:{fontSize:"0.85rem"},children:[e.jsx("i",{className:"fas fa-keyboard text-danger mr-2"}),"Type ",e.jsx("strong",{className:"text-danger",children:"delete"})," to confirm:"]}),e.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Type 'delete' to confirm",value:u,onChange:k=>w(k.target.value),disabled:j,style:{fontSize:"0.85rem"}})]})]}),e.jsxs("div",{className:"modal-footer border-0 py-2",style:{background:"#f8f9fa"},children:[e.jsxs("small",{className:"text-muted mr-auto",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"fas fa-fingerprint mr-1"}),"ID: ",e.jsxs("code",{style:{fontSize:"0.7rem"},children:[s.insightId?.substring(0,12),"..."]})]}),e.jsxs("button",{type:"button",className:"btn btn-secondary btn-sm mr-2",onClick:h,disabled:j,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Cancel"]}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:l,disabled:j||!C,children:j?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm mr-1"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-trash-alt mr-1"}),"Delete"]})})]})]})})})]})},be=()=>{const[r,s]=n.useState([]),[h,d]=n.useState({totalInsights:0,activeServices:0,averageConfidence:0,totalUsers:0,riskDistribution:{high:0,medium:0,low:0,unknown:0},serviceUsage:{openrouter:0,chatbot:0,prophet:0,fallback:0},processingMetrics:{averageTime:0,totalTokens:0,successRate:0},usageToday:0,rateLimitedToday:0}),[y,j]=n.useState([]),[p,m]=n.useState([]),[b,u]=n.useState(0),[w,l]=n.useState(0),[x,N]=n.useState(!0),[A,C]=n.useState(null),[k,i]=n.useState(null),{showSuccessToast:t,showErrorToast:f}=me(),z=n.useCallback(async()=>{try{if(!I)throw new Error("Supabase client not available");const{data:o,error:a}=await I.from("profiles").select("id, full_name, email, avatar_url, role, created_at, last_login, is_active").order("full_name",{ascending:!0});if(a)throw a;const c=(o||[]).map(v=>({id:v.id,email:v.email||"",full_name:v.full_name,avatar_url:v.avatar_url,role:v.role||"user",created_at:v.created_at,last_login:v.last_login,is_active:v.is_active??!0}));j(c)}catch(o){console.error("Error fetching users:",o),C(o.message)}},[]),F=n.useCallback(async(o,a)=>{try{if(C(null),!I)throw new Error("Supabase client not available");let c=I.from("ai_insights").select(`
          id,
          user_id,
          prediction_id,
          ai_service,
          model_used,
          insights,
          risk_assessment,
          recommendations,
          opportunity_areas,
          confidence_level,
          daily_usage_count,
          rate_limited,
          generated_at,
          expires_at,
          access_count,
          last_accessed_at,
          model_version,
          processing_status,
          generation_time_ms,
          token_usage
        `,{count:"exact"});o.search&&(c=c.or(`insights->>'summary'.ilike.%${o.search}%`)),o.aiService!=="all"&&(c=c.eq("ai_service",o.aiService)),o.riskLevel!=="all"&&(c=c.or(`insights->'riskAssessment'->>'level'.eq.${o.riskLevel},risk_assessment->>'level'.eq.${o.riskLevel}`)),o.confidenceRange.min>0&&(c=c.gte("confidence_level",o.confidenceRange.min/100)),o.confidenceRange.max<100&&(c=c.lte("confidence_level",o.confidenceRange.max/100)),o.dateRange.startDate&&(c=c.gte("generated_at",o.dateRange.startDate)),o.dateRange.endDate&&(c=c.lte("generated_at",o.dateRange.endDate)),o.userId&&(c=c.eq("user_id",o.userId));const R={processing_time:"generation_time_ms",username:"user_id",riskLevel:"risk_assessment",aiService:"ai_service",status:"processing_status"}[o.sortBy]||o.sortBy;c=c.order(R,{ascending:o.sortOrder==="asc"});const O=(o.currentPage-1)*o.pageSize;c=c.range(O,O+o.pageSize-1);const{data:B,error:M,count:L}=await c;if(M)throw M;const V=a||y,Y=(B||[]).map(S=>{const G=V.find(ee=>ee.id===S.user_id),J=S.insights?.riskAssessment?.level||S.risk_assessment?.level||"unknown";let q="active";return new Date(S.expires_at)<new Date&&(q="expired"),S.processing_status==="failed"&&(q="error"),{insightId:S.id,userId:S.user_id,username:G?.full_name||G?.email?.split("@")[0]||`User ${S.user_id.substring(0,8)}`,avatarUrl:G?.avatar_url||void 0,aiService:S.ai_service,modelUsed:S.model_used,confidenceLevel:Math.round((S.confidence_level||0)*100),riskLevel:J,generatedDate:S.generated_at,processingTime:S.generation_time_ms||0,tokenUsage:S.token_usage?.total_tokens||0,accessCount:S.access_count||0,status:q,lastAccessed:S.last_accessed_at}});s(Y),l(L||0),u(Math.ceil((L||0)/o.pageSize))}catch(c){console.error("Error fetching insights:",c),C(c.message),f(`Failed to load insights: ${c.message}`)}},[f]),D=n.useCallback(async()=>{try{if(!I)return;const{count:o,error:a}=await I.from("ai_insights").select("*",{count:"exact",head:!0});if(a){console.warn("Error getting insights count:",a);return}const{data:c,error:v}=await I.from("ai_insights").select("ai_service, confidence_level, risk_assessment, insights, generated_at, rate_limited, generation_time_ms, token_usage");if(v){console.warn("Error getting insights data:",v);return}if(!c)return;const R={high:0,medium:0,low:0,unknown:0};c.forEach(g=>{const T=g.insights?.riskAssessment?.level||g.risk_assessment?.level||"unknown";R[T]++});const O={openrouter:0,chatbot:0,prophet:0,fallback:0};c.forEach(g=>{O[g.ai_service]++});const B=c.filter(g=>g.generation_time_ms).map(g=>g.generation_time_ms),M=c.filter(g=>g.token_usage?.total_tokens).reduce((g,T)=>g+T.token_usage.total_tokens,0),L=c.length>0?c.reduce((g,T)=>g+(T.confidence_level||0),0)/c.length*100:0,V=B.length>0?B.reduce((g,T)=>g+T,0)/B.length:0,Y=new Date().toISOString().split("T")[0],[S,G,J]=await Promise.allSettled([I.from("ai_insights").select("*",{count:"exact",head:!0}).gte("generated_at",Y),I.from("ai_insights").select("*",{count:"exact",head:!0}).eq("rate_limited",!0).gte("generated_at",Y),I.from("ai_insights").select("user_id",{count:"exact"}).not("user_id","is",null)]),q=S.status==="fulfilled"?S.value.count:0,ee=G.status==="fulfilled"?G.value.count:0,ae=J.status==="fulfilled"?J.value.data:[],se=new Set(ae?.map(g=>g.user_id)||[]),te={totalInsights:o||0,activeServices:se.size,averageConfidence:Math.round(L),totalUsers:se.size,riskDistribution:R,serviceUsage:O,processingMetrics:{averageTime:Math.round(V),totalTokens:M,successRate:c.length>0?Math.round(c.filter(g=>g.processing_status!=="failed").length/c.length*100):0},usageToday:q||0,rateLimitedToday:ee||0};d(te)}catch(o){console.error("Error calculating stats:",o)}},[p]),K=n.useCallback(async o=>{try{if(!I)return null;const{data:a,error:c}=await I.from("ai_insights").select(`
          *
        `).eq("id",o).single();if(c)throw c;let v=[];if(a.prediction_id){const{data:M}=await I.from("prophet_predictions").select("id, timeframe, confidence_score, generated_at").eq("id",a.prediction_id);M&&(v=M)}const R=y.find(M=>M.id===a.user_id);R&&(a.profiles={id:R.id,full_name:R.full_name,email:R.email});const O=[{date:new Date().toISOString().split("T")[0],access_count:a.access_count||0}],B={total_requests:1,average_processing_time:a.generation_time_ms||0,success_rate:a.processing_status==="completed"?100:0};return{...a,relatedPredictions:v,usageHistory:O,serviceMetrics:B}}catch(a){return console.error("Error fetching insight detail:",a),f(`Failed to load insight details: ${a.message}`),null}},[y,f]),Q=n.useCallback(async o=>{try{if(!I)return!1;const{error:a}=await I.from("ai_insights").insert([{...o,generated_at:new Date().toISOString(),expires_at:new Date(Date.now()+30*24*60*60*1e3).toISOString(),access_count:0,daily_usage_count:1,rate_limited:!1,processing_status:"completed"}]);if(a)throw a;return t("AI insight created successfully"),!0}catch(a){return console.error("Error creating insight:",a),f(`Failed to create insight: ${a.message}`),!1}},[t,f]),Z=n.useCallback(async o=>{try{if(!I)return!1;const{error:a}=await I.from("ai_insights").delete().eq("id",o);if(a)throw a;return t("AI insight deleted successfully"),!0}catch(a){return console.error("Error deleting insight:",a),f(`Failed to delete insight: ${a.message}`),!1}},[t,f]),P=n.useCallback(async o=>{try{if(!I)return!1;const{error:a}=await I.from("ai_insights").update({generated_at:new Date().toISOString(),expires_at:new Date(Date.now()+30*24*60*60*1e3).toISOString(),processing_status:"completed"}).eq("id",o);if(a)throw a;return t("AI insight regenerated successfully"),!0}catch(a){return console.error("Error regenerating insight:",a),f(`Failed to regenerate insight: ${a.message}`),!1}},[t,f]),E=n.useCallback(async()=>{try{const o=[{id:"1",service_name:"openrouter",display_name:"OpenRouter",description:"AI insights via OpenRouter API",model_options:["openai/gpt-oss-120b:free","openai/gpt-4o-mini","anthropic/claude-3-haiku"],default_model:"openai/gpt-oss-120b:free",is_enabled:!0,rate_limit_per_hour:60,rate_limit_per_day:1e3,max_tokens:4e3,temperature:.7,confidence_threshold:.8,timeout_seconds:30,fallback_service:"fallback",api_endpoint:"https://openrouter.ai/api/v1/chat/completions",api_key_required:!0,cost_per_token:1e-4,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"2",service_name:"chatbot",display_name:"ChatBot",description:"Internal chatbot service",model_options:["internal-v1"],default_model:"internal-v1",is_enabled:!0,rate_limit_per_hour:120,rate_limit_per_day:2e3,max_tokens:2e3,temperature:.5,confidence_threshold:.7,timeout_seconds:20,api_key_required:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"3",service_name:"prophet",display_name:"Prophet",description:"Prophet model integration",model_options:["prophet-v1"],default_model:"prophet-v1",is_enabled:!0,rate_limit_per_hour:30,rate_limit_per_day:500,max_tokens:1e3,temperature:.3,confidence_threshold:.9,timeout_seconds:60,api_key_required:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"4",service_name:"fallback",display_name:"Fallback",description:"Fallback service for failed requests",model_options:["basic-v1"],default_model:"basic-v1",is_enabled:!0,rate_limit_per_hour:1e3,rate_limit_per_day:1e4,max_tokens:500,temperature:.1,confidence_threshold:.5,timeout_seconds:10,api_key_required:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}];m(o)}catch(o){console.error("Error fetching services:",o),C(o.message)}},[]),U=n.useCallback(async()=>{try{const[o]=await Promise.all([z(),E()]);await D()}catch(o){console.error("Error refreshing data:",o),C(o.message||"Failed to refresh data")}},[z,E,D]);return n.useEffect(()=>{let o=!0,a;return(async()=>{try{N(!0),C(null),a=setTimeout(()=>{o&&(N(!1),C("Loading timeout - please refresh the page"))},3e4),await Promise.all([z(),E()]),await D(),a&&clearTimeout(a)}catch(v){o&&C(v.message||"Failed to load data"),a&&clearTimeout(a)}finally{o&&N(!1)}})(),()=>{o=!1,a&&clearTimeout(a)}},[]),n.useEffect(()=>{},[x]),{insights:r,stats:h,users:y,services:p,totalPages:b,totalItems:w,loading:x,error:A,fetchInsights:F,getInsightDetail:K,createInsight:Q,deleteInsight:Z,regenerateInsight:P,refreshData:U,fetchServices:E}},je=(r={})=>{const[s,h]=n.useState({..._,...r}),d=n.useCallback(t=>{h(f=>({...f,...t,currentPage:t.currentPage!==void 0?t.currentPage:t.pageSize!==void 0?f.currentPage:1}))},[]),y=n.useCallback(()=>{h(_)},[]),j=n.useCallback(t=>{d({search:t,currentPage:1})},[d]),p=n.useCallback(t=>{d({aiService:t,currentPage:1})},[d]),m=n.useCallback(t=>{d({riskLevel:t,currentPage:1})},[d]),b=n.useCallback(t=>{d({confidenceRange:t,currentPage:1})},[d]),u=n.useCallback(t=>{d({dateRange:t,currentPage:1})},[d]),w=n.useCallback(t=>{d({status:t,currentPage:1})},[d]),l=n.useCallback(t=>{d({userId:t,currentPage:1})},[d]),x=n.useCallback(t=>{d({pageSize:t,currentPage:1})},[d]),N=n.useCallback(t=>{d({currentPage:t})},[d]),A=n.useCallback((t,f)=>{d({sortBy:t,sortOrder:f,currentPage:1})},[d]),C=n.useMemo(()=>s.search!==_.search||s.aiService!==_.aiService||s.riskLevel!==_.riskLevel||s.confidenceRange.min!==_.confidenceRange.min||s.confidenceRange.max!==_.confidenceRange.max||s.dateRange.startDate!==_.dateRange.startDate||s.dateRange.endDate!==_.dateRange.endDate||s.status!==_.status||s.userId!==_.userId||s.sortBy!==_.sortBy||s.sortOrder!==_.sortOrder,[s]),k=n.useCallback(()=>{let t=0;return s.search!==_.search&&t++,s.aiService!==_.aiService&&t++,s.riskLevel!==_.riskLevel&&t++,(s.confidenceRange.min!==_.confidenceRange.min||s.confidenceRange.max!==_.confidenceRange.max)&&t++,(s.dateRange.startDate!==_.dateRange.startDate||s.dateRange.endDate!==_.dateRange.endDate)&&t++,s.status!==_.status&&t++,s.userId!==_.userId&&t++,(s.sortBy!==_.sortBy||s.sortOrder!==_.sortOrder)&&t++,t},[s]),i=n.useCallback(()=>{const t=[];if(s.search&&t.push(`Search: "${s.search}"`),s.aiService!=="all"){const f={openrouter:"OpenRouter",chatbot:"ChatBot",prophet:"Prophet",fallback:"Fallback"};t.push(`Service: ${f[s.aiService]}`)}if(s.riskLevel!=="all"){const f={high:"High Risk",medium:"Medium Risk",low:"Low Risk"};t.push(`Risk: ${f[s.riskLevel]}`)}if((s.confidenceRange.min>0||s.confidenceRange.max<100)&&t.push(`Confidence: ${s.confidenceRange.min}% - ${s.confidenceRange.max}%`),s.dateRange.startDate||s.dateRange.endDate){const f=s.dateRange.startDate||"Start",z=s.dateRange.endDate||"End";t.push(`Date: ${f} to ${z}`)}if(s.status!=="all"){const f={active:"Active",expired:"Expired",error:"Error"};t.push(`Status: ${f[s.status]}`)}if(s.userId&&t.push(`User ID: ${s.userId}`),s.sortBy!==_.sortBy||s.sortOrder!==_.sortOrder){const f={generated_at:"Generated Date",confidence_level:"Confidence",access_count:"Access Count",processing_time:"Processing Time",username:"Username",riskLevel:"Risk Level",aiService:"AI Service",status:"Status"},z=s.sortOrder==="asc"?"Ascending":"Descending";t.push(`Sort: ${f[s.sortBy]||s.sortBy} (${z})`)}return t},[s]);return{filters:s,updateFilters:d,resetFilters:y,setSearch:j,setAIService:p,setRiskLevel:m,setConfidenceRange:b,setDateRange:u,setStatus:w,setUserId:l,setPageSize:x,setCurrentPage:N,setSorting:A,hasActiveFilters:C,getActiveFilterCount:k,getFilterSummary:i}},ke=()=>{const[r,s]=n.useState(new Date),[h,d]=n.useState(!1),[y,j]=n.useState(!1),[p,m]=n.useState(!1),[b,u]=n.useState(null),[w,l]=n.useState(null),[x,N]=n.useState(!1),[A,C]=n.useState(!1),[k,i]=n.useState(!1),{showSuccessToast:t,showErrorToast:f}=me(),{insights:z,stats:F,users:D,services:K,totalPages:Q,totalItems:Z,loading:P,fetchInsights:E,getInsightDetail:U,createInsight:o,deleteInsight:a,refreshData:c}=be(),{filters:v,updateFilters:R,resetFilters:O,hasActiveFilters:B,getActiveFilterCount:M}=je(),L=n.useCallback(async g=>{D.length>0&&await E(g,D)},[E,D]);n.useEffect(()=>{!P&&D.length>0&&L(v)},[v,P,D.length,L]);const V=n.useCallback(async()=>{d(!0);try{await c(),await L(v),s(new Date),j(!0),setTimeout(()=>j(!1),3e3)}catch(g){console.error("Error refreshing data:",g)}finally{d(!1)}},[c,v,L]),Y=n.useCallback(async g=>{u(g);try{const T=await U(g.insightId);T&&(l(T),N(!0))}catch{f("Failed to load insight details")}},[U,f]),S=n.useCallback(()=>{u(null),C(!0)},[]),G=n.useCallback(g=>{u(g),i(!0)},[]),J=n.useCallback(async g=>{try{const T={user_id:g.user_id,prediction_id:g.prediction_id,ai_service:g.ai_service,model_used:g.model_used,insights:{summary:`AI-generated financial insight analysis based on Prophet prediction data, user's transaction history, and predictive financial modeling. Generated from prediction ID: ${g.prediction_id}.`,timestamp:new Date().toISOString(),riskAssessment:g.include_risk_assessment?{level:"medium",factors:["Irregular spending patterns","Limited emergency savings"],mitigationSuggestions:["Set up automatic savings","Create a monthly spending budget"]}:void 0,recommendations:g.generate_recommendations?["Based on prediction trends, consider increasing monthly savings by 10%","Review and optimize recurring subscriptions identified in prediction analysis","Establish an emergency fund aligned with predicted future expenses","Take advantage of predicted income increases for investment opportunities"]:[],opportunityAreas:g.analyze_trends?["Investment diversification based on predicted income trends","Tax-efficient savings strategies aligned with forecasted earnings","Automated budgeting tools optimized for predicted spending patterns"]:[]},risk_assessment:g.include_risk_assessment?{level:"medium",factors:["Irregular spending patterns","Limited emergency savings"],mitigationSuggestions:["Set up automatic savings","Create a monthly spending budget"]}:void 0,recommendations:g.generate_recommendations?["Based on prediction trends, consider increasing monthly savings by 10%","Review and optimize recurring subscriptions identified in prediction analysis","Establish an emergency fund aligned with predicted future expenses","Take advantage of predicted income increases for investment opportunities"]:[],opportunity_areas:g.analyze_trends?["Investment diversification based on predicted income trends","Tax-efficient savings strategies aligned with forecasted earnings","Automated budgeting tools optimized for predicted spending patterns"]:[],confidence_level:g.confidence_threshold,model_version:"1.0.0",processing_status:"completed",generation_time_ms:Math.floor(Math.random()*3e3)+1e3,token_usage:{prompt_tokens:Math.floor(Math.random()*500)+200,completion_tokens:Math.floor(Math.random()*800)+300,total_tokens:Math.floor(Math.random()*1200)+600},daily_usage_count:1,rate_limited:!1,generated_at:new Date().toISOString(),expires_at:new Date(Date.now()+2592e6).toISOString(),access_count:0},re=await o(T);return re?t("AI insights generated successfully!"):f("Failed to generate AI insights"),re}catch(T){return console.error("Error generating insight:",T),f("Failed to generate AI insights"),!1}},[o,t,f]),q=n.useCallback(async()=>{C(!1),await L(v)},[v,L]),ee=n.useCallback(async()=>{i(!1),u(null),await L(v)},[v,L]),ae=n.useCallback(g=>{R(g)},[R]),se=n.useCallback(g=>{R({currentPage:g})},[R]),te=n.useCallback((g,T)=>{R({sortBy:g,sortOrder:T})},[R]);return P?e.jsxs("div",{className:"modern-user-management",children:[e.jsx("div",{className:"block md:hidden py-12 animate__animated animate__fadeIn",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"mt-3 text-xs text-gray-500 font-medium",children:"Loading AI insights..."})]})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"user-management-header mb-5",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start flex-wrap",children:[e.jsx("div",{className:"header-content",children:e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"header-icon-container mr-3",children:e.jsx("div",{className:"skeleton-icon"})}),e.jsxs("div",{children:[e.jsx("div",{className:"skeleton-line skeleton-header-title mb-1"}),e.jsx("div",{className:"skeleton-line skeleton-header-subtitle"})]})]})}),e.jsxs("div",{className:"header-actions d-flex align-items-center",children:[e.jsx("div",{className:"last-updated-info mr-3",children:e.jsx("div",{className:"skeleton-line skeleton-date"})}),e.jsx("div",{className:"skeleton-button mr-2"}),e.jsx("div",{className:"skeleton-button mr-2"}),e.jsx("div",{className:"skeleton-button mr-2"}),e.jsx("div",{className:"skeleton-button"})]})]})}),e.jsx("div",{className:"stats-section mb-5",children:e.jsx(ne,{stats:{totalInsights:0,activeServices:0,averageConfidence:0,totalUsers:0,riskDistribution:{high:0,medium:0,low:0,unknown:0},serviceUsage:{openrouter:0,chatbot:0,prophet:0,fallback:0},processingMetrics:{averageTime:0,totalTokens:0,successRate:0},usageToday:0,rateLimitedToday:0},loading:!0})}),e.jsx(oe,{stats:F,insights:[],loading:!0}),e.jsx(ce,{filters:v,users:[],onFiltersChange:()=>{},onResetFilters:()=>{},hasActiveFilters:!1,activeFilterCount:0,loading:!0}),e.jsx(de,{insights:[],filters:v,totalPages:1,totalItems:0,loading:!0,onSort:()=>{},onPageChange:()=>{},onView:()=>{},onDelete:()=>{}})]})]}):e.jsxs("div",{className:"modern-user-management",children:[e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-bold text-gray-800",children:"AI Insights"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:V,className:"w-9 h-9 rounded-full bg-red-500 hover:bg-red-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95 disabled:opacity-50",disabled:h,"aria-label":"Refresh data",children:e.jsx("i",{className:`fas fa-sync text-xs ${h?"fa-spin":""}`})}),e.jsx("button",{onClick:S,className:"w-9 h-9 rounded-full bg-rose-600 hover:bg-rose-700 text-white flex items-center justify-center shadow-md transition-all active:scale-95","aria-label":"Generate insights",children:e.jsx("i",{className:"fas fa-magic text-xs"})})]})]})}),e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 via-teal-500 to-cyan-500 rounded-2xl p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-white/80 text-xs font-medium",children:"AI Services Status"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-check-circle text-white text-sm"})})]}),e.jsx("div",{className:"text-white text-lg font-bold mb-1",children:"All AI Services Operational"}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{className:"text-white/70 text-xs",children:[e.jsx("i",{className:"fas fa-clock text-[10px] mr-1"}),"Updated: ",r.toLocaleTimeString()]})}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-white/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-white/60 text-[9px] uppercase",children:"Insights"}),e.jsx("p",{className:"text-white text-sm font-bold",children:F.totalInsights})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-white/60 text-[9px] uppercase",children:"Users"}),e.jsx("p",{className:"text-white text-sm font-bold",children:F.totalUsers})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-white/60 text-[9px] uppercase",children:"Accuracy"}),e.jsxs("p",{className:"text-white text-sm font-bold",children:[F.averageConfidence.toFixed(0),"%"]})]})]})]})}),e.jsxs("div",{className:"user-management-header mb-5 hidden md:block",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start flex-wrap",children:[e.jsx("div",{className:"header-content",children:e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"header-icon-container mr-3",children:e.jsx("i",{className:"fas fa-brain"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"header-title mb-1",children:"AI Insights Management"}),e.jsx("p",{className:"header-subtitle mb-0",children:"Monitor and manage AI-powered financial insights and analytics across all users"})]})]})}),e.jsxs("div",{className:"header-actions d-flex align-items-center",children:[e.jsx("div",{className:"last-updated-info mr-3",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"far fa-clock mr-1"}),"Last updated: ",r.toLocaleTimeString()]})}),e.jsxs("button",{className:"btn btn-outline-secondary btn-sm shadow-sm mr-2",onClick:()=>m(!p),children:[e.jsx("i",{className:"fas fa-sync-alt mr-1"}),"Update Model"]}),e.jsxs("button",{className:"btn btn-outline-danger btn-sm shadow-sm refresh-btn mr-2",onClick:V,disabled:h,children:[e.jsx("i",{className:`fas fa-sync-alt mr-1 ${h?"fa-spin":""}`}),h?"Refreshing...":"Refresh All"]}),e.jsxs("button",{className:"btn btn-danger btn-sm shadow-sm",onClick:S,children:[e.jsx("i",{className:"fas fa-magic mr-1"}),"Generate Insights"]})]})]}),e.jsx("div",{className:"dashboard-status-bar mt-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"status-indicator status-online mr-2"}),e.jsx("span",{className:"small text-success font-weight-medium",children:"AI insight services operational - Models running normally"}),e.jsx("div",{className:"ml-auto",children:e.jsxs("span",{className:"badge badge-success badge-pill",children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),"Live Data"]})})]})})]}),y&&e.jsxs(le,{variant:"success",onClose:()=>j(!1),dismissible:!0,children:[e.jsx(le.Heading,{children:"Model Updated Successfully!"}),e.jsx("p",{children:"The AI insight model has been updated with the latest data. All user insights will reflect the updated model on their next analysis."})]}),e.jsx("div",{className:"stats-section mb-5",children:e.jsx(ne,{stats:F,loading:P})}),e.jsx(oe,{stats:F,insights:z,loading:P}),e.jsx(ce,{filters:v,users:D,onFiltersChange:ae,onResetFilters:O,hasActiveFilters:B,activeFilterCount:M(),loading:P}),e.jsx(de,{insights:z,filters:v,totalPages:Q,totalItems:Z,loading:P,onSort:te,onPageChange:se,onView:Y,onDelete:G}),x&&w&&e.jsx(ge,{show:x,insight:w,onClose:()=>N(!1)}),A&&e.jsx(fe,{show:A,users:D,services:K,onClose:()=>C(!1),onInsightGenerated:q,onGenerate:J}),k&&b&&e.jsx(pe,{show:k,insight:b,onClose:()=>i(!1),onInsightDeleted:ee,onDelete:a})]})};export{ke as default};
