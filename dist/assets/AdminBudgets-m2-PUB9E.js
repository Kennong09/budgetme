import{j as e}from"./ui-vendor-Cn1Vfl4w.js";import{r as u}from"./react-vendor-D4A9EtXC.js";import{t as I,b as ne,p as L}from"./index-BbApZ7g3.js";import{d as X,H as K}from"./chart-vendor-B0c7K_uV.js";const ue=({show:a,onClose:r,title:m,icon:w,color:N,data:x})=>a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:r}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:r,children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:l=>l.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"modal-header bg-gradient-danger text-white border-0",children:[e.jsxs("h5",{className:"modal-title d-flex align-items-center",children:[e.jsx("div",{className:"modal-icon-container mr-3",style:{width:"45px",height:"45px",borderRadius:"12px",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("i",{className:`fas ${w}`,style:{fontSize:"1.25rem"}})}),e.jsxs("div",{children:[e.jsx("div",{className:"modal-title-main font-weight-bold",children:m}),e.jsx("div",{className:"modal-subtitle",style:{opacity:.85,fontSize:"0.85rem"},children:"Detailed breakdown"})]})]}),e.jsx("button",{type:"button",className:"close text-white",onClick:r,style:{textShadow:"none",opacity:.9},children:e.jsx("span",{children:"×"})})]}),e.jsx("div",{className:"modal-body bg-white p-0",children:e.jsx("div",{className:"stats-breakdown-list",children:x.map((l,n)=>e.jsxs("div",{className:"stats-breakdown-item d-flex justify-content-between align-items-center py-3 px-4",style:{borderBottom:n<x.length-1?"1px solid #f0f0f0":"none",transition:"background-color 0.2s ease"},children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-weight-medium text-gray-800",children:l.label}),l.subLabel&&e.jsx("small",{className:"text-muted",children:l.subLabel})]}),e.jsx("span",{className:`badge badge-${N} badge-pill px-3 py-2`,style:{fontSize:"0.9rem",fontWeight:600,minWidth:"60px",textAlign:"center"},children:l.value})]},n))})}),e.jsx("div",{className:"modal-footer bg-light border-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center w-100",children:[e.jsx("div",{className:"modal-footer-info",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-info-circle mr-1 text-danger"}),"Data reflects current statistics"]})}),e.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:r,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Close"]})]})})]})})})]}):null,te=({stats:a,loading:r=!1})=>{const[m,w]=u.useState({show:!1,title:"",icon:"",color:"",data:[]}),N=a.totalBudgets>0?(a.activeBudgets/a.totalBudgets*100).toFixed(1):"0",x=a.totalBudgets-a.activeBudgets,l=a.totalBudgets>0?(x/a.totalBudgets*100).toFixed(1):"0",n=Object.keys(a.budgetsByCategory||{}).length,d=a.budgetsByStatus||{},i=d.completed||0,h=d.archived||0,k=()=>{w({show:!0,title:"Total Budgets Breakdown",icon:"fa-calculator",color:"danger",data:[{label:"Total Budgets",value:a.totalBudgets},{label:"Active Budgets",value:a.activeBudgets,subLabel:`${N}% of total`},{label:"Inactive Budgets",value:x,subLabel:`${l}% of total`},{label:"Completed Budgets",value:i},{label:"Archived Budgets",value:h}]})},B=()=>{w({show:!0,title:"Active Budgets Breakdown",icon:"fa-check-circle",color:"success",data:[{label:"Active Budgets",value:a.activeBudgets},{label:"Percentage of Total",value:`${N}%`},{label:"Inactive Budgets",value:x},{label:"Completed Budgets",value:i},{label:"Active Rate",value:`${N}%`,subLabel:"Currently tracking"}]})},p=()=>{const o=Object.entries(a.budgetsByCategory||{}).sort((g,y)=>y[1]-g[1]).slice(0,5),S=[{label:"Total Categories",value:a.budgetCategories||n},{label:"Budgets per Category",value:a.totalBudgets>0&&n>0?(a.totalBudgets/n).toFixed(1):"0",subLabel:"Average"}];o.forEach(([g,y])=>{S.push({label:g||"Uncategorized",value:y,subLabel:`${a.totalBudgets>0?(y/a.totalBudgets*100).toFixed(1):0}% of budgets`})}),w({show:!0,title:"Budget Categories Breakdown",icon:"fa-tags",color:"warning",data:S})},b=()=>{const o=Object.keys(a.budgetsByUser||{}).length,S=o>0?(a.totalBudgets/o).toFixed(1):"0";w({show:!0,title:"Users with Budgets Breakdown",icon:"fa-users",color:"info",data:[{label:"Users with Budgets",value:a.usersWithBudgets},{label:"Total Budgets",value:a.totalBudgets},{label:"Budgets per User",value:S,subLabel:"Average"},{label:"Active Budgets",value:a.activeBudgets},{label:"Active per User",value:a.usersWithBudgets>0?(a.activeBudgets/a.usersWithBudgets).toFixed(1):"0",subLabel:"Average active"}]})};return r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden mb-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Array.from({length:4}).map((o,S)=>e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100 animate-pulse",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-gray-200 mb-2"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-16 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20"})]},S))})}),e.jsx("div",{className:"row d-none d-md-flex",children:Array.from({length:4}).map((o,S)=>e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsx("div",{className:"admin-stat-card admin-card-loading",children:e.jsxs("div",{className:"card-content",children:[e.jsx("div",{className:"skeleton-line skeleton-stat-value mb-2"}),e.jsx("div",{className:"skeleton-line skeleton-stat-title"})]})})},S))})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:k,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-red-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-calculator text-red-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Total Budgets"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:I(a.totalBudgets)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-gray-400",children:[e.jsx("i",{className:"fas fa-chart-pie text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium",children:[a.activeBudgets," active, ",x," inactive"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:B,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-emerald-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-check-circle text-emerald-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Active Budgets"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:I(a.activeBudgets)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-emerald-500",children:[e.jsx("i",{className:"fas fa-arrow-up text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium",children:[N,"% of total"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:p,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-amber-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-tags text-amber-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Budget Categories"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:I(a.budgetCategories||n)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-amber-500",children:[e.jsx("i",{className:"fas fa-layer-group text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium",children:[n>0?(a.totalBudgets/n).toFixed(1):0," per category"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-3 shadow-sm border border-gray-100",onClick:b,children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-blue-100 flex items-center justify-center mb-2",children:e.jsx("i",{className:"fas fa-users text-blue-500 text-xs"})}),e.jsx("p",{className:"text-[9px] text-gray-500 font-medium uppercase tracking-wide",children:"Users with Budgets"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:I(a.usersWithBudgets)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-blue-500",children:[e.jsx("i",{className:"fas fa-user-check text-[8px]"}),e.jsxs("span",{className:"text-[9px] font-medium",children:[a.usersWithBudgets>0?(a.totalBudgets/a.usersWithBudgets).toFixed(1):0," budgets/user"]})]})]})]})}),e.jsxs("div",{className:"row d-none d-md-flex",children:[e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-danger h-100 position-relative",onClick:k,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-danger text-uppercase mb-2",children:"Total Budgets"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:I(a.totalBudgets)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-muted",children:[e.jsx("i",{className:"fas fa-chart-pie mr-1"}),e.jsxs("span",{className:"font-weight-medium",children:[a.activeBudgets," active, ",x," inactive"]})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-danger",children:e.jsx("i",{className:"fas fa-calculator stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-danger",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-success h-100 position-relative",onClick:B,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-success text-uppercase mb-2",children:"Active Budgets"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:I(a.activeBudgets)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-success",children:[e.jsx("i",{className:"fas fa-arrow-up mr-1"}),e.jsxs("span",{className:"font-weight-medium",children:[N,"%"]}),e.jsx("span",{className:"ml-1 small",children:"of total"})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-success",children:e.jsx("i",{className:"fas fa-check-circle stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-success",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-warning h-100 position-relative",onClick:p,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-warning text-uppercase mb-2",children:"Budget Categories"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:I(a.budgetCategories||n)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-warning",children:[e.jsx("i",{className:"fas fa-layer-group mr-1"}),e.jsx("span",{className:"font-weight-medium",children:n>0?(a.totalBudgets/n).toFixed(1):0}),e.jsx("span",{className:"ml-1 small",children:"per category"})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-warning",children:e.jsx("i",{className:"fas fa-tags stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-warning",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})}),e.jsx("div",{className:"col-xl-3 col-md-6 col-sm-12 mb-4",children:e.jsxs("div",{className:"admin-stat-card admin-stat-card-info h-100 position-relative",onClick:b,style:{cursor:"pointer"},children:[e.jsx("div",{className:"card-bg-pattern"}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"row no-gutters align-items-center",children:[e.jsxs("div",{className:"col mr-2",children:[e.jsx("div",{className:"stat-title text-info text-uppercase mb-2",children:"Users with Budgets"}),e.jsx("div",{className:"stat-value mb-0 font-weight-bold text-gray-800",children:I(a.usersWithBudgets)}),e.jsxs("div",{className:"stat-change mt-2 d-flex align-items-center text-info",children:[e.jsx("i",{className:"fas fa-user-check mr-1"}),e.jsx("span",{className:"font-weight-medium",children:a.usersWithBudgets>0?(a.totalBudgets/a.usersWithBudgets).toFixed(1):0}),e.jsx("span",{className:"ml-1 small",children:"budgets/user"})]})]}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"stat-icon-container stat-icon-info",children:e.jsx("i",{className:"fas fa-users stat-icon"})})})]})}),e.jsx("div",{className:"card-footer-link bg-info",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center py-2 px-4",children:[e.jsx("span",{className:"font-weight-medium",children:"View Details"}),e.jsx("div",{className:"footer-arrow",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})}),e.jsx("div",{className:"card-hover-overlay"})]})})]}),e.jsx(ue,{show:m.show,onClose:()=>w(o=>({...o,show:!1})),title:m.title,icon:m.icon,color:m.color,data:m.data})]})},le=({stats:a,loading:r=!1})=>{const[m,w]=u.useState("status"),N=typeof window<"u"&&window.innerWidth<768,x=()=>{const n=Object.entries(a.budgetsByCategory).map(([d,i])=>({name:d,y:i})).filter(d=>d.y>0);return{chart:{type:"pie",height:N?220:300},credits:{enabled:!1},title:{text:"Budgets by Category"},tooltip:{pointFormat:"{series.name}: <b>{point.y}</b> ({point.percentage:.1f}%)"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %",style:{color:"black"}}}},series:[{name:"Budgets",colorByPoint:!0,data:n}]}},l=()=>{const n=a.budgetsByStatus.completed||0,d=a.budgetsByStatus.active||0,i=a.budgetsByStatus.archived||0;return{chart:{type:"column",height:N?220:300},credits:{enabled:!1},title:{text:"Budget Status Distribution"},xAxis:{categories:["Active","Completed","Archived"]},yAxis:{title:{text:"Number of Budgets"}},series:[{name:"Budgets",data:[{y:d,color:"#36b9cc"},{y:n,color:"#1cc88a"},{y:i,color:"#858796"}]}]}};return r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-block d-md-none",children:e.jsxs("div",{className:"bg-white rounded shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"d-flex",style:{backgroundColor:"#f8f9fa"},children:[e.jsx("div",{className:"flex-fill py-3 text-center",children:e.jsx("div",{className:"bg-secondary rounded mx-auto",style:{height:"12px",width:"64px",opacity:.3}})}),e.jsx("div",{className:"flex-fill py-3 text-center",children:e.jsx("div",{className:"bg-secondary rounded mx-auto",style:{height:"12px",width:"80px",opacity:.3}})})]}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"bg-light rounded d-flex align-items-center justify-content-center",style:{height:"220px"},children:e.jsx("i",{className:"fas fa-chart-bar text-secondary fa-2x",style:{opacity:.3}})})})]})}),e.jsx("div",{className:"hidden md:block skeleton-budget-analytics",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-6 mb-4",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header py-3 admin-card-header",children:e.jsx("div",{className:"skeleton-budget-analytics-header",children:e.jsx("div",{className:"skeleton-line skeleton-budget-analytics-title"})})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"skeleton-budget-chart"})})]})}),e.jsx("div",{className:"col-lg-6 mb-4",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header py-3 admin-card-header",children:e.jsx("div",{className:"skeleton-budget-analytics-header",children:e.jsx("div",{className:"skeleton-line skeleton-budget-analytics-title"})})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"skeleton-budget-chart"})})]})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-block d-md-none mb-4",children:e.jsxs("div",{className:"bg-white rounded shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"d-flex",style:{backgroundColor:"#f8f9fa"},children:[e.jsxs("button",{onClick:()=>w("status"),className:`flex-fill py-3 border-0 font-weight-semibold position-relative ${m==="status"?"text-danger bg-white":"text-secondary bg-transparent"}`,style:{fontSize:"14px"},children:[e.jsx("i",{className:"fas fa-chart-bar mr-2",style:{fontSize:"12px"}}),"Status",m==="status"&&e.jsx("div",{className:"position-absolute bg-danger",style:{bottom:0,left:0,right:0,height:"2px"}})]}),e.jsxs("button",{onClick:()=>w("categories"),className:`flex-fill py-3 border-0 font-weight-semibold position-relative ${m==="categories"?"text-danger bg-white":"text-secondary bg-transparent"}`,style:{fontSize:"14px"},children:[e.jsx("i",{className:"fas fa-chart-pie mr-2",style:{fontSize:"12px"}}),"Categories",m==="categories"&&e.jsx("div",{className:"position-absolute bg-danger",style:{bottom:0,left:0,right:0,height:"2px"}})]})]}),e.jsx("div",{className:"p-3",children:m==="status"?e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-center mb-3 flex-wrap",style:{gap:"12px"},children:[e.jsxs("span",{className:"d-flex align-items-center text-secondary",style:{fontSize:"11px"},children:[e.jsx("span",{className:"rounded-circle mr-1",style:{width:"10px",height:"10px",backgroundColor:"#36b9cc"}}),"Active"]}),e.jsxs("span",{className:"d-flex align-items-center text-secondary",style:{fontSize:"11px"},children:[e.jsx("span",{className:"rounded-circle mr-1",style:{width:"10px",height:"10px",backgroundColor:"#1cc88a"}}),"Completed"]}),e.jsxs("span",{className:"d-flex align-items-center text-secondary",style:{fontSize:"11px"},children:[e.jsx("span",{className:"rounded-circle mr-1",style:{width:"10px",height:"10px",backgroundColor:"#858796"}}),"Archived"]})]}),e.jsx(X,{highcharts:K,options:l()})]}):e.jsxs("div",{children:[e.jsx("div",{className:"d-flex justify-content-center mb-3",children:e.jsxs("span",{className:"d-flex align-items-center text-secondary",style:{fontSize:"11px"},children:[e.jsx("span",{className:"rounded-circle bg-danger mr-1",style:{width:"10px",height:"10px"}}),"Budget Categories"]})}),e.jsx(X,{highcharts:K,options:x()})]})})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-6 mb-4",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header py-3 admin-card-header",children:e.jsx("h6",{className:"m-0 font-weight-bold text-danger",children:"Budget Categories"})}),e.jsx("div",{className:"card-body",children:e.jsx(X,{highcharts:K,options:x()})})]})}),e.jsx("div",{className:"col-lg-6 mb-4",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header py-3 admin-card-header",children:e.jsx("h6",{className:"m-0 font-weight-bold text-danger",children:"Budget Status"})}),e.jsx("div",{className:"card-body",children:e.jsx(X,{highcharts:K,options:l()})})]})})]})})]})},re=({filters:a,categories:r,onFiltersChange:m,onRefresh:w,loading:N=!1})=>{const x=()=>{m({currentPage:1})},l=()=>{m({searchTerm:"",filterCategory:"all",filterStatus:"all",currentPage:1})},n=i=>{const h=parseInt(i.target.value,10);m({pageSize:h,currentPage:1})},d=a.searchTerm||a.filterCategory!=="all"||a.filterStatus!=="all";return N?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-3 animate-pulse",children:[e.jsx("div",{className:"h-9 bg-gray-200 rounded-lg mb-2"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 h-8 bg-gray-200 rounded-lg"}),e.jsx("div",{className:"flex-1 h-8 bg-gray-200 rounded-lg"})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-4 mb-3",children:e.jsx("div",{className:"skeleton-line skeleton-budget-search"})}),e.jsx("div",{className:"col-md-2 mb-3",children:e.jsx("div",{className:"skeleton-line skeleton-budget-filter"})}),e.jsx("div",{className:"col-md-2 mb-3",children:e.jsx("div",{className:"skeleton-line skeleton-budget-filter"})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx("div",{className:"skeleton-line skeleton-budget-controls"})}),e.jsx("div",{className:"col-md-1 mb-3",children:e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx("div",{className:"skeleton-budget-action-btn mr-2"}),e.jsx("div",{className:"skeleton-budget-action-btn"})]})})]})})})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2.5 border-b border-gray-100 flex items-center justify-between bg-gray-50",children:[e.jsx("span",{className:"text-[10px] text-gray-500 font-medium uppercase tracking-wide",children:"Filter Budgets"}),d&&e.jsxs("button",{className:"text-[10px] text-red-500 flex items-center gap-1 font-medium",onClick:l,children:[e.jsx("i",{className:"fas fa-times text-[8px]"}),"Clear"]})]}),e.jsx("div",{className:"px-3 py-2 border-b border-gray-100",children:e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-[10px]"}),e.jsx("input",{type:"text",className:"w-full pl-8 pr-3 py-2 text-xs bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",placeholder:"Search budgets...",value:a.searchTerm,onChange:i=>m({searchTerm:i.target.value})})]})}),e.jsxs("div",{className:"px-3 py-2 flex gap-2",children:[e.jsxs("select",{className:"flex-1 px-2 py-1.5 text-[10px] bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",value:a.filterCategory,onChange:i=>{m({filterCategory:i.target.value}),x()},children:[e.jsx("option",{value:"all",children:"All Categories"}),r.map(i=>e.jsx("option",{value:i.id,children:i.category_name},i.id))]}),e.jsxs("select",{className:"flex-1 px-2 py-1.5 text-[10px] bg-gray-50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-200 focus:border-red-400 outline-none",value:a.filterStatus,onChange:i=>{m({filterStatus:i.target.value}),x()},children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"archived",children:"Archived"})]})]})]})}),e.jsx("div",{className:"hidden md:block",children:e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-4 mb-3",children:e.jsx("div",{className:"search-container",children:e.jsxs("div",{className:"input-group",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("span",{className:"input-group-text",children:e.jsx("i",{className:"fas fa-search"})})}),e.jsx("input",{type:"text",className:"form-control modern-input",placeholder:"Search budgets, users, or categories...",value:a.searchTerm,onChange:i=>m({searchTerm:i.target.value})})]})})}),e.jsx("div",{className:"col-md-2 mb-3",children:e.jsxs("select",{className:"form-control modern-select",value:a.filterCategory,onChange:i=>{m({filterCategory:i.target.value}),x()},children:[e.jsx("option",{value:"all",children:"All Categories"}),r.map(i=>e.jsx("option",{value:i.id,children:i.category_name},i.id))]})}),e.jsx("div",{className:"col-md-2 mb-3",children:e.jsxs("select",{className:"form-control modern-select",value:a.filterStatus,onChange:i=>{m({filterStatus:i.target.value}),x()},children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"archived",children:"Archived"})]})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsxs("div",{className:"page-size-selector",children:[e.jsx("small",{className:"text-muted mr-2",children:"Show:"}),e.jsxs("select",{className:"form-control form-control-sm d-inline-block w-auto",value:a.pageSize,onChange:n,children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),e.jsx("small",{className:"text-muted ml-2",children:"per page"})]})})}),e.jsx("div",{className:"col-md-1 mb-3",children:e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx("button",{className:"btn btn-outline-secondary btn-sm mr-2",onClick:l,title:"Clear Filters",children:e.jsx("i",{className:"fas fa-times"})}),e.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:w,disabled:N,title:"Refresh Data",children:e.jsx("i",{className:`fas ${N?"fa-spinner fa-spin":"fa-sync-alt"}`})})]})})]})})})})]})},ie=({budgets:a,filters:r,totalPages:m,totalItems:w,loading:N=!1,onSort:x,onPageChange:l,onBudgetSelect:n,onBudgetEdit:d,onBudgetDelete:i})=>{const{currentPage:h,pageSize:k,sortField:B,sortDirection:p}=r,[b,o]=u.useState(null),S=s=>{o(b===s?null:s)},g=()=>{o(null)};u.useEffect(()=>{const s=c=>{b&&!c.target.closest(".dropdown-menu")&&g()};if(b)return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[b]);const y=s=>{x(s)},D=(s,c)=>B===c?e.jsx("i",{className:`ml-1 fas fa-sort-${p==="asc"?"up":"down"}`}):null,_=s=>s>=90?"bg-danger":s>=70?"bg-warning":s>=50?"bg-info":"bg-success",F=s=>s>=90?"bg-red-500":s>=70?"bg-amber-500":s>=50?"bg-blue-500":"bg-emerald-500",z=s=>{switch(s){case"active":return"bg-emerald-100 text-emerald-700";case"completed":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"block md:hidden",children:[N?e.jsx("div",{className:"space-y-2",children:Array.from({length:3}).map((s,c)=>e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-3 animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-1/2"})]}),e.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded"})]})},c))}):a.length===0?e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center mx-auto mb-3",children:e.jsx("i",{className:"fas fa-calculator text-red-500"})}),e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"No Budgets Found"}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Try adjusting your filters"})]}):e.jsx("div",{className:"space-y-2",children:a.map(s=>{const c=Math.round(s.spent/s.amount*100),j=F(c),t=z(s.status);return e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"px-3 py-2.5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("img",{src:s.user_avatar||"../images/placeholder.png",alt:s.user_name||"User",className:"w-10 h-10 rounded-full object-cover border-2 border-white shadow-sm",onError:f=>{f.currentTarget.src="../images/placeholder.png"}}),e.jsx("div",{className:`absolute -bottom-0.5 -right-0.5 w-3 h-3 rounded-full border-2 border-white ${s.status==="active"?"bg-emerald-500":"bg-gray-400"}`})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-800 truncate",children:s.name}),e.jsx("span",{className:`px-1.5 py-0.5 text-[8px] font-medium rounded-full ${t}`,children:s.status})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-gray-500",children:[e.jsx("i",{className:"fas fa-user text-[8px]"}),e.jsx("span",{className:"truncate",children:s.user_name}),e.jsx("span",{className:"text-gray-300",children:"•"}),e.jsx("i",{className:"fas fa-tag text-[8px]"}),e.jsx("span",{className:"truncate",children:s.category})]})]}),e.jsxs("div",{className:"text-right flex items-center gap-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-bold text-gray-800",children:["₱",s.amount.toLocaleString()]}),e.jsxs("div",{className:"text-[9px] text-gray-500",children:[c,"% used"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"w-7 h-7 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 transition-colors",onClick:f=>{f.stopPropagation(),S(s.id)},onTouchEnd:f=>{f.stopPropagation(),S(s.id)},"aria-label":"More actions",children:e.jsx("i",{className:"fas fa-ellipsis-v text-[10px]"})}),b===s.id&&e.jsxs("div",{className:"dropdown-menu fixed w-28 bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",style:{display:"block",zIndex:99999,transform:"translateX(-84px) translateY(4px)"},children:[e.jsxs("button",{className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50 active:bg-gray-100 flex items-center gap-2 transition-colors",onClick:f=>{f.stopPropagation(),g(),n(s)},onTouchEnd:f=>{f.stopPropagation(),g(),n(s)},children:[e.jsx("i",{className:"fas fa-eye text-gray-500 text-[10px]"}),e.jsx("span",{className:"text-gray-700",children:"View"})]}),d&&e.jsxs("button",{className:"w-full px-3 py-2 text-left text-xs hover:bg-gray-50 active:bg-gray-100 flex items-center gap-2 transition-colors",onClick:f=>{f.stopPropagation(),g(),d(s)},onTouchEnd:f=>{f.stopPropagation(),g(),d(s)},children:[e.jsx("i",{className:"fas fa-edit text-gray-500 text-[10px]"}),e.jsx("span",{className:"text-gray-700",children:"Edit"})]}),i&&e.jsxs("button",{className:"w-full px-3 py-2 text-left text-xs hover:bg-red-50 active:bg-red-100 flex items-center gap-2 transition-colors",onClick:f=>{f.stopPropagation(),g(),i(s)},onTouchEnd:f=>{f.stopPropagation(),g(),i(s)},children:[e.jsx("i",{className:"fas fa-trash text-red-500 text-[10px]"}),e.jsx("span",{className:"text-red-600",children:"Delete"})]})]})]})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"h-1.5 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${j} rounded-full transition-all`,style:{width:`${Math.min(c,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsxs("span",{className:"text-[9px] text-gray-500",children:["Spent: ₱",s.spent.toLocaleString()]}),e.jsxs("span",{className:"text-[9px] text-gray-500",children:["Left: ₱",(s.amount-s.spent).toLocaleString()]})]})]})]})},s.id)})}),m>1&&!N&&e.jsxs("div",{className:"mt-3 flex items-center justify-between px-1",children:[e.jsxs("button",{onClick:()=>l(h-1),disabled:h===1,className:"px-3 py-1.5 text-[10px] font-medium text-gray-600 bg-white border border-gray-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("i",{className:"fas fa-chevron-left mr-1"}),"Prev"]}),e.jsxs("span",{className:"text-[10px] text-gray-500",children:["Page ",h," of ",m]}),e.jsxs("button",{onClick:()=>l(h+1),disabled:h===m,className:"px-3 py-1.5 text-[10px] font-medium text-gray-600 bg-white border border-gray-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:["Next",e.jsx("i",{className:"fas fa-chevron-right ml-1"})]})]})]}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"card shadow",children:[e.jsx("div",{className:"card-header bg-white border-0 py-3",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h6",{className:"m-0 font-weight-bold text-danger",children:[e.jsx("i",{className:"fas fa-table mr-2"}),"Budgets (",w,")"]}),e.jsx("div",{className:"table-actions",children:e.jsxs("small",{className:"text-muted",children:["Showing ",Math.min((h-1)*k+1,w)," to ",Math.min(h*k,w)," of ",w," entries"]})})]})}),N?e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table modern-table mb-0",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("div",{className:"skeleton-line skeleton-table-header"})}),e.jsx("th",{children:e.jsx("div",{className:"skeleton-line skeleton-table-header"})}),e.jsx("th",{children:e.jsx("div",{className:"skeleton-line skeleton-table-header"})}),e.jsx("th",{children:e.jsx("div",{className:"skeleton-line skeleton-table-header"})}),e.jsx("th",{className:"text-center",children:e.jsx("div",{className:"skeleton-line skeleton-table-header"})})]})}),e.jsx("tbody",{children:Array.from({length:5}).map((s,c)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"skeleton-avatar mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"skeleton-line skeleton-budget-name mb-1"}),e.jsx("div",{className:"skeleton-line skeleton-budget-email"})]})]})}),e.jsx("td",{className:"py-3",children:e.jsx("div",{className:"skeleton-line skeleton-budget-category"})}),e.jsx("td",{className:"py-3",children:e.jsx("div",{className:"skeleton-line skeleton-budget-amount"})}),e.jsx("td",{className:"py-3",children:e.jsx("div",{className:"skeleton-budget-status"})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex justify-content-center gap-1",children:[e.jsx("div",{className:"skeleton-budget-action-btn"}),e.jsx("div",{className:"skeleton-budget-action-btn"}),e.jsx("div",{className:"skeleton-budget-action-btn"})]})})]},c))})]})})}):a.length===0?e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"no-users-container text-center",children:e.jsxs("div",{className:"mb-4",children:[e.jsx("i",{className:"fas fa-calculator fa-4x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No Budgets Found"}),e.jsx("p",{className:"text-muted mb-4",children:"No budgets match your current search criteria. Try adjusting your filters or create a new budget."})]})})}):e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table modern-table mb-0",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsxs("th",{onClick:()=>y("name"),style:{cursor:"pointer"},children:["Budget & User",D("name","category_id")]}),e.jsxs("th",{onClick:()=>y("category"),style:{cursor:"pointer"},children:["Category",D("category","category_id")]}),e.jsxs("th",{onClick:()=>y("amount"),style:{cursor:"pointer"},children:["Amount & Progress",D("amount","amount")]}),e.jsxs("th",{onClick:()=>y("status"),style:{cursor:"pointer"},children:["Status",D("status","end_date")]}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:a.map(s=>{const c=Math.round(s.spent/s.amount*100),j=_(c);return e.jsxs("tr",{className:"table-row",children:[e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{className:"user-avatar-container mr-3",children:[e.jsx("img",{src:s.user_avatar||"../images/placeholder.png",alt:s.user_name||"User",className:"user-table-avatar",onError:t=>{t.currentTarget.src="../images/placeholder.png"}}),e.jsx("div",{className:`user-status-dot status-${s.status==="active"?"active":"inactive"}`})]}),e.jsxs("div",{className:"user-info",children:[e.jsx("div",{className:"user-name font-weight-medium",children:s.name}),e.jsxs("div",{className:"user-id text-muted small",children:["User: ",s.user_name," • ",s.user_email]})]})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"fas fa-tag text-muted mr-2"}),e.jsx("span",{className:"font-weight-medium",children:s.category})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"budget-amount-info",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsxs("span",{className:"font-weight-bold",children:["$",s.amount.toLocaleString()]}),e.jsxs("span",{className:"text-muted small",children:[c,"%"]})]}),e.jsx("div",{className:"progress mb-1",style:{height:"6px"},children:e.jsx("div",{className:`progress-bar ${j}`,role:"progressbar",style:{width:`${Math.min(c,100)}%`},"aria-valuenow":c,"aria-valuemin":0,"aria-valuemax":100})}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("small",{className:"text-muted",children:["Spent: $",s.spent.toLocaleString()]}),e.jsxs("small",{className:"text-muted",children:["Remaining: $",(s.amount-s.spent).toLocaleString()]})]})]})}),e.jsx("td",{className:"py-3",children:e.jsxs("span",{className:`status-badge ${s.status==="active"?"status-success":s.status==="completed"?"status-primary":"status-danger"}`,children:[e.jsx("i",{className:`fas ${s.status==="active"?"fa-check-circle":s.status==="completed"?"fa-flag-checkered":"fa-archive"} mr-1`}),s.status.charAt(0).toUpperCase()+s.status.slice(1)]})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn btn-outline-info btn-sm",onClick:()=>n(s),title:"View Details",children:e.jsx("i",{className:"fas fa-eye"})}),e.jsx("button",{className:"btn btn-outline-warning btn-sm",onClick:()=>d&&d(s),title:"Edit Budget",children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>i&&i(s),title:"Delete Budget",children:e.jsx("i",{className:"fas fa-trash"})})]})})]},s.id)})})]})})}),m>1&&!N&&e.jsx("div",{className:"card-footer bg-light",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("div",{children:e.jsxs("small",{className:"text-muted",children:["Page ",h," of ",m," (",w," total budgets)"]})}),e.jsx("nav",{children:e.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[e.jsx("li",{className:`page-item ${h===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>l(1),disabled:h===1,children:e.jsx("i",{className:"fas fa-angle-double-left"})})}),e.jsx("li",{className:`page-item ${h===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>l(h-1),disabled:h===1,children:e.jsx("i",{className:"fas fa-angle-left"})})}),Array.from({length:Math.min(5,m)}).map((s,c)=>{let j;return m<=5||h<=3?j=c+1:h>=m-2?j=m-4+c:j=h-2+c,j>=1&&j<=m?e.jsx("li",{className:`page-item ${h===j?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>l(j),children:j})},j):null}),e.jsx("li",{className:`page-item ${h===m?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>l(h+1),disabled:h===m,children:e.jsx("i",{className:"fas fa-angle-right"})})}),e.jsx("li",{className:`page-item ${h===m?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>l(m),disabled:h===m,children:e.jsx("i",{className:"fas fa-angle-double-right"})})})]})})]})})]})})]})},fe=({budget:a,show:r,onClose:m,onStatusChange:w,onEdit:N,onDelete:x})=>{const[l,n]=u.useState("overview");if(!r||!a)return null;const d=Math.min(Math.round(a.spent/a.amount*100),100),i=o=>o>=90?"#dc3545":o>=70?"#fd7e14":"#28a745",h=o=>{switch(o){case"active":return{label:"Active",color:"#28a745",bgColor:"rgba(40, 167, 69, 0.1)",icon:"fa-play-circle"};case"completed":return{label:"Completed",color:"#007bff",bgColor:"rgba(0, 123, 255, 0.1)",icon:"fa-check-circle"};default:return{label:"Archived",color:"#6c757d",bgColor:"rgba(108, 117, 125, 0.1)",icon:"fa-archive"}}},k=o=>new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),B=()=>{const o=new Date(a.end_date),S=new Date;return Math.ceil((o.getTime()-S.getTime())/(1e3*60*60*24))},p=h(a.status),b=B();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:m}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:m,children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",onClick:o=>o.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"85vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"40px",height:"40px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-calculator fa-lg"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold",children:"Budget Details"}),e.jsx("small",{style:{opacity:.9},children:a.name})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:m,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsx("div",{className:"d-none d-md-block px-3 py-2",style:{background:"#f8f9fa",borderBottom:"1px solid #e9ecef"},children:e.jsxs("div",{className:"row text-center g-2",children:[e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-peso-sign text-primary mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Budget"}),e.jsxs("strong",{className:"text-primary",style:{fontSize:"0.8rem"},children:["₱",a.amount.toLocaleString()]})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-receipt text-danger mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Spent"}),e.jsxs("strong",{className:"text-danger",style:{fontSize:"0.8rem"},children:["₱",a.spent.toLocaleString()]})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-wallet text-success mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Remaining"}),e.jsxs("strong",{className:"text-success",style:{fontSize:"0.8rem"},children:["₱",(a.amount-a.spent).toLocaleString()]})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-chart-pie mr-2",style:{color:i(d)}}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Progress"}),e.jsxs("strong",{style:{color:i(d),fontSize:"0.8rem"},children:[d,"%"]})]})]})})]})}),e.jsx("div",{className:"d-block d-md-none px-2 py-2",style:{background:"#f8f9fa",borderBottom:"1px solid #e9ecef"},children:e.jsxs("div",{className:"d-flex justify-content-between text-center",children:[e.jsxs("div",{className:"flex-fill px-1",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.55rem"},children:"Budget"}),e.jsxs("strong",{className:"text-primary",style:{fontSize:"0.65rem"},children:["₱",a.amount.toLocaleString()]})]}),e.jsxs("div",{className:"flex-fill px-1",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.55rem"},children:"Spent"}),e.jsxs("strong",{className:"text-danger",style:{fontSize:"0.65rem"},children:["₱",a.spent.toLocaleString()]})]}),e.jsxs("div",{className:"flex-fill px-1",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.55rem"},children:"Left"}),e.jsxs("strong",{className:"text-success",style:{fontSize:"0.65rem"},children:["₱",(a.amount-a.spent).toLocaleString()]})]}),e.jsxs("div",{className:"flex-fill px-1",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.55rem"},children:"Progress"}),e.jsxs("strong",{style:{color:i(d),fontSize:"0.65rem"},children:[d,"%"]})]})]})}),e.jsx("div",{className:"d-none d-md-block px-3 pt-2",children:e.jsx("div",{className:"d-flex",style:{gap:"6px"},children:[{id:"overview",icon:"fa-chart-pie",label:"Overview"},{id:"details",icon:"fa-info-circle",label:"Details"},{id:"owner",icon:"fa-user",label:"Owner"},{id:"status",icon:"fa-cogs",label:"Status"}].map(o=>e.jsxs("button",{className:`btn btn-sm ${l===o.id?"btn-danger":"btn-outline-secondary"}`,onClick:()=>n(o.id),style:{borderRadius:"16px",padding:"4px 12px",fontSize:"0.8rem"},children:[e.jsx("i",{className:`fas ${o.icon} mr-1`}),o.label]},o.id))})}),e.jsx("div",{className:"d-block d-md-none px-2 pt-2",children:e.jsx("div",{className:"d-flex overflow-auto",style:{gap:"4px"},children:[{id:"overview",icon:"fa-chart-pie",label:"Overview"},{id:"details",icon:"fa-info-circle",label:"Details"},{id:"owner",icon:"fa-user",label:"Owner"},{id:"status",icon:"fa-cogs",label:"Status"}].map(o=>e.jsxs("button",{className:`btn btn-sm ${l===o.id?"btn-danger":"btn-outline-secondary"}`,onClick:()=>n(o.id),style:{borderRadius:"12px",padding:"3px 8px",fontSize:"0.65rem",whiteSpace:"nowrap"},children:[e.jsx("i",{className:`fas ${o.icon}`,style:{marginRight:"2px"}}),o.label]},o.id))})}),e.jsxs("div",{className:"modal-body py-3",style:{maxHeight:"45vh",overflowY:"auto"},children:[l==="overview"&&e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-7",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-chart-bar mr-2"}),"Financial Summary"]}),e.jsxs("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"row text-center mb-3",children:[e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"p-2",style:{background:"rgba(0,123,255,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",children:"Budget"}),e.jsxs("strong",{className:"text-primary",children:["₱",a.amount.toLocaleString()]})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"p-2",style:{background:"rgba(220,53,69,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",children:"Spent"}),e.jsxs("strong",{className:"text-danger",children:["₱",a.spent.toLocaleString()]})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"p-2",style:{background:"rgba(40,167,69,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",children:"Remaining"}),e.jsxs("strong",{className:"text-success",children:["₱",(a.amount-a.spent).toLocaleString()]})]})})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsx("small",{className:"text-muted",children:"Spending Progress"}),e.jsxs("small",{style:{color:i(d)},children:[d,"%"]})]}),e.jsx("div",{className:"progress mb-2",style:{height:"8px",borderRadius:"4px"},children:e.jsx("div",{className:"progress-bar",style:{width:`${d}%`,background:i(d),borderRadius:"4px"}})}),e.jsx("div",{className:"text-center mt-2",children:d>=100?e.jsxs("span",{className:"badge badge-danger px-3 py-1",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-1"}),"Over Budget"]}):d>=80?e.jsxs("span",{className:"badge badge-warning px-3 py-1",children:[e.jsx("i",{className:"fas fa-exclamation-circle mr-1"}),"Near Limit"]}):e.jsxs("span",{className:"badge badge-success px-3 py-1",children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),"On Track"]})})]})]}),e.jsxs("div",{className:"col-lg-5",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-clock mr-2"}),"Timeline"]}),e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"d-flex justify-content-between py-1",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Start Date"}),e.jsx("span",{style:{fontSize:"0.85rem"},children:k(a.start_date)})]}),e.jsxs("div",{className:"d-flex justify-content-between py-1",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"End Date"}),e.jsx("span",{style:{fontSize:"0.85rem"},children:k(a.end_date)})]}),e.jsxs("div",{className:"d-flex justify-content-between py-1",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Days Left"}),e.jsx("span",{style:{fontSize:"0.85rem",color:b<0?"#dc3545":b<7?"#fd7e14":"#28a745"},children:b<0?`Ended ${Math.abs(b)} days ago`:`${b} days`})]}),e.jsxs("div",{className:"d-flex justify-content-between py-1",children:[e.jsx("small",{className:"text-muted",children:"Status"}),e.jsxs("span",{className:"badge px-2 py-1",style:{background:p.bgColor,color:p.color,fontSize:"0.75rem"},children:[e.jsx("i",{className:`fas ${p.icon} mr-1`}),p.label]})]})]})]})]}),l==="details"&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Budget Information"]}),e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px",fontSize:"0.85rem"},children:[e.jsxs("div",{className:"d-flex justify-content-between py-2",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Budget ID"}),e.jsx("code",{style:{fontSize:"0.75rem"},children:a.id})]}),e.jsxs("div",{className:"d-flex justify-content-between py-2",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Name"}),e.jsx("strong",{children:a.name})]}),e.jsxs("div",{className:"d-flex justify-content-between py-2",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Category"}),e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-tag text-muted mr-1"}),a.category]})]}),e.jsxs("div",{className:"d-flex justify-content-between py-2",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Amount"}),e.jsxs("strong",{className:"text-primary",children:["₱",a.amount.toLocaleString()]})]}),e.jsxs("div",{className:"d-flex justify-content-between py-2",style:{borderBottom:"1px solid #e9ecef"},children:[e.jsx("small",{className:"text-muted",children:"Period"}),e.jsxs("span",{children:[k(a.start_date)," - ",k(a.end_date)]})]}),e.jsxs("div",{className:"d-flex justify-content-between py-2",children:[e.jsx("small",{className:"text-muted",children:"Status"}),e.jsxs("span",{className:"badge px-2 py-1",style:{background:p.bgColor,color:p.color,fontSize:"0.75rem"},children:[e.jsx("i",{className:`fas ${p.icon} mr-1`}),p.label]})]})]})]}),l==="owner"&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-user mr-2"}),"Budget Owner"]}),e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("img",{src:a.user_avatar||"../images/placeholder.png",alt:a.user_name,className:"rounded-circle mr-3",style:{width:"64px",height:"64px",objectFit:"cover",border:"3px solid #dc3545"},onError:o=>{o.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1rem",fontWeight:600},children:a.user_name}),e.jsx("small",{className:"text-muted",children:a.user_email}),e.jsx("div",{className:"mt-1",children:e.jsxs("span",{className:"badge px-2 py-1",style:{background:p.bgColor,color:p.color,fontSize:"0.7rem"},children:[e.jsx("i",{className:`fas ${p.icon} mr-1`}),p.label," Budget"]})})]})]}),e.jsx("div",{className:"pt-2",style:{borderTop:"1px solid #e9ecef"},children:e.jsxs("div",{className:"row text-center",style:{fontSize:"0.85rem"},children:[e.jsxs("div",{className:"col-4",children:[e.jsx("small",{className:"text-muted d-block",children:"Budget"}),e.jsxs("strong",{className:"text-primary",children:["₱",a.amount.toLocaleString()]})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("small",{className:"text-muted d-block",children:"Spent"}),e.jsxs("strong",{className:"text-danger",children:["₱",a.spent.toLocaleString()]})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("small",{className:"text-muted d-block",children:"Progress"}),e.jsxs("strong",{style:{color:i(d)},children:[d,"%"]})]})]})})]})]}),l==="status"&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-cogs mr-2"}),"Status Management"]}),e.jsxs("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("p",{className:"text-muted mb-3",style:{fontSize:"0.85rem"},children:["Current status: ",e.jsx("strong",{style:{color:p.color},children:p.label})]}),e.jsx("div",{className:"d-flex",style:{gap:"8px"},children:[{value:"active",label:"Active",icon:"fa-play-circle",color:"#28a745"},{value:"completed",label:"Completed",icon:"fa-check-circle",color:"#007bff"},{value:"archived",label:"Archived",icon:"fa-archive",color:"#6c757d"}].map(o=>e.jsxs("button",{type:"button",className:`btn btn-sm flex-fill ${a.status===o.value?"":"btn-outline-secondary"}`,style:{borderRadius:"6px",background:a.status===o.value?o.color:void 0,borderColor:a.status===o.value?o.color:void 0,color:a.status===o.value?"white":void 0},onClick:()=>w(a,o.value),children:[e.jsx("i",{className:`fas ${o.icon} mr-1`}),o.label]},o.value))})]}),e.jsx("div",{className:"p-3",style:{background:"#fff5f5",borderRadius:"8px",borderLeft:"3px solid #dc3545"},children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-info-circle mr-1 text-danger"}),"Status changes are saved immediately and may affect the budget's visibility and tracking."]})})]})]}),e.jsxs("div",{className:"modal-footer border-0 py-2",style:{background:"#f8f9fa"},children:[e.jsxs("small",{className:"text-muted mr-auto",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"fas fa-fingerprint mr-1"}),"ID: ",e.jsxs("code",{style:{fontSize:"0.7rem"},children:[a.id?.substring(0,12),"..."]})]}),e.jsxs("button",{type:"button",className:"btn btn-secondary btn-sm mr-2",onClick:m,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Close"]}),e.jsxs("button",{type:"button",className:"btn btn-warning btn-sm mr-2",onClick:()=>N&&N(a),children:[e.jsx("i",{className:"fas fa-edit mr-1"}),"Edit"]}),e.jsxs("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>x&&x(a),children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Delete"]})]})]})})})]})},ge=()=>{const[a,r]=u.useState([]),[m,w]=u.useState([]),[N,x]=u.useState([]),[l,n]=u.useState({totalBudgets:0,activeBudgets:0,budgetCategories:0,usersWithBudgets:0,budgetsByCategory:{},budgetsByStatus:{active:0,completed:0,archived:0},budgetsByUser:{}}),[d,i]=u.useState(!0),[h,k]=u.useState(1),[B,p]=u.useState(0),[b,o]=u.useState(null),{showSuccessToast:S,showErrorToast:g}=ne(),y=u.useCallback(async()=>{try{if(!L)throw new Error("Admin client not available");const{data:s,error:c}=await L.auth.admin.listUsers({page:1,perPage:1e3});if(c)throw c;const j=(s?.users||[]).map(t=>({id:t.id,email:t.email||"",user_metadata:t.user_metadata||{}}));return x(j),j}catch(s){return console.error("Error fetching users:",s),g("Failed to load users"),[]}},[g]),D=u.useCallback(async()=>{try{if(!L)throw new Error("Admin client not available");const{data:s,error:c}=await L.from("expense_categories").select("id, category_name, user_id").order("category_name",{ascending:!0});if(c)throw c;w(s||[])}catch{g("Failed to load categories")}},[g]),_=u.useCallback(async s=>{try{if(i(!0),!L)throw new Error("Admin client not available");const c=await y();let j="created_at";try{const{data:v,error:$}=await L.from("budgets").select("*").limit(1).single();!$&&v&&Object.keys(v).includes(s.sortField)&&(j=s.sortField)}catch{}let t=L.from("budgets").select("id",{count:"exact"});if(s.filterCategory!=="all"&&(t=t.eq("category_id",s.filterCategory)),s.filterStatus!=="all"){const v=new Date().toISOString().split("T")[0];s.filterStatus==="active"?t=t.lte("start_date",v).gte("end_date",v):s.filterStatus==="completed"?t=t.lt("end_date",v):s.filterStatus==="archived"&&(t=t.gt("start_date",v))}const{count:f,error:T}=await t;if(T)throw T;let R=L.from("budgets").select("*, expense_categories(category_name)");if(R=R.order(j,{ascending:s.sortDirection==="asc"}),s.filterCategory!=="all"&&(R=R.eq("category_id",s.filterCategory)),s.filterStatus!=="all"){const v=new Date().toISOString().split("T")[0];s.filterStatus==="active"?R=R.lte("start_date",v).gte("end_date",v):s.filterStatus==="completed"?R=R.lt("end_date",v):s.filterStatus==="archived"&&(R=R.gt("start_date",v))}if(s.searchTerm){const v=s.searchTerm.toLowerCase().trim(),$=[];c.forEach(M=>{((M.user_metadata?.full_name||M.email?.split("@")[0]||"").toLowerCase().includes(v)||M.email&&M.email.toLowerCase().includes(v))&&$.push(M.id)});const{data:C,error:A}=await L.from("expense_categories").select("id").ilike("category_name",`%${v}%`);if(A)throw A;const E=C?.map(M=>M.id)||[];if($.length>0||E.length>0)if($.length>0)R=R.in("user_id",$);else if(E.length>0)R=R.in("category_id",E);else{r([]),n({totalBudgets:0,activeBudgets:0,budgetCategories:0,usersWithBudgets:0,budgetsByCategory:{},budgetsByStatus:{active:0,completed:0,archived:0},budgetsByUser:{}}),p(0),k(1),i(!1);return}else{r([]),n({totalBudgets:0,activeBudgets:0,budgetCategories:0,usersWithBudgets:0,budgetsByCategory:{},budgetsByStatus:{active:0,completed:0,archived:0},budgetsByUser:{}}),p(0),k(1),i(!1);return}}const q=(s.currentPage-1)*s.pageSize,Z=q+s.pageSize-1,{data:Y,error:V}=await R.range(q,Z);if(V)throw V;const U={},H={active:0,completed:0,archived:0},O={},G=[],{data:ee,error:Q}=await L.from("transactions").select("amount, expense_category_id, type, date").eq("type","expense");if(Q)throw Q;for(const v of Y||[]){const $=v.expense_categories?.category_name||"Uncategorized",C=c.find(P=>P.id===v.user_id),A=new Date(v.start_date),E=new Date(v.end_date),J=(ee?.filter(P=>P.expense_category_id===v.category_id&&P.type==="expense"&&new Date(P.date)>=A&&new Date(P.date)<=E)||[]).reduce((P,he)=>P+he.amount,0),ce=v.amount-J,de=v.amount>0?J/v.amount*100:0;let W;const ae=new Date;ae<A?W="archived":ae>E?W="completed":W="active";const oe=new Date(v.start_date).toLocaleString("default",{month:"long"}),me=new Date(v.start_date).getFullYear(),xe={id:v.id,name:`${$} Budget`,amount:v.amount,spent:J,start_date:v.start_date,end_date:v.end_date,category:$,category_id:v.category_id,user_id:v.user_id,user_name:C?.user_metadata?.full_name||C?.email?.split("@")[0]||"Unknown User",user_email:C?.email||"",user_avatar:C?.user_metadata?.avatar_url||"",status:W,month:oe,year:me,period:v.period||"month",remaining:ce,percentage:de};G.push(xe),$ in U?U[$]+=1:U[$]=1,H[W]+=1;const se=C?.user_metadata?.full_name||C?.email?.split("@")[0]||"Unknown User";se in O?O[se]+=1:O[se]=1}r(G),n({totalBudgets:f||0,activeBudgets:H.active,budgetCategories:Object.keys(U).length,usersWithBudgets:Object.keys(O).length,budgetsByCategory:U,budgetsByStatus:H,budgetsByUser:O}),p(f||0),k(Math.ceil((f||0)/s.pageSize)),i(!1)}catch(c){g(`Failed to load budgets: ${c instanceof Error?c.message:JSON.stringify(c)}`),i(!1)}},[g]),F=u.useCallback(async s=>{i(!0);try{await y(),await _(s),await D(),S("Budget data refreshed successfully")}catch{g("Failed to refresh budget data")}finally{i(!1)}},[y,_,D,S,g]),z=u.useCallback(async(s,c)=>{try{if(i(!0),!L)throw new Error("Admin client not available");const{error:j}=await L.from("budgets").update({status:c}).eq("id",s.id);if(j)throw j;r(t=>t.map(f=>f.id===s.id?{...f,status:c}:f)),S(`Budget status updated to ${c}`),i(!1)}catch{g("Failed to update budget status"),i(!1)}},[S,g]);return u.useEffect(()=>{let s;try{if(!L){console.error("Admin client not available");return}s=L.channel("admin-budgets-channel"),s.on("postgres_changes",{event:"*",schema:"public",table:"budgets"},()=>{}).subscribe(),o(s)}catch(c){console.error("Error setting up real-time subscriptions:",c)}return()=>{if(s&&L)try{L.removeChannel(s)}catch(c){console.error("Error cleaning up channel:",c)}}},[]),u.useEffect(()=>()=>{if(b&&L)try{L.removeChannel(b)}catch(s){console.error("Error removing channel on unmount:",s)}},[b]),{budgets:a,categories:m,users:N,stats:l,loading:d,totalPages:h,totalItems:B,fetchBudgets:_,fetchCategories:D,fetchUsers:y,refreshBudgetData:F,changeBudgetStatus:z}},je=a=>{const[r,m]=u.useState({searchTerm:"",filterCategory:"all",filterStatus:"all",sortField:"created_at",sortDirection:"desc",currentPage:1,pageSize:5,...a}),w=u.useCallback(n=>{m(d=>({...d,...n}))},[]),N=u.useCallback(n=>{const i={name:"category_id",user_name:"user_id",category:"category_id",amount:"amount",spent:"amount",status:"end_date",created_at:"created_at"}[n]||n;m(h=>({...h,sortField:i===h.sortField?h.sortField:i,sortDirection:i===h.sortField&&h.sortDirection==="asc"?"desc":"asc"}))},[]),x=u.useCallback(n=>{m(d=>({...d,currentPage:n}))},[]),l=u.useCallback(()=>{m({searchTerm:"",filterCategory:"all",filterStatus:"all",sortField:"created_at",sortDirection:"desc",currentPage:1,pageSize:5})},[]);return{filters:r,updateFilters:w,handleSort:N,handlePageChange:x,resetFilters:l}},pe=({show:a,onClose:r,onAdd:m,categories:w,users:N,loading:x=!1})=>{const[l,n]=u.useState({name:"",category:"",amount:0,start_date:"",end_date:"",user_id:"",status:"active"}),[d,i]=u.useState({}),[h,k]=u.useState(""),[B,p]=u.useState(!1);u.useEffect(()=>{a&&(n({name:"",category:"",amount:0,start_date:"",end_date:"",user_id:"",status:"active"}),i({}),k(""),p(!1))},[a]),u.useEffect(()=>{const s=c=>{B&&(c.target.closest(".position-relative")||p(!1))};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[B]);const b=(s,c)=>{n(j=>({...j,[s]:c})),d[s]&&i(j=>({...j,[s]:""}))},o=()=>{const s={};return l.name?.trim()||(s.name="Budget name is required"),l.category||(s.category="Category is required"),(!l.amount||l.amount<=0)&&(s.amount="Amount must be greater than 0"),l.start_date||(s.start_date="Start date is required"),l.end_date||(s.end_date="End date is required"),l.user_id||(s.user_id="User is required"),l.start_date&&l.end_date&&new Date(l.start_date)>=new Date(l.end_date)&&(s.end_date="End date must be after start date"),i(s),Object.keys(s).length===0},S=s=>{s.preventDefault(),o()&&m(l)},g=s=>{n(c=>({...c,user_id:s.id})),k(s.user_metadata?.full_name||s.email?.split("@")[0]||"Unknown User"),p(!1),d.user_id&&i(c=>({...c,user_id:""}))},y=()=>{n({name:"",category:"",amount:0,start_date:"",end_date:"",user_id:"",status:"active"}),i({}),k(""),p(!1),r()},D=N.filter(s=>{const c=h.toLowerCase(),j=s.user_metadata?.full_name?.toLowerCase()||"",t=s.email?.toLowerCase()||"";return j.includes(c)||t.includes(c)}),_=N.find(s=>s.id===l.user_id),z=(()=>{if(!l.start_date||!l.end_date)return null;const s=new Date(l.start_date),c=new Date(l.end_date),j=new Date,t=Math.ceil((s.getTime()-j.getTime())/(1e3*60*60*24)),f=Math.ceil((c.getTime()-s.getTime())/(1e3*60*60*24));return{daysUntilStart:t,duration:f}})();return a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:y}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:y,children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"85vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"40px",height:"40px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-plus-circle fa-lg"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold",children:"Create New Budget"}),e.jsx("small",{style:{opacity:.9},children:"Set spending limits and track expenses"})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:y,disabled:x,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsx("div",{className:"d-none d-md-block px-3 py-2",style:{background:"#f8f9fa",borderBottom:"1px solid #e9ecef"},children:e.jsxs("div",{className:"row text-center g-2",children:[e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:`fas fa-signature mr-2 ${l.name?"text-success":"text-muted"}`}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Name"}),e.jsx("strong",{className:l.name?"text-success":"text-muted",style:{fontSize:"0.8rem"},children:l.name?"✓ Set":"Required"})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:`fas fa-peso-sign mr-2 ${l.amount&&l.amount>0?"text-success":"text-muted"}`}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Amount"}),e.jsx("strong",{className:l.amount&&l.amount>0?"text-success":"text-muted",style:{fontSize:"0.8rem"},children:l.amount&&l.amount>0?`₱${l.amount.toLocaleString()}`:"Required"})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:`fas fa-calendar mr-2 ${z?"text-success":"text-muted"}`}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Duration"}),e.jsx("strong",{className:z?"text-success":"text-muted",style:{fontSize:"0.8rem"},children:z?`${z.duration} days`:"Required"})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:`fas fa-user mr-2 ${l.user_id?"text-success":"text-muted"}`}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"User"}),e.jsx("strong",{className:l.user_id?"text-success":"text-muted",style:{fontSize:"0.8rem"},children:l.user_id?"✓ Assigned":"Required"})]})]})})]})}),e.jsx("div",{className:"d-block d-md-none px-2 py-2",style:{background:"#f8f9fa",borderBottom:"1px solid #e9ecef"},children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{className:"text-center flex-fill",children:[e.jsx("i",{className:`fas fa-signature ${l.name?"text-success":"text-muted"}`,style:{fontSize:"0.7rem"}}),e.jsx("div",{className:`${l.name?"text-success":"text-muted"}`,style:{fontSize:"0.6rem"},children:l.name?"✓":"○"})]}),e.jsxs("div",{className:"text-center flex-fill",children:[e.jsx("i",{className:`fas fa-peso-sign ${l.amount&&l.amount>0?"text-success":"text-muted"}`,style:{fontSize:"0.7rem"}}),e.jsx("div",{className:`${l.amount&&l.amount>0?"text-success":"text-muted"}`,style:{fontSize:"0.6rem"},children:l.amount&&l.amount>0?"✓":"○"})]}),e.jsxs("div",{className:"text-center flex-fill",children:[e.jsx("i",{className:`fas fa-calendar ${z?"text-success":"text-muted"}`,style:{fontSize:"0.7rem"}}),e.jsx("div",{className:`${z?"text-success":"text-muted"}`,style:{fontSize:"0.6rem"},children:z?"✓":"○"})]}),e.jsxs("div",{className:"text-center flex-fill",children:[e.jsx("i",{className:`fas fa-user ${l.user_id?"text-success":"text-muted"}`,style:{fontSize:"0.7rem"}}),e.jsx("div",{className:`${l.user_id?"text-success":"text-muted"}`,style:{fontSize:"0.6rem"},children:l.user_id?"✓":"○"})]})]})}),e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:"modal-body py-3",style:{maxHeight:"55vh",overflowY:"auto"},children:[e.jsxs("div",{className:"row mb-3",children:[e.jsxs("div",{className:"col-lg-6",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Budget Details"]}),e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{className:"small text-muted mb-1",children:"Budget Name *"}),e.jsx("input",{type:"text",className:`form-control form-control-sm ${d.name?"is-invalid":""}`,placeholder:"e.g., Monthly Groceries",value:l.name||"",onChange:s=>b("name",s.target.value),maxLength:100,disabled:x,style:{borderRadius:"6px"}}),d.name&&e.jsx("div",{className:"invalid-feedback",style:{fontSize:"0.75rem"},children:d.name})]}),e.jsxs("div",{className:"form-group mb-0",children:[e.jsx("label",{className:"small text-muted mb-1",children:"Category *"}),e.jsxs("select",{className:`form-control form-control-sm ${d.category?"is-invalid":""}`,value:l.category||"",onChange:s=>b("category",s.target.value),disabled:x,style:{borderRadius:"6px"},children:[e.jsx("option",{value:"",children:"Select Category"}),w.map(s=>e.jsx("option",{value:s.category_name,children:s.category_name},s.id))]}),d.category&&e.jsx("div",{className:"invalid-feedback",style:{fontSize:"0.75rem"},children:d.category})]})]})]}),e.jsxs("div",{className:"col-lg-6",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-peso-sign mr-2"}),"Budget Amount"]}),e.jsx("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:e.jsxs("div",{className:"form-group mb-0",children:[e.jsx("label",{className:"small text-muted mb-1",children:"Amount (PHP) *"}),e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("span",{className:"input-group-text",style:{borderRadius:"6px 0 0 6px"},children:"₱"})}),e.jsx("input",{type:"number",className:`form-control ${d.amount?"is-invalid":""}`,placeholder:"0.00",value:l.amount||"",onChange:s=>b("amount",parseFloat(s.target.value)||0),min:"0",step:"0.01",disabled:x,style:{borderRadius:"0 6px 6px 0"}}),d.amount&&e.jsx("div",{className:"invalid-feedback",style:{fontSize:"0.75rem"},children:d.amount})]}),e.jsxs("small",{className:"text-muted mt-1 d-block",style:{fontSize:"0.7rem"},children:[e.jsx("i",{className:"fas fa-info-circle mr-1"}),"Enter the maximum spending limit for this budget"]})]})})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-calendar-alt mr-2"}),"Budget Timeline"]}),e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group mb-md-0 mb-3",children:[e.jsx("label",{className:"small text-muted mb-1",children:"Start Date *"}),e.jsx("input",{type:"date",className:`form-control form-control-sm ${d.start_date?"is-invalid":""}`,value:l.start_date||"",onChange:s=>b("start_date",s.target.value),disabled:x,style:{borderRadius:"6px"}}),d.start_date&&e.jsx("div",{className:"invalid-feedback",style:{fontSize:"0.75rem"},children:d.start_date})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group mb-0",children:[e.jsx("label",{className:"small text-muted mb-1",children:"End Date *"}),e.jsx("input",{type:"date",className:`form-control form-control-sm ${d.end_date?"is-invalid":""}`,value:l.end_date||"",onChange:s=>b("end_date",s.target.value),disabled:x,style:{borderRadius:"6px"}}),d.end_date&&e.jsx("div",{className:"invalid-feedback",style:{fontSize:"0.75rem"},children:d.end_date})]})})]}),z&&e.jsx("div",{className:"mt-2 pt-2",style:{borderTop:"1px solid #e9ecef"},children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-clock mr-1"}),z.daysUntilStart>0?`Starts in ${z.daysUntilStart} days`:z.daysUntilStart===0?"Starts today":"Already started"]}),e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-hourglass-half mr-1"}),"Duration: ",z.duration," days"]})]})})]})]}),e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-user-plus mr-2"}),"Assign to User"]}),e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"form-group mb-2",children:[e.jsx("label",{className:"small text-muted mb-1",children:"Search User *"}),e.jsxs("div",{className:"position-relative",children:[e.jsx("input",{type:"text",className:`form-control form-control-sm ${d.user_id?"is-invalid":""}`,placeholder:"Type to search users...",value:h,onChange:s=>{k(s.target.value),p(!0)},onFocus:()=>p(!0),disabled:x,style:{borderRadius:"6px"}}),B&&D.length>0&&e.jsx("div",{className:"dropdown-menu show w-100",style:{maxHeight:"150px",overflowY:"auto",position:"absolute",zIndex:1e3,borderRadius:"6px"},children:D.slice(0,5).map(s=>e.jsxs("button",{type:"button",className:"dropdown-item d-flex align-items-center py-2",onClick:()=>g(s),children:[e.jsx("img",{src:s.user_metadata?.avatar_url||"../images/placeholder.png",alt:"Avatar",className:"rounded-circle mr-2",style:{width:"28px",height:"28px",objectFit:"cover"},onError:c=>{c.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.85rem",fontWeight:500},children:s.user_metadata?.full_name||s.email?.split("@")[0]||"Unknown"}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.7rem"},children:s.email})]})]},s.id))}),d.user_id&&e.jsx("div",{className:"invalid-feedback d-block",style:{fontSize:"0.75rem"},children:d.user_id})]})]}),_&&e.jsxs("div",{className:"d-flex align-items-center p-2 mt-2",style:{background:"#d4edda",borderRadius:"6px",border:"1px solid #c3e6cb"},children:[e.jsx("img",{src:_.user_metadata?.avatar_url||"../images/placeholder.png",alt:"Avatar",className:"rounded-circle mr-2",style:{width:"32px",height:"32px",objectFit:"cover"},onError:s=>{s.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("div",{style:{fontSize:"0.85rem",fontWeight:500},children:_.user_metadata?.full_name||_.email?.split("@")[0]||"Unknown"}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.7rem"},children:_.email})]}),e.jsx("i",{className:"fas fa-check-circle text-success"})]})]})]})]}),e.jsxs("div",{className:"modal-footer border-0 py-2",style:{background:"#f8f9fa"},children:[e.jsxs("small",{className:"text-muted mr-auto",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"fas fa-plus-circle mr-1"}),"Budget will be created immediately"]}),e.jsxs("button",{type:"button",className:"btn btn-secondary btn-sm mr-2",onClick:y,disabled:x,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Cancel"]}),e.jsx("button",{type:"submit",className:"btn btn-danger btn-sm",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm mr-1"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-plus mr-1"}),"Create Budget"]})})]})]})]})})})]}):null},be=({show:a,budget:r,onClose:m,onUpdate:w,categories:N,users:x,loading:l=!1})=>{const[n,d]=u.useState({}),[i,h]=u.useState({}),[k,B]=u.useState(""),[p,b]=u.useState(!1),[o,S]=u.useState("details");u.useEffect(()=>{if(a&&r){d({name:r.name,category:r.category,amount:r.amount,start_date:r.start_date,end_date:r.end_date,user_id:r.user_id,status:r.status}),h({}),S("details");const t=x.find(f=>f.id===r.user_id);B(t?.user_metadata?.full_name||t?.email?.split("@")[0]||"Unknown User"),b(!1)}},[a,r,x]),u.useEffect(()=>{const t=f=>{p&&(f.target.closest(".position-relative")||b(!1))};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[p]);const g=(t,f)=>{d(T=>({...T,[t]:f})),i[t]&&h(T=>({...T,[t]:""}))},y=t=>{d(f=>({...f,user_id:t.id})),B(t.user_metadata?.full_name||t.email?.split("@")[0]||"Unknown User"),b(!1),i.user_id&&h(f=>({...f,user_id:""}))},D=()=>{const t={};return n.name?.trim()||(t.name="Budget name is required"),n.category||(t.category="Category is required"),(!n.amount||n.amount<=0)&&(t.amount="Amount must be greater than 0"),n.start_date||(t.start_date="Start date is required"),n.end_date||(t.end_date="End date is required"),n.user_id||(t.user_id="User is required"),n.start_date&&n.end_date&&new Date(n.start_date)>=new Date(n.end_date)&&(t.end_date="End date must be after start date"),h(t),Object.keys(t).length===0},_=t=>{t.preventDefault(),r&&D()&&w(r.id,n)},F=()=>{d({}),h({}),B(""),b(!1),m()},z=x.filter(t=>{const f=k.toLowerCase(),T=t.user_metadata?.full_name?.toLowerCase()||"",R=t.email?.toLowerCase()||"";return T.includes(f)||R.includes(f)}),s=x.find(t=>t.id===n.user_id),c=r?Math.min(Math.round(r.spent/r.amount*100),100):0,j=t=>t>=90?"#dc3545":t>=70?"#fd7e14":"#28a745";return!a||!r?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:F}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:F,children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"85vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"40px",height:"40px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-edit fa-lg"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold",children:"Edit Budget"}),e.jsx("small",{style:{opacity:.9},children:r.name})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:F,disabled:l,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsx("div",{className:"d-none d-md-block px-3 py-2",style:{background:"#f8f9fa",borderBottom:"1px solid #e9ecef"},children:e.jsxs("div",{className:"row text-center g-2",children:[e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-peso-sign text-primary mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Budget"}),e.jsxs("strong",{className:"text-primary",style:{fontSize:"0.8rem"},children:["₱",r.amount.toLocaleString()]})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-receipt text-danger mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Spent"}),e.jsxs("strong",{className:"text-danger",style:{fontSize:"0.8rem"},children:["₱",r.spent.toLocaleString()]})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-wallet text-success mr-2"}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Remaining"}),e.jsxs("strong",{className:"text-success",style:{fontSize:"0.8rem"},children:["₱",(r.amount-r.spent).toLocaleString()]})]})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"fas fa-chart-pie mr-2",style:{color:j(c)}}),e.jsxs("div",{className:"text-left",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.7rem",lineHeight:1},children:"Progress"}),e.jsxs("strong",{style:{color:j(c),fontSize:"0.8rem"},children:[c,"%"]})]})]})})]})}),e.jsx("div",{className:"d-block d-md-none px-2 py-2",style:{background:"#f8f9fa",borderBottom:"1px solid #e9ecef"},children:e.jsxs("div",{className:"d-flex justify-content-between text-center",children:[e.jsxs("div",{className:"flex-fill px-1",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.55rem"},children:"Budget"}),e.jsxs("strong",{className:"text-primary",style:{fontSize:"0.65rem"},children:["₱",r.amount.toLocaleString()]})]}),e.jsxs("div",{className:"flex-fill px-1",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.55rem"},children:"Spent"}),e.jsxs("strong",{className:"text-danger",style:{fontSize:"0.65rem"},children:["₱",r.spent.toLocaleString()]})]}),e.jsxs("div",{className:"flex-fill px-1",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.55rem"},children:"Left"}),e.jsxs("strong",{className:"text-success",style:{fontSize:"0.65rem"},children:["₱",(r.amount-r.spent).toLocaleString()]})]}),e.jsxs("div",{className:"flex-fill px-1",children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.55rem"},children:"Progress"}),e.jsxs("strong",{style:{color:j(c),fontSize:"0.65rem"},children:[c,"%"]})]})]})}),e.jsx("div",{className:"d-none d-md-block px-3 pt-2",children:e.jsx("div",{className:"d-flex",style:{gap:"6px"},children:[{id:"details",icon:"fa-info-circle",label:"Details"},{id:"financial",icon:"fa-peso-sign",label:"Financial"},{id:"timeline",icon:"fa-calendar-alt",label:"Timeline"},{id:"owner",icon:"fa-user",label:"Owner"}].map(t=>e.jsxs("button",{type:"button",className:`btn btn-sm ${o===t.id?"btn-danger":"btn-outline-secondary"}`,onClick:()=>S(t.id),style:{borderRadius:"16px",padding:"4px 12px",fontSize:"0.8rem"},children:[e.jsx("i",{className:`fas ${t.icon} mr-1`}),t.label]},t.id))})}),e.jsx("div",{className:"d-block d-md-none px-2 pt-2",children:e.jsx("div",{className:"d-flex overflow-auto",style:{gap:"4px"},children:[{id:"details",icon:"fa-info-circle",label:"Details"},{id:"financial",icon:"fa-peso-sign",label:"Budget"},{id:"timeline",icon:"fa-calendar-alt",label:"Time"},{id:"owner",icon:"fa-user",label:"Owner"}].map(t=>e.jsxs("button",{type:"button",className:`btn btn-sm ${o===t.id?"btn-danger":"btn-outline-secondary"}`,onClick:()=>S(t.id),style:{borderRadius:"12px",padding:"3px 8px",fontSize:"0.65rem",whiteSpace:"nowrap"},children:[e.jsx("i",{className:`fas ${t.icon}`,style:{marginRight:"2px"}}),t.label]},t.id))})}),e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{className:"modal-body py-3",style:{maxHeight:"45vh",overflowY:"auto"},children:[o==="details"&&e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-6",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-signature mr-2"}),"Budget Name"]}),e.jsx("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:e.jsxs("div",{className:"form-group mb-0",children:[e.jsx("label",{className:"small text-muted mb-1",children:"Budget Name *"}),e.jsx("input",{type:"text",className:`form-control form-control-sm ${i.name?"is-invalid":""}`,placeholder:"e.g., Monthly Groceries",value:n.name||"",onChange:t=>g("name",t.target.value),maxLength:100,disabled:l,style:{borderRadius:"6px"}}),i.name&&e.jsx("div",{className:"invalid-feedback",style:{fontSize:"0.75rem"},children:i.name})]})})]}),e.jsxs("div",{className:"col-lg-6",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-tag mr-2"}),"Category"]}),e.jsx("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:e.jsxs("div",{className:"form-group mb-0",children:[e.jsx("label",{className:"small text-muted mb-1",children:"Category *"}),e.jsxs("select",{className:`form-control form-control-sm ${i.category?"is-invalid":""}`,value:n.category||"",onChange:t=>g("category",t.target.value),disabled:l,style:{borderRadius:"6px"},children:[e.jsx("option",{value:"",children:"Select Category"}),N.map(t=>e.jsx("option",{value:t.category_name,children:t.category_name},t.id))]}),i.category&&e.jsx("div",{className:"invalid-feedback",style:{fontSize:"0.75rem"},children:i.category})]})})]}),e.jsxs("div",{className:"col-12",children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-flag mr-2"}),"Status"]}),e.jsx("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:e.jsx("div",{className:"d-flex",style:{gap:"8px"},children:[{value:"active",label:"Active",icon:"fa-play-circle",color:"#28a745"},{value:"completed",label:"Completed",icon:"fa-check-circle",color:"#007bff"},{value:"archived",label:"Archived",icon:"fa-archive",color:"#6c757d"}].map(t=>e.jsxs("button",{type:"button",className:`btn btn-sm flex-fill ${n.status===t.value?"":"btn-outline-secondary"}`,style:{borderRadius:"6px",background:n.status===t.value?t.color:void 0,borderColor:n.status===t.value?t.color:void 0,color:n.status===t.value?"white":void 0},onClick:()=>g("status",t.value),disabled:l,children:[e.jsx("i",{className:`fas ${t.icon} mr-1`}),t.label]},t.value))})})]})]}),o==="financial"&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-peso-sign mr-2"}),"Budget Amount"]}),e.jsxs("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"form-group mb-3",children:[e.jsx("label",{className:"small text-muted mb-1",children:"Amount (PHP) *"}),e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("span",{className:"input-group-text",style:{borderRadius:"6px 0 0 6px"},children:"₱"})}),e.jsx("input",{type:"number",className:`form-control ${i.amount?"is-invalid":""}`,placeholder:"0.00",value:n.amount||"",onChange:t=>g("amount",parseFloat(t.target.value)||0),min:"0",step:"0.01",disabled:l,style:{borderRadius:"0 6px 6px 0"}}),i.amount&&e.jsx("div",{className:"invalid-feedback",style:{fontSize:"0.75rem"},children:i.amount})]})]}),e.jsxs("div",{className:"pt-2",style:{borderTop:"1px solid #e9ecef"},children:[e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsx("small",{className:"text-muted",children:"Spending Progress"}),e.jsxs("small",{style:{color:j(c)},children:[c,"%"]})]}),e.jsx("div",{className:"progress",style:{height:"6px",borderRadius:"3px"},children:e.jsx("div",{className:"progress-bar",style:{width:`${c}%`,background:j(c),borderRadius:"3px"}})})]})]}),e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-chart-bar mr-2"}),"Financial Summary"]}),e.jsx("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:e.jsxs("div",{className:"row text-center",children:[e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"p-2",style:{background:"rgba(0,123,255,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",children:"Budget"}),e.jsxs("strong",{className:"text-primary",children:["₱",r.amount.toLocaleString()]})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"p-2",style:{background:"rgba(220,53,69,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",children:"Spent"}),e.jsxs("strong",{className:"text-danger",children:["₱",r.spent.toLocaleString()]})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"p-2",style:{background:"rgba(40,167,69,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",children:"Remaining"}),e.jsxs("strong",{className:"text-success",children:["₱",(r.amount-r.spent).toLocaleString()]})]})})]})})]}),o==="timeline"&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-calendar-alt mr-2"}),"Budget Period"]}),e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group mb-md-0 mb-3",children:[e.jsx("label",{className:"small text-muted mb-1",children:"Start Date *"}),e.jsx("input",{type:"date",className:`form-control form-control-sm ${i.start_date?"is-invalid":""}`,value:n.start_date||"",onChange:t=>g("start_date",t.target.value),disabled:l,style:{borderRadius:"6px"}}),i.start_date&&e.jsx("div",{className:"invalid-feedback",style:{fontSize:"0.75rem"},children:i.start_date})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"form-group mb-0",children:[e.jsx("label",{className:"small text-muted mb-1",children:"End Date *"}),e.jsx("input",{type:"date",className:`form-control form-control-sm ${i.end_date?"is-invalid":""}`,value:n.end_date||"",onChange:t=>g("end_date",t.target.value),disabled:l,style:{borderRadius:"6px"}}),i.end_date&&e.jsx("div",{className:"invalid-feedback",style:{fontSize:"0.75rem"},children:i.end_date})]})})]}),n.start_date&&n.end_date&&e.jsx("div",{className:"mt-3 pt-2",style:{borderTop:"1px solid #e9ecef"},children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-calendar-check mr-1"}),new Date(n.start_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-arrow-right mr-1"}),Math.ceil((new Date(n.end_date).getTime()-new Date(n.start_date).getTime())/(1e3*60*60*24))," days"]}),e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-calendar-times mr-1"}),new Date(n.end_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]})})]})]}),o==="owner"&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-user mr-2"}),"Current Owner"]}),e.jsx("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:r.user_avatar||"../images/placeholder.png",alt:r.user_name,className:"rounded-circle mr-3",style:{width:"48px",height:"48px",objectFit:"cover"},onError:t=>{t.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.9rem",fontWeight:500},children:r.user_name}),e.jsx("small",{className:"text-muted",children:r.user_email})]})]})}),e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.9rem"},children:[e.jsx("i",{className:"fas fa-user-edit mr-2"}),"Change Owner"]}),e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"form-group mb-2",children:[e.jsx("label",{className:"small text-muted mb-1",children:"Search User *"}),e.jsxs("div",{className:"position-relative",children:[e.jsx("input",{type:"text",className:`form-control form-control-sm ${i.user_id?"is-invalid":""}`,placeholder:"Type to search users...",value:k,onChange:t=>{B(t.target.value),b(!0)},onFocus:()=>b(!0),disabled:l,style:{borderRadius:"6px"}}),p&&z.length>0&&e.jsx("div",{className:"dropdown-menu show w-100",style:{maxHeight:"150px",overflowY:"auto",position:"absolute",zIndex:1e3,borderRadius:"6px"},children:z.slice(0,5).map(t=>e.jsxs("button",{type:"button",className:"dropdown-item d-flex align-items-center py-2",onClick:()=>y(t),children:[e.jsx("img",{src:t.user_metadata?.avatar_url||"../images/placeholder.png",alt:"Avatar",className:"rounded-circle mr-2",style:{width:"28px",height:"28px",objectFit:"cover"},onError:f=>{f.currentTarget.src="../images/placeholder.png"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.85rem",fontWeight:500},children:t.user_metadata?.full_name||t.email?.split("@")[0]||"Unknown"}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.7rem"},children:t.email})]})]},t.id))}),i.user_id&&e.jsx("div",{className:"invalid-feedback d-block",style:{fontSize:"0.75rem"},children:i.user_id})]})]}),s&&s.id!==r.user_id&&e.jsxs("div",{className:"d-flex align-items-center p-2 mt-2",style:{background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-warning mr-2"}),e.jsxs("small",{className:"text-muted",children:["Ownership will transfer to ",e.jsx("strong",{children:s.user_metadata?.full_name||s.email?.split("@")[0]})]})]})]})]})]}),e.jsxs("div",{className:"modal-footer border-0 py-2",style:{background:"#f8f9fa"},children:[e.jsxs("small",{className:"text-muted mr-auto",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"fas fa-fingerprint mr-1"}),"ID: ",e.jsxs("code",{style:{fontSize:"0.7rem"},children:[r.id?.substring(0,12),"..."]})]}),e.jsxs("button",{type:"button",className:"btn btn-secondary btn-sm mr-2",onClick:F,disabled:l,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Cancel"]}),e.jsx("button",{type:"submit",className:"btn btn-danger btn-sm",disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm mr-1"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-save mr-1"}),"Save Changes"]})})]})]})]})})})]})},Ne=({show:a,budget:r,onClose:m,onDelete:w,loading:N=!1})=>{const[x,l]=u.useState(""),[n,d]=u.useState(!1),i=y=>{const D=y.target.value;l(D),d(D.toLowerCase()==="delete")},h=y=>{y.preventDefault(),r&&n&&w(r.id)},k=()=>{l(""),d(!1),m()};if(!a||!r)return null;const B=r.spent>0,p=r.status==="active",b=Math.min(Math.round(r.spent/r.amount*100),100),o=y=>y>=90?"#dc3545":y>=70?"#fd7e14":"#28a745",g=(y=>{switch(y){case"active":return{label:"Active",color:"#28a745",icon:"fa-play-circle"};case"completed":return{label:"Completed",color:"#007bff",icon:"fa-check-circle"};default:return{label:"Archived",color:"#6c757d",icon:"fa-archive"}}})(r.status);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-backdrop fade show",style:{zIndex:1040},onClick:k}),e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,style:{zIndex:1050},onClick:k,children:e.jsx("div",{className:"modal-dialog modal-md modal-dialog-centered",onClick:y=>y.stopPropagation(),children:e.jsxs("div",{className:"modal-content border-0 shadow-lg",style:{borderRadius:"12px",overflow:"hidden",maxHeight:"85vh"},children:[e.jsx("div",{className:"modal-header border-0 text-white py-3",style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)"},children:e.jsxs("div",{className:"d-flex align-items-center w-100",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mr-2",style:{width:"40px",height:"40px",background:"rgba(255,255,255,0.2)",borderRadius:"8px"},children:e.jsx("i",{className:"fas fa-trash-alt fa-lg"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h6",{className:"mb-0 font-weight-bold",children:"Delete Budget"}),e.jsx("small",{style:{opacity:.9},children:"This action cannot be undone"})]}),e.jsx("button",{type:"button",className:"btn btn-light btn-sm",onClick:k,disabled:N,style:{width:"32px",height:"32px",borderRadius:"6px",padding:0},children:e.jsx("i",{className:"fas fa-times text-danger"})})]})}),e.jsxs("div",{className:"modal-body py-3",style:{maxHeight:"60vh",overflowY:"auto"},children:[e.jsx("div",{className:"p-3 mb-3",style:{background:"#fff5f5",borderRadius:"8px",borderLeft:"3px solid #dc3545"},children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{className:"fas fa-exclamation-triangle text-danger mr-2 mt-1"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-danger",style:{fontSize:"0.9rem"},children:"Permanent Deletion"}),e.jsx("p",{className:"mb-0 text-muted",style:{fontSize:"0.8rem"},children:"This will permanently remove the budget and all associated data including spending history and analytics."})]})]})}),e.jsxs("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[r.user_avatar?e.jsx("img",{src:r.user_avatar,alt:r.user_name,className:"rounded-circle mr-2",style:{width:"36px",height:"36px",objectFit:"cover"}}):e.jsx("div",{className:"d-flex align-items-center justify-content-center bg-danger text-white rounded-circle mr-2",style:{width:"36px",height:"36px",fontSize:"0.9rem"},children:e.jsx("i",{className:"fas fa-calculator"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("div",{style:{fontSize:"0.9rem",fontWeight:600},children:r.name}),e.jsxs("small",{className:"text-muted",children:[r.user_name," • ",r.category]})]}),e.jsxs("span",{className:"badge px-2 py-1",style:{background:`${g.color}20`,color:g.color,fontSize:"0.7rem"},children:[e.jsx("i",{className:`fas ${g.icon} mr-1`}),g.label]})]}),e.jsx("div",{className:"d-none d-md-block",children:e.jsxs("div",{className:"row text-center mb-2",style:{fontSize:"0.8rem"},children:[e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"p-2",style:{background:"rgba(0,123,255,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",children:"Budget"}),e.jsxs("strong",{className:"text-primary",children:["₱",r.amount.toLocaleString()]})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"p-2",style:{background:"rgba(220,53,69,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",children:"Spent"}),e.jsxs("strong",{className:"text-danger",children:["₱",r.spent.toLocaleString()]})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"p-2",style:{background:"rgba(40,167,69,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",children:"Remaining"}),e.jsxs("strong",{className:"text-success",children:["₱",(r.amount-r.spent).toLocaleString()]})]})})]})}),e.jsx("div",{className:"d-block d-md-none mb-2",children:e.jsxs("div",{className:"d-flex text-center",style:{gap:"4px"},children:[e.jsxs("div",{className:"flex-fill p-1",style:{background:"rgba(0,123,255,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.6rem"},children:"Budget"}),e.jsxs("strong",{className:"text-primary",style:{fontSize:"0.7rem"},children:["₱",r.amount.toLocaleString()]})]}),e.jsxs("div",{className:"flex-fill p-1",style:{background:"rgba(220,53,69,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.6rem"},children:"Spent"}),e.jsxs("strong",{className:"text-danger",style:{fontSize:"0.7rem"},children:["₱",r.spent.toLocaleString()]})]}),e.jsxs("div",{className:"flex-fill p-1",style:{background:"rgba(40,167,69,0.1)",borderRadius:"6px"},children:[e.jsx("small",{className:"text-muted d-block",style:{fontSize:"0.6rem"},children:"Left"}),e.jsxs("strong",{className:"text-success",style:{fontSize:"0.7rem"},children:["₱",(r.amount-r.spent).toLocaleString()]})]})]})}),e.jsxs("div",{className:"d-flex justify-content-between mb-1",children:[e.jsx("small",{className:"text-muted",children:"Progress"}),e.jsxs("small",{style:{color:o(b)},children:[b,"%"]})]}),e.jsx("div",{className:"progress",style:{height:"4px",borderRadius:"2px"},children:e.jsx("div",{className:"progress-bar",style:{width:`${b}%`,background:o(b),borderRadius:"2px"}})})]}),(B||p)&&e.jsxs("div",{className:"p-3 mb-3",style:{background:"#fff8e1",borderRadius:"8px",border:"1px solid #ffc107"},children:[e.jsxs("h6",{className:"text-warning mb-2",style:{fontSize:"0.85rem"},children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),"Deletion Impact"]}),e.jsxs("ul",{className:"mb-0 pl-3",style:{fontSize:"0.8rem"},children:[B&&e.jsxs("li",{className:"text-muted",children:["This budget has ",e.jsxs("strong",{className:"text-danger",children:["₱",r.spent.toLocaleString()]})," in recorded spending"]}),p&&e.jsxs("li",{className:"text-muted",children:["This is an ",e.jsx("strong",{children:"active budget"})," currently in use"]}),e.jsx("li",{className:"text-muted",children:"All history and analytics will be permanently lost"})]})]}),e.jsxs("div",{className:"p-3 mb-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.85rem"},children:[e.jsx("i",{className:"fas fa-calendar-alt mr-2"}),"Budget Period"]}),e.jsxs("div",{className:"d-flex justify-content-between",style:{fontSize:"0.8rem"},children:[e.jsxs("div",{children:[e.jsx("small",{className:"text-muted d-block",children:"Start Date"}),e.jsx("span",{children:new Date(r.start_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),e.jsx("div",{className:"text-center",children:e.jsx("i",{className:"fas fa-arrow-right text-muted"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("small",{className:"text-muted d-block",children:"End Date"}),e.jsx("span",{children:new Date(r.end_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]})]}),e.jsxs("div",{className:"p-3",style:{background:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("h6",{className:"text-danger mb-2",style:{fontSize:"0.85rem"},children:[e.jsx("i",{className:"fas fa-shield-alt mr-2"}),"Confirm Deletion"]}),e.jsxs("p",{className:"text-muted mb-2",style:{fontSize:"0.8rem"},children:["Type ",e.jsx("strong",{className:"text-danger",children:"delete"})," to confirm:"]}),e.jsx("input",{type:"text",className:`form-control form-control-sm ${x&&!n?"is-invalid":n?"is-valid":""}`,placeholder:"Type 'delete' to confirm",value:x,onChange:i,autoComplete:"off",disabled:N,style:{borderRadius:"6px"}}),x&&!n&&e.jsx("div",{className:"invalid-feedback",style:{fontSize:"0.75rem"},children:'Please type "delete" exactly to confirm'}),n&&e.jsxs("div",{className:"valid-feedback",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"fas fa-check-circle mr-1"}),"Ready to delete"]})]})]}),e.jsxs("div",{className:"modal-footer border-0 py-2",style:{background:"#f8f9fa"},children:[e.jsxs("small",{className:"text-muted mr-auto",style:{fontSize:"0.75rem"},children:[e.jsx("i",{className:"fas fa-fingerprint mr-1"}),"ID: ",e.jsxs("code",{style:{fontSize:"0.7rem"},children:[r.id?.substring(0,12),"..."]})]}),e.jsxs("button",{type:"button",className:"btn btn-secondary btn-sm mr-2",onClick:k,disabled:N,children:[e.jsx("i",{className:"fas fa-times mr-1"}),"Cancel"]}),e.jsx("button",{type:"button",className:`btn btn-sm ${n?"btn-danger":"btn-outline-danger"}`,onClick:h,disabled:!n||N,children:N?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm mr-1"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-trash-alt mr-1"}),"Delete Budget"]})})]})]})})})]})},Se=()=>{const[a,r]=u.useState(null),[m,w]=u.useState(!1),[N,x]=u.useState(!1),[l,n]=u.useState(!1),[d,i]=u.useState(!1),[h,k]=u.useState(new Date),[B,p]=u.useState(!1),{showSuccessToast:b,showErrorToast:o}=ne(),{budgets:S,categories:g,users:y,stats:D,loading:_,totalPages:F,totalItems:z,fetchBudgets:s,refreshBudgetData:c,changeBudgetStatus:j}=ge(),{filters:t,updateFilters:f}=je();u.useEffect(()=>{s(t)},[s,t]);const T=C=>{r(C),w(!0)},R=()=>{r(null),w(!1)},q=async(C,A)=>{await j(C,A)},Z=async C=>{try{b("Budget added successfully!"),x(!1),await c(t)}catch(A){console.error("Error adding budget:",A),o("Failed to add budget. Please try again.")}},Y=C=>{r(C),n(!0)},V=async(C,A)=>{try{b("Budget updated successfully!"),n(!1),r(null),await c(t)}catch(E){console.error("Error updating budget:",E),o("Failed to update budget. Please try again.")}},U=C=>{r(C),i(!0)},H=async C=>{try{b("Budget deleted successfully!"),i(!1),r(null),await c(t)}catch(A){console.error("Error deleting budget:",A),o("Failed to delete budget. Please try again.")}},O=()=>{x(!1)},G=()=>{n(!1),r(null)},ee=()=>{i(!1),r(null)},Q=C=>{const A=t.sortField===C&&t.sortDirection==="asc"?"desc":"asc";f({...t,sortField:C,sortDirection:A})},v=C=>{f({...t,currentPage:C})},$=async()=>{p(!0);try{await c(t),k(new Date)}catch(C){console.error("Error refreshing data:",C),o("Failed to refresh budget data")}finally{p(!1)}};return _?e.jsxs("div",{className:"modern-user-management",children:[e.jsx("div",{className:"block md:hidden py-12 animate__animated animate__fadeIn",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"mt-3 text-xs text-gray-500 font-medium",children:"Loading budgets..."})]})}),e.jsxs("div",{className:"hidden md:block",children:[e.jsx("div",{className:"user-management-header mb-5",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start flex-wrap",children:[e.jsx("div",{className:"header-content",children:e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"header-icon-container mr-3",children:e.jsx("div",{className:"skeleton-icon"})}),e.jsxs("div",{children:[e.jsx("div",{className:"skeleton-line skeleton-header-title mb-1"}),e.jsx("div",{className:"skeleton-line skeleton-header-subtitle"})]})]})}),e.jsxs("div",{className:"header-actions d-flex align-items-center",children:[e.jsx("div",{className:"last-updated-info mr-3",children:e.jsx("div",{className:"skeleton-line skeleton-date"})}),e.jsx("div",{className:"skeleton-button mr-2"}),e.jsx("div",{className:"skeleton-button"})]})]})}),e.jsx("div",{className:"stats-cards-container mb-5",children:e.jsx(te,{stats:{totalBudgets:0,activeBudgets:0,budgetCategories:0,usersWithBudgets:0,budgetsByCategory:{},budgetsByStatus:{},budgetsByUser:{}},loading:!0})}),e.jsx(le,{stats:{totalBudgets:0,activeBudgets:0,budgetCategories:0,usersWithBudgets:0,budgetsByCategory:{},budgetsByStatus:{},budgetsByUser:{}},loading:!0}),e.jsx("div",{className:"controls-section mb-4",children:e.jsx(re,{filters:t,categories:[],onFiltersChange:()=>{},onRefresh:()=>{},loading:!0})}),e.jsx("div",{className:"table-section",children:e.jsx(ie,{budgets:[],filters:t,totalPages:1,totalItems:0,loading:!0,onSort:()=>{},onPageChange:()=>{},onBudgetSelect:()=>{},onBudgetEdit:()=>{},onBudgetDelete:()=>{}})})]})]}):e.jsxs("div",{className:"modern-user-management",children:[e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-bold text-gray-800",children:"Budgets"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:$,className:"w-9 h-9 rounded-full bg-red-500 hover:bg-red-600 text-white flex items-center justify-center shadow-md transition-all active:scale-95 disabled:opacity-50",disabled:B,"aria-label":"Refresh data",children:e.jsx("i",{className:`fas fa-sync text-xs ${B?"fa-spin":""}`})}),e.jsx("button",{onClick:()=>x(!0),className:"w-9 h-9 rounded-full bg-rose-600 hover:bg-rose-700 text-white flex items-center justify-center shadow-md transition-all active:scale-95","aria-label":"Add budget",children:e.jsx("i",{className:"fas fa-plus text-xs"})})]})]})}),e.jsx("div",{className:"user-management-header mb-5 hidden md:block",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start flex-wrap",children:[e.jsx("div",{className:"header-content",children:e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"header-icon-container mr-3",children:e.jsx("i",{className:"fas fa-calculator"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"header-title mb-1",children:"Budget Management"}),e.jsx("p",{className:"header-subtitle mb-0",children:"Manage user budgets, track spending, and monitor financial goals across the platform"})]})]})}),e.jsxs("div",{className:"header-actions d-flex align-items-center",children:[e.jsx("div",{className:"last-updated-info mr-3",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"far fa-clock mr-1"}),"Last updated: ",h.toLocaleTimeString()]})}),e.jsxs("button",{className:"btn btn-outline-danger btn-sm shadow-sm refresh-btn mr-2",onClick:$,disabled:_||B,children:[e.jsx("i",{className:`fas fa-sync-alt mr-1 ${B?"fa-spin":""}`}),B?"Refreshing...":"Refresh"]}),e.jsxs("button",{className:"btn btn-danger btn-sm shadow-sm",onClick:()=>x(!0),children:[e.jsx("i",{className:"fas fa-plus mr-1"}),"Add Budget"]})]})]})}),e.jsx("div",{className:"stats-cards-container mb-5",children:e.jsx(te,{stats:D,loading:_})}),e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-chart-pie text-red-500 text-[10px]"})}),e.jsx("span",{className:"text-xs font-semibold text-gray-700",children:"Analytics Overview"})]})}),e.jsx(le,{stats:D,loading:_}),e.jsx("div",{className:"block md:hidden mb-3 mt-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-filter text-red-500 text-[10px]"})}),e.jsx("span",{className:"text-xs font-semibold text-gray-700",children:"Search & Filters"})]})}),e.jsx("div",{className:"controls-section mb-4",children:e.jsx(re,{filters:t,categories:g,onFiltersChange:f,onRefresh:$,loading:_})}),e.jsx("div",{className:"block md:hidden mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-list text-red-500 text-[10px]"})}),e.jsx("span",{className:"text-xs font-semibold text-gray-700",children:"Budget List"})]}),e.jsxs("span",{className:"text-[10px] text-gray-500 font-medium",children:[z," budgets"]})]})}),e.jsx("div",{className:"table-section",children:e.jsx(ie,{budgets:S,filters:t,totalPages:F,totalItems:z,loading:_,onSort:Q,onPageChange:v,onBudgetSelect:T,onBudgetEdit:Y,onBudgetDelete:U})}),e.jsx(fe,{budget:a,show:m,onClose:R,onStatusChange:q,onEdit:Y,onDelete:U}),e.jsx(pe,{show:N,onClose:O,onAdd:Z,categories:g,users:y,loading:_}),e.jsx(be,{show:l,budget:a,onClose:G,onUpdate:V,categories:g,users:y,loading:_}),e.jsx(Ne,{show:d,budget:a,onClose:ee,onDelete:H,loading:_})]})};export{Se as default};
